<html>
<head>
  <title>java 并发</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600986 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="867"/>
<h1>java 并发</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">1 java 并发</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">java并发编程是为了让程序运行地更快，在进行并发编程时，会面临如下挑战：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">上下文切换带来的开销</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">死锁的产生</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">资源的限制</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">1.1 java 并发机制的底层实现原理</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在java编程中，java文件转化为字节码文件交付给JVM执行，JVM最终将字节码文件编程汇编指令进行执行，所以java并发的实现最终依赖的还是JVM的实现和CPU指令。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.1.1 volatile 关键词</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">volatile关键字的使用会带来两个特性，一是可见性，二是禁止重排序。<br/>
由volatile关键词修饰的变量进行写操作时会出现两行汇编代码，第一行是原本的写操作命令，第二行是有<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">lock前缀的指令</strong>。这个lock前缀的指令在多核处理器下会引发两个操作：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">将当前处理器缓存行数据写回到系统内存</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">上述写回操作会使在其他CPU中缓存了该内存地址的数据无效</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">为了提高处理速度，处理器不直接和内存进行通信，而是将系统内存的数据读到内部缓存中再进行操作，但是操作完成后不知何时会写回内存。而声明了volatile的变量在写操作时JVM会向处理器发送lock前缀的指令，将变量值写回系统内存。在多处理器下，lock指令保证在该指令在声音期间，该处理器独占任何共享内存。一般可以使用总线锁定（开销很大）和缓存锁定。<br/>
在多处理器下，这样的操作会使得其他处理器缓存的值过时，为了避免使用过时的值，进行了<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">缓存一致性协议</strong>。处理器使用嗅探在总线上传播的数据来检查自己的缓存是否过期，一旦过期，就将缓存设置为无效状态。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.1.2 synchronized关键词</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">用sychronized实现同步时，java中的每一个对象都可以作为锁：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于普通同步方法，锁是当前实例对象</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于静态同步方法，锁是当前类的Class对象</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于同步方法块，锁是括号里配置的对象</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">synchronized的实现</strong>：<br/>
synchronized通过JVM基于进入和退出Monitor对象来实现方法同步和代码块同步。代码块同步时，使用<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">monitorenter和monitorexit指令</strong>来实现。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">sychronized用的锁是存在对象头里的。在java 1.6之后，锁的状态从低到高有4种，分别是：无锁、偏向锁、轻量级锁和重量级锁。偏向锁可以膨胀为轻量级锁，轻量级锁可以膨胀为重量级锁。锁一旦升级不能降级。</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">偏向锁<br/>
在大多数情况下，锁不仅不存在多线程竞争，反而总是由一个线程多次获得，为了让线程获得锁的代价降低，引入偏向锁。线程访问同步块并获取锁时，在对象头和栈帧中的锁记录里存储锁偏向的线程id，如果同一个锁下一次进入同步块，只需要测试对象头中是否有指向当前线程的偏向锁。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">轻量级锁<br/>
线程在执行同步块时，JVM会先在当前线程的栈帧中创建用于存储锁记录的空间，并将对象头中的mark word复制到锁记录中。然后线程尝试使用CAS将对象头中的mark word替换为指向锁记录的指针，如果成功则当前线程获得锁，如果失败则表示其他线程竞争锁，当前线程自旋以获得锁。</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.1.3 原子操作</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">原子操作指不能被中断的一个或一系列操作。<br/>
在处理器中，使用两种方式来保证原子性：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">总线锁：使用lock信号，当一个处理器在总线上输出此信号时，其他处理器的请求全部被阻塞，该处理器独享共享内存。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">缓存锁定：频繁使用的内存会缓存在处理器的高速缓存里，原子操作直接在缓存中进行，不需总线锁。缓存锁定就是指，内存区域如果被缓存在处理器的缓存行里，并且在lock期间被锁定，那么当它执行锁操作写回内存时，处理器不在总线上声明Lock,而是修改内部的内存地址，并允许其缓存一致性来保证原子性。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">缓存锁定的不适用情况</strong>：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">操作数据跨多个缓存行或者数据不能被缓存在处理器内部时；</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">处理器不支持缓存锁定时。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">处理器如何<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">实现原子操作</strong>：锁 和 循环CAS<br/>
CAS实现原子性的三个问题：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ABA问题</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">循环时间长开销大</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">只能保证一个共享变量的原子操作。</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">1.2 java 内存模型  JMM</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">java并发编程中最重要的两个问题<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">同步</strong>和<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">通信</strong>。<br/>
同步是指控制不同线程的操作发生的顺序的机制。在共享内存的模型中，同步是显式的。在消息传递的模型中，同步是隐式的。<br/>
Java采用的是共享内存的并发模型，同步是显式进行的，通信是隐式进行的。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.1 java内存模型的抽象结构</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">java线程之间的通信，由java内存模型JMM控制。<br/>
如图所示，JMM通过控制主内存与每个线程本地内存之间的交互，来实现内存可见性。<br/>
主内存中存放线程之间的共享变量，本地内存中存放每个线程拥有的共享变量的副本。<br/>
<img src="java 并发_files/jmm.png" type="image/png" data-filename="jmm.png"/><br/>
从图中可以看出，如果A和B要通信，需要有两个步骤：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">A把本地内存中的共享变量刷新到内存中去</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程B到主内存中去读A更新过的共享变量</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">共享变量有哪些?</strong></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在java程序中所有<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">实例域，静态域和数组元素</strong>都是放在堆内存中（所有线程均可访问到，是可以共享的），而局部变量，方法定义参数和异常处理器参数不会在线程间共享。共享数据会出现线程安全的问题，而非共享数据不会出现线程安全的问题。关于JVM运行时内存区域在后面的文章会讲到。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.2 重排序与内存屏障</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在执行指令时，为了提高效率，编译器和处理器通常会对指令进行重排序，分成三种类型：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">编译器优化重排序：编译器在不改变语义的情况下重新安排语句执行顺序。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">指令级并行的重排序： 处理器使用指令级并行技术。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">内存系统的重排序：处理器使用缓存和读写缓冲区。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">但是重排序可能会导致线程程序出现内存可见性问题，所以JMM编译器重排序规则禁止特定类型的编译器重排序；JMM处理器重排序规则会要求编译器在生成指令序列时插入特定类型的内存屏障来禁止特定类型的重排序。<br/>
<img src="java 并发_files/memorybarrier.png" type="image/png" data-filename="memorybarrier.png"/></p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.3 一些规则</h4>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">（1）happens-before</h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">happens-before是JMM中最核心的概念。happens-before关系的定义如下：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">如果一个操作happens-before另一个操作，那么第一个操作的执行结果将对第二个操作可见，而且第一个操作的执行顺序在第二个操作之前。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">两个操作之间存在happens-before关系，并不意味着java平台的具体实现必须要按照happens-before关系指定的顺序来执行。如果重排序之后的执行结果与按照happens-before来执行的结果一致，这种重排序并不非法。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">happens-before规则</strong>：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）程序顺序规则：一个线程中的每个操作，happens-before于该线程中的任意后续操作。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（2）监视器锁规则：对一个锁的解锁，happens-before于随后对这个锁的加锁。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（3）volatile变量规则：对一个volatile域的写，happens-before于任意后续对这个volatile域的读。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（4）传递性：如果A happens-before B，且B happens-before C，那么A happens-before C。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（5）start()规则：如果线程A执行操作ThreadB.start()（启动线程B），那么A线程的ThreadB.start()操作happens-before于线程B中的任意操作。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（6）join()规则：如果线程A执行操作ThreadB.join()并成功返回，那么线程B中的任意操作happens-before于线程A从ThreadB.join()操作成功返回。</li>
</ul>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">（2）as-if-serial</h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">as-if-serial的语义是：不管怎么重排序，（单线程）程序的执行结果不能被改变。<br/>
编译器、runtime和处理器必须遵守这个语义。<br/>
as-if-serial实际上和happens-before关系是一样的：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">as-if-serial语义保证单线程内程序的执行结果不被改变，happens-before保证正确同步的多线程程序结果不被改变</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">as-if-serial给写单线程的程序员呈现出按顺序执行的样子，happens-before给写多线程的程序员呈现出按指定顺序执行的样子。</li>
</ul>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">（3）顺序一致性</h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">顺序一致性模型是一个理想化的模型，该模型的两大特性：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">一个线程中的所有操作必须按照线程的顺序来执行</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（不管程序同步与否）所有线程都只能看到一个单一的操作执行顺序。在顺序一致内存模型中，每个操作都必须原子执行且立刻对所有线程可见。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在未同步程序中，JMM只提供最小安全性，JVM在堆上分配对象时，会先对内存空间清零再分配，所以JMM保证线程读到的值不会无中生有，要么是默认值，要么是之前某个线程写入的值。但是不保证这个值是正确的。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.4 内存中volatile 的语义</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">volatile在内存中读和写的语义：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程A写一个volatile变量，实际上是线程A向接下来要读这个变量的线程发出了消息。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程B读一个volatile变量，实际上是线程B收到了给他发的有关变量被修改的消息。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程A写volatile变量，线程B读volatile变量，实际上是线程A和B通过主内存通信的过程。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">volatile变量的语义实现通过在指令间加入内存屏障来实现。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.5 内存中锁的语义</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">锁在内存中释放和获取的语义：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程A释放一个锁，实际上是A向接下来要使用这个锁的线程发出了消息。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程B获取一个锁，实际上是收到了之前某个线程释放这个锁的消息。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">线程A释放锁，线程B获取这个锁，实际上是线程A通过主内存向线程B发送消息。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">锁的语义实现：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">使用volatile变量的写-读锁具有的内存语义</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">使用CAS锁附带的volatile 读和写的内存语义</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.6 内存中final的与意义</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">对于final域，编译器和处理器需要遵循两个重排序规则</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）写重排序规则：在构造函数内对一个final域的写入，与随后把这个被构造对象的引用赋值给一个引用变量，这两个操作不能重排序。这个规则保证了<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">在对象的引用为任意线程可见之前，对象的final域已经被正确初始化过了</strong>。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（2）读重排序规则：初次读一个包含final域的对象的引用，与随后初次读这个final域，这两个操作不能重排序。这个规则保证了<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">在读一个对象的final域之前，一定会先读包含这个final域对象的引用</strong>。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">final的语义实现通过在指令间加入内存屏障来实现。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.2.7 延迟初始化和双重检查锁定</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在java多线程程序中，有时需要采用延迟初始化来推迟一些高开销的对象的初始化操作，只有当使用这些对象时才进行初始化。但在多线程情况下，有可能触发不安全的操作。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">历史解决方法1：使用synchronized来同步处理<br/>
缺点：sychronized在整个函数上，导致开销太高，性能下降。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">历史解决方案2：使用双重检查锁定来实现：第一次检查对象是否被初始化，未被初始化则加锁，再次检查是否被初始化，未被初始化则进行初始化进行初始化。<br/>
缺点：带来了错误：由于创建对象首先要分配内存空间，对象指向分配的空间，再进行初始化，这三个步骤合成了一个对象创建的步骤。但是有可能再编译器中，初始化和指向分配空间这两个操作会被重排，导致在检查到对象已经指向分配空间时，实际上还没有完成初始化。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">目前解决方案：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">基于volatile的方法：将对象声明为volatile再进行双重检查锁定，即可保证线程安全延迟初始化</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">public class Singleton { 
    private volatile static Singleton uniqueSingleton; 
    private Singleton() { } 
    public Singleton getInstance() { 
        if (null == uniqueSingleton) { 
            synchronized (Singleton.class) { 
                if (null == uniqueSingleton) { 
                    uniqueSingleton = new Singleton(); 
                } 
            } 
        } 
        return uniqueSingleton; 
    }
}
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">基于类初始化的解决方法：每个类或者接口都有唯一的一个初始化锁，多个线程同时尝试去初始化类或接口，但是锁只有一个，所以同时只有一个线程在进行初始化过程，其他线程都在尝试并等待，直到类被第一个拿到锁的线程初始化结束，其他线程继续请求初始化锁，发现类已经被初始化过了，于是结束各自的初始化过程。</li>
</ul>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">2 java 并发编程基础</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">2.1 线程</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">操作系统在运行一个程序时，会为其创建一个进程。在一个进程里可以创建多个线程，线程是操作系统进行调度的最小单位。<br/>
<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">线程优势</strong><br/>
使用多线程可以带来以下好处：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">更多的处理器核心</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">更快的响应时间</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">更好的编程模型</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">线程优先级</strong><br/>
在Java线程中，通过整型成员变量priority来控制优先级，范围从1-10。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">线程状态</strong><br/>
Java 线程在运行的生命周期中的指定时刻只可能处于下面 6 种不同状态的其中一个状态。<br/>
<img src="java 并发_files/status.png" type="image/png" data-filename="status.png"/><br/>
java线程的状态切换过程如图：<br/>
<img src="java 并发_files/statuschange.png" type="image/png" data-filename="statuschange.png"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Daemon线程</strong><br/>
Daemon线程 是一种支持型线程，此属性需要在启动线程前设置，主要被用作程序中后台调度以及支持性工作。Daemon线程随着main方法的执行完毕而终止。没有非daemon线程后，虚拟机要退出，daemon线程要立刻终止，所以daemon线程中的finally块不会被执行。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">2.2 线程的启动和终止</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">线程在构造时，要进行一系列属性的设置，新构造的线程对象由其parent线程来分配空间，并且继承Parent线程的一些设置。至此，一个新的线程在堆中被初始化完毕，等待运行。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.2.1 启动线程</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">创建线程之后，调用start()方法开始运行。<br/>
<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">调用start方法和调用run方法有什么区别</strong>？</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">start()用来启动一个线程，当调用start()方法时，系统才会开启一个线程，通过Thead类中start()方法来启动的线程处于就绪状态（可运行状态），此时并没有运行，一旦得到CPU时间片，就自动开始执行run()方法。此时不需要等待run()方法执行完也可以继续执行下面的代码，也由此看出run()方法并没有实现多线程。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">run()方法是在本线程里的，只是线程里的一个函数,而不是多线程的。如果直接调用run(),其实就相当于是调用了一个普通函数而已，直接待用run()方法必须等待run()方法执行完毕才能执行下面的代码，所以执行路径还是只有一条，根本就没有线程的特征，所以在多线程执行时要使用start()方法而不是run()方法。</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.2.2 中断线程</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">中断是线程中的一个标识位属性，用来标识一个运行中的线程是否被其他线程中断过。<br/>
其他线程通过调用该线程的interrupt()方法来对其进行中断。该线程则通过isinterrupted()方法来判断自己是否被中断，也可以使用Thread.interrupted()来对标识位进行复位。在判断自己是否被中断时，如果自身已经处于终结状态，也会返回false。<br/>
线程在执行sleep(),join(),wait()方法时，遇到interrupt()方法，会抛出InterruptedException异常，同时将中断标识位设置为true。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.2.3 终止线程</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">中断操作是一种便捷的线程间交互的方式，通过中断和一个boolean变量可以控制程序是否需要对线程进行中断或终止。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">2.3 线程通信</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.3.1 volatile 和 synchronized关键词</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">volatile用来修饰字段（成员变量），告诉程序任何对于该变量的访问都要去内存中获取，对于该变量的更新要刷新回内存，它保证了线程对于变量访问的可见性。<br/>
synchronized用来修饰方法、同步块，确保同一个时刻只有一个线程处于方法或同步块中，保证了线程对变量访问的可见性和排他性。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.3.2 等待/通知机制</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">等待/通知机制，是指一个线程A调用了对象O的wait()方法进入等待状态，而另一个线程B调用了对象O的wait()notify()/notifyAll()方法，线程A收到通知后退出wait()等待队列，进入可运行状态，进而执行后续操作。上诉两个线程通过对象O来完成交互，而对象上的wait()方法和notify()/notifyAll()方法的关系就如同开关信号一样，用来完成等待方和通知方之间的交互工作。<br/>
<img src="java 并发_files/waitnotify.png" type="image/png" data-filename="waitnotify.png"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">等待/通知机制经典范式---消费者和生产者：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于消费者：获取对象的锁；如果条件不满足，则调用对象的wait()方法，被通知后仍要再次检查条件；条件满足则执行对应操作</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于生产者：获取对象的锁；改变条件；通知所有等待在对象上的线程。</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.3.3 join()方法</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">线程A如果调用thread.join()方法，则会等待thread线程终止后才从thread.join()返回。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2.3.4 ThreadLocal</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">通常情况下，我们创建的变量是可以被任何一个线程访问并修改的。如果想实现每一个线程都有自己的专属本地变量该如何解决呢？ JDK中提供的ThreadLocal类正是为了解决这样的问题。 ThreadLocal类主要解决的就是让每个线程绑定自己的值，可以将ThreadLocal类形象的比喻成存放数据的盒子，盒子中可以存储每个线程的私有数据。如果你创建了一个ThreadLocal变量，那么访问这个变量的每个线程都会有这个变量的本地副本，这也是ThreadLocal变量名的由来。他们可以使用 get（） 和 set（） 方法来获取默认值或将其值更改为当前线程所存的副本的值，从而避免了线程安全问题。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">3 锁</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">锁是用来控制多个线程访问共享资源的方式。在lock接口出现之前，java程序是靠着synchronized关键字来隐式地实现锁的。synchronized可以隐式获取和释放锁，但是将锁的获取和释放固化了；lock接口提供了与sychronized关键字类似的同步功能，它需要显式地获取和释放锁，虽然少了便捷，但是获得了锁获取和释放地可操作性、可中断获取锁以及超时获取锁等同步特性。<br/>
Lock是一个接口，提供了锁获取和释放的API。它的实现是通过聚合一个同步器的子类来完成线程访问控制的。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.1 AQS 队列同步器</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">AbstractQueueSynchronizer是用来构建锁或者访问其他同步组件的基础框架，它使用了一个<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Int成员变量</strong>表示<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">同步状态</strong>，通过内置的<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">FIFO队列</strong>来完成资源获取线程的<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">排队</strong>工作。这个类在java.util.concurrent.locks包下面。<br/>
同步器的主要使用方法是<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">继承</strong>，子类通过继承同步器并实现其抽象方法来管理同步状态，使用同步器提供的getState(),setState()和compareAndSetState()方法（这些方法都是protected的）来改变状态。<br/>
同步器是实现锁的关键。锁是面向用户的，定义了使用者与锁交互的接口；同步器是面向锁的，简化了锁的实现方式。<br/>
同步器提供的模板方法基本上分为3类：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">独占式获取与释放同步状态</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">共享式获取与释放同步状态</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">查询同步队列中的等待线程情况</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">自定义同步组件通过使用这些模板来实现自己的同步语义。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">3.1.1 AQS实现</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">1.同步队列</strong><br/>
同步队列是一个FIFO双向队列，用来管理同步状态。<br/>
当前线程获取同步状态失败时，同步器将当前线程以及等待状态信息构造成为一个节点，将其加入同步队列，同时阻塞当前线程；当同步状态释放时，会把队列首节点的线程唤醒，让其再次尝试获取同步状态。<br/>
<img src="java 并发_files/AQS.png" type="image/png" data-filename="AQS.png"/><br/>
队列遵循FIFO，首节点即为获取同步状态成功的节点，当首节点释放同步状态时，会唤醒后继节点；后继节点被唤醒后，先判断自己的先驱节点是不是首节点，是的话去获取同步状态，在获取同步状态成功的同时将自己设置为首节点。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">2.独占式和共享式同步状态的获取与释放</strong><br/>
独占式和共享式的区别在于同一时刻能否有多个线程同时获取到同步状态。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.2 ReentrantLock 重入锁</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ReentrantLock 重入锁，意味着该锁支持一个线程对于资源的重复加锁。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Mutex与ReentrantLock：</strong><br/>
在使用Mutex锁时，当前线程使用lock()方法获得锁后，再次调用Lock()方法就会被自己阻塞；而ReentrantLock再次调用lock()方法时，不会被自己阻塞。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">重入锁的实现：</strong><br/>
（1）线程再次获取锁：线程再次获取锁时，锁需要去判断当前申请的线程是不是占据自己的线程，如果是，则当前线程再次获取锁成功。<br/>
（2）锁的释放：锁对于自身获取和释放次数需要用计数器记录，线程重复获得n次锁，则递增n次，释放时则递减。当计数器为0 时，表示锁已经成功释放。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">公平锁与非公平锁：</strong><br/>
（1）公平锁遵循FIFO原则，先对锁进行获取的线程一定最优先获取锁。公平锁保证了FIFO原则，但是造成了代价非常大的线程切换。<br/>
（2）对于非公平锁，只要CAS设置同步状态成功，就表示当前线程获取了锁。非公平锁虽然会导致饥饿，但是以其极少的线程切换带来了更大的吞吐量。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">ReentrantLock与synchronized的异同：</strong><br/>
同：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）两者都是可重入锁</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">异：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）ReentrantLock是API实现的，而synchronized是JVM实现的。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（2）ReentrantLock比synchronized多实现了一些功能：<br/>
①等待可中断；<br/>
②可实现公平锁；synchronized只能是非公平锁；<br/>
③可实现选择性通知（锁可以绑定多个条件）：线程对象可以注册在指定的Condition中，从而可以有选择性的进行线程通知，在调度线程上更加灵活。 在使用notify()/notifyAll()方法进行通知时，被通知的线程是由 JVM 选择的，用ReentrantLock类结合Condition实例可以实现“选择性通知</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ReetrantLock需要显式地释放锁，而synchronized隐式获取和释放锁</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.3 ReentrantReadWriteLock 读写锁</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">之前的锁都是排他锁，而读写锁在同一时刻可以允许多个读线程访问，但是当写线程访问时，所有的读线程和其他写线程都被阻塞。读写锁维护了一个读锁和一个写锁，通过分离读写提高了性能。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">ReentrantReadWriteLock 读写锁 实现：</strong><br/>
为了在同步状态（一个整型变量）上维护多个读线程和一个写线程，需要将整型变量<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">按位分割</strong>，高16位标识读，低16位标识写。在判断时，通过位运算来得知读和写的锁的获得情况。</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）写锁的获取与释放：写锁是一个支持重进入的<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">排他锁</strong>。当前线程获取写锁时，如果锁已经被当前线程获得了，则增加写状态；如果当前线程不是获得锁的线程或者锁已经被读线程获取，则当前线程等待。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（2）读锁的获取与释放：读锁是一个支持重进入的<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">共享锁</strong>。在没有其他写线程或者写状态为0时，读锁总是被成功获取，读状态增加；当当前线程再次获取读锁时，读状态也增加。当读线程获取锁时，写锁已经被其他写线程获取，则等待。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">锁降级</strong>：<br/>
锁降级是把写锁降级为读锁。必须是保持当前的写锁，获取到读锁后再释放写锁；先释放写锁再获取读锁不算锁降级。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.4 LockSupport</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">LockSupport是一个工具类，它定义了一组公共静态方法，这些方法提供了最基本的线程阻塞和唤醒功能。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.5 Condition接口</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">任意一个Java对象，都拥有一组监视器方法（定义在java.lang.Object上），主要包括wait()、wait(long timeout)、notify()以及notifyAll()方法，这些方法与synchronized同步关键字配合，可以实现等待/通知模式。Condition接口也提供了类似Object的监视器方法，与Lock配合可以实现等待/通知模式，但是这两者在使用方式以及功能特性上还是有差别的。<br/>
<img src="java 并发_files/condition.png" type="image/png" data-filename="condition.png"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Condition对象是由Lock对象创建出来的。获取一个condition必须通过Lock的new Condition()方法。<br/>
Condition定义了等待/通知两种类型的方法，当前线程调用这些方法时，需要提前获取到Condition对象关联的锁。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Condition的实现：</strong></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ConditionObject是同步器AbstractQueuedSynchronizer的内部类，因为Condition的操作需要获取相关联的锁，所以作为同步器的内部类也较为合理。每个Condition对象都包含着一个队列（以下称为等待队列），该队列是Condition对象实现等待/通知功能的关键。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">等待队列</strong>是一个FIFO的队列，在队列中的每个节点都包含了一个线程引用，该线程就是在Condition对象上等待的线程，如果一个线程调用了Condition.await()方法，那么该线程将会释放锁、构造成节点加入等待队列并进入等待状态。事实上，节点的定义复用了同步器中节点的定义，也就是说，同步队列和等待队列中节点类型都是同步器的静态内部类AbstractQueuedSynchronizer.Node。一个Condition包含一个等待队列，Condition拥有首节点（firstWaiter）和尾节点（lastWaiter）。当前线程调用Condition.await()方法，将会以当前线程构造节点，并将节点从尾部加入等待队列。Condition拥有首尾节点的引用，而新增节点只需要将原有的尾节点nextWaiter指向它，并且更新尾节点即可。上述节点引用更新的过程并没有使用CAS保证，原因在于调用await()方法的线程必定是获取了锁的线程，也就是说该过程是由锁来保证线程安全的。<br/>
<img src="java 并发_files/conditionqueue.png" type="image/png" data-filename="conditionqueue.png"/><br/>
<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">等待</strong>：<br/>
调用Condition的await()方法（或者以await开头的方法），会使当前线程进入等待队列并释放锁，同时线程状态变为等待状态。当从await()方法返回时，当前线程一定获取了Condition相关联的锁。如果从队列（同步队列和等待队列）的角度看await()方法，当调用await()方法时，相当于同步队列的首节点（获取了锁的节点）移动到Condition的等待队列中。<br/>
<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">通知：</strong><br/>
调用Condition的signal()方法，将会唤醒在等待队列中等待时间最长的节点（首节点），在唤醒节点之前，会将节点移到同步队列中。调用该方法的前置条件是当前线程必须获取了锁，可以看到signal()方法进行了isHeldExclusively()检查，也就是当前线程必须是获取了锁的线程。接着获取等待队列的首节点，将其移动到同步队列并使用LockSupport唤醒节点中的线程。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">3.6 乐观锁与悲观锁</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">悲观锁</strong>总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁（共享资源每次只给一个线程使用，其它线程阻塞，用完后再把资源转让给其它线程）。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。Java中synchronized和ReentrantLock等独占锁就是悲观锁思想的实现。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">乐观锁</strong>总是假设最好的情况，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">版本号机制和CAS算法</strong>实现。乐观锁适用于多读的应用类型，这样可以提高吞吐量，像数据库提供的类似于write_condition机制，其实都是提供的乐观锁。在Java中java.util.concurrent.atomic包下面的原子变量类就是使用了乐观锁的一种实现方式CAS实现的。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">两种锁的使用场景</strong>从上面对两种锁的介绍，我们知道两种锁各有优缺点，不可认为一种好于另一种，像<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">乐观锁适用于写比较少的情况下（多读场景）</strong>，即冲突真的很少发生的时候，这样可以省去了锁的开销，加大了系统的整个吞吐量。但如果是多写的情况，一般会经常产生冲突，这就会导致上层应用会不断的进行retry，这样反倒是降低了性能，所以一般<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">多写的场景下用悲观锁</strong>就比较合适。</li>
</ul>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">4 java并发容器、框架</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">4.1 ConcurrentHashMap</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.1.1 ConcurrentHashMap 由来</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">（1）HashMap是非线程安全的，在并发执行Put时，会导致entry链表形成环，构成死锁。<br/>
（2）HashTable是线程安全的，但是效率非常低下<br/>
（3）ConcurrentHashMap的锁分段技术可以有效提高并发访问率</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.1.2 ConcurrentHashMap的结构</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ConcurrentHashMap由Segment数组结构和HashEntry数组结构组成。<br/>
<img src="java 并发_files/ConcurrentHashMap的结构.png" type="image/png" data-filename="ConcurrentHashMap的结构.png"/><br/>
Segment是一个可重入锁，HashEntry用来存储键值对数据。相当于每个segment里有一个HashMap（HashEntry数组）。当对HashEntry数组的数据进行修改时，必须先获得这个HashEntry数组对应的Segment锁。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.1.2 ConcurrentHashMap的初始化</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ConcurrentHashMap的初始化通过initialCapacity、loadFactor和concurrencyLevel来初始化segment数组、段偏移量segmentShift、段掩码segmentMask和每个segment里的HashEntry数组。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">segments数组</strong>：segments数组的长度是通过concurrencyLevel计算得出的，必须保证其长度是2的N次方才能使其能通过按位与的方式定位segments数组索引。所以，要找到大于concurrencyLevel的最小2的N次方。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">段偏移量segmentShift、段掩码segmentMask</strong>：这两个全局变量在定位segment时使用。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">初始化每个segment</strong>：用initialCapacity作为初始化容量、loadFactor作为负载因子来初始化每个segment。和HashMap的初始化一样。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.1.3 定位segment</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在插入和获取元素的时候，通过hash算法可以得知当前元素的hashCode。首先要通过一次对于hashCode的散列算法（定位散列算法）定位到对应的segment。这次散列的作用是减少散列冲突，使元素能够均匀地分布在不同的segment中，提高容器的存储效率。<br/>
定位segment使用的算法是（ hash &gt;&gt;&gt; segmentShift )&amp; segmentMask。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.1.4 ConcurrentHashMap的操作</h4>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">get操作：在进行定位segment之后，再次使用散列算法定位到元素。get方法中将其使用的共享元素都设置为volatile，所以get过程不需要加锁，十分高效。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">put操作：zaiput方法中对共享变量进行写入时，必须加锁。加入元素时，首先定位到segment，然后<br/>
（1）判断当前segment里的hashEntry数组是否需要扩容（需要则创建一个新的两倍大的数组，将原数组复制过去）；<br/>
（2）定位到添加元素的位置，进行添加。定位HashEntry使用的算法是hash &amp;（tab.length - 1）。<br/>
<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">在扩容后，不需要重新计算元素的hash，因为元素相对于数组的位置还是不变的。</strong></li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">size操作：统计整个ConcurrentHashMap的大小，需要统计所有segment里元素的大小。segment中的count是一个volatile对象，ConcurrentHashMap先尝试两次不对其他操作加锁的方式来统计count的值，如果统计过程中发生了改变，则再加锁统计。以此来避免每次直接加锁统计导致的性能下降。</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">4.2 ConcurrentLinkedQueue</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ConcurrentLinkedQueue是一个基于链接节点的无界线程安全队列，它采用先进先出的规则对节点进行排序，当我们添加一个元素的时候，它会添加到队列的尾部，当我们获取一个元素时，它会返回队列头部的元素。它采用了“wait－free”算法来实现，该算法在Michael &amp; Scott算法上进行了一些修改。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.2.1 ConcurrentLinkedQueue的结构</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ConcurrentLinkedQueue由<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">head节点</strong>和<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">tail节点</strong>组成，每个节点（Node）由节点元素（item）和指向下一个节点的引用(next)组成，节点与节点之间就是通过这个next关联起来，从而组成一张链表结构的队列。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.2.2 入队列</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">入队列就是将入队节点添加到队列的尾部。<br/>
<img src="java 并发_files/enterqueue.png" type="image/png" data-filename="enterqueue.png"/><br/>
入队操作主要做两件事情，第一是<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">将入队节点设置成当前队列尾节点的下一个节点</strong>。第二是<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">更新tail节点</strong>，如果tail节点的next节点不为空，则将入队节点设置成tail节点，如果tail节点的next节点为空，则将入队节点设置成tail的next节点，所以<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">tail节点不总是尾节点</strong>。<br/>
在图中看来，添加元素1的时候，tail节点等于head节点，next都指向空，所以元素1添加之后，tail节点的next节点为入队节点元素1；添加元素2的时候，tail的next节点不空，为元素1节点，所以添加完元素2后将其设置为tail节点。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">tail节点不一定为尾节点的设计意图</strong>：为了减少更新tail节点的次数来提高入队效率。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.2.3 出队列</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">出队列的就是从队列里返回一个节点元素，并清空该节点对元素的引用。<br/>
<img src="java 并发_files/removequeue.png" type="image/png" data-filename="removequeue.png"/><br/>
该方法的主要逻辑就是首先获取头节点的元素，然后<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">判断头节点元素是否为空</strong>，如果为空，表示另外一个线程已经进行了一次出队操作将该节点的元素取走，如果不为空，则使用CAS的方式将头节点的引用设置成null，如果CAS成功，则直接返回头节点的元素，如果不成功，表示另外一个线程已经进行了一次出队操作更新了head节点，导致元素发生了变化，需要重新获取头节点。<br/>
在图中看来，弹出第一个元素的时候，head节点为空，则说明之前有个线程弹出了头元素，需要重新获取head，所以head被设置成为元素2；弹出第二个元素的时候，head节点不为空，那么直接弹出head的元素，head变成空。<br/>
所以并不是每次出队时都更新head节点，当head节点里有元素时，直接弹出head节点里的元素，而不会更新head节点。只有当head节点里没有元素时，出队操作才会更新head节点。采用这种方式也是为了<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">减少使用CAS更新head节点的消耗，从而提高出队效率</strong>。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">4.3 java阻塞队列</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.3.1 阻塞队列？</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">阻塞队列（BlockingQueue）是一个支持两个附加操作的队列。这两个附加的操作是：在队列为空时，获取元素的线程会等待队列变为非空。当队列满时，存储元素的线程会等待队列可用。阻塞队列常用于生产者和消费者的场景，生产者是往队列里添加元素的线程，消费者是从队列里拿元素的线程。阻塞队列就是生产者存放元素的容器，而消费者也只从容器里拿元素。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">阻塞队列提供了四种处理方法:</p>
<table style="margin: 2px 0 14px; color: #333; width: auto; border-collapse: collapse; box-sizing: border-box;"><thead style="line-height: 160%; box-sizing: content-box;"><tr style="line-height: 160%; box-sizing: content-box;"><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">方法\处理方式</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">抛出异常</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">返回特殊值</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">一直阻塞</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">超时退出</th></tr></thead><tbody style="line-height: 160%; box-sizing: content-box;"><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">插入方法</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">add(e)</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">offer(e)</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">put(e)</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">offer(e,time,unit)</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">移除方法</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">remove()</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">poll()</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">take()</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">poll(time,unit)</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">检查方法</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">element()</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">peek()</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">不可用</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">不可用</td></tr></tbody></table>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.3.2 java中的阻塞队列</h4>
<table style="margin: 2px 0 14px; color: #333; width: auto; border-collapse: collapse; box-sizing: border-box;"><thead style="line-height: 160%; box-sizing: content-box;"><tr style="line-height: 160%; box-sizing: content-box;"><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">队列</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">有界性</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">锁</th><th style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;">数据结构</th></tr></thead><tbody style="line-height: 160%; box-sizing: content-box;"><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">ArrayBlockingQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">bounded(有界)</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">arrayList</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">LinkedBlockingQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">optionally-bounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">linkedList</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">PriorityBlockingQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">unbounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">heap</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">DelayQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">unbounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">heap</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">SynchronousQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">bounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">无</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">LinkedTransferQueue</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">unbounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">加锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">heap</td></tr><tr style="line-height: 160%; box-sizing: content-box;"><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">LinkedBlockingDeque</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">unbounded</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">无锁</td><td style="line-height: 160%; box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;">heap</td></tr></tbody></table>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.3.3 阻塞队列的实现原理</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">使用通知模式。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">4.3.4 fork/join框架</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">fork/join框架是java7提供的用于并行执行任务的框架，是一个把大任务分割成若干个小任务，最后汇总每个小任务结果得到大任务结果的框架。<br/>
fork/join框架首先需要分割任务，其次需要执行任务并合并结果。<br/>
fork/join框架使用：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（1）ForkJoinTask类的子类RecursiveAction和RecursiveTask来提供在任务中的fork()和join()操作。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">（2）ForkJoinPool给ForkJoinTask提供执行条件。</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">当一个工作队列中没有执行任务时，它会使用<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">工作窃取算法</strong>随机从其他队列尾部获取一个任务。这种做法充分利用了线程进行并行计算，但是在某些情况下还是存在竞争，会消耗更多的资源。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">5 java中的原子操作类</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">5.1 原子类 Atomic</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Atomic 是指一个操作是不可中断的。即使是在多个线程一起执行的时候，一个操作一旦开始，就不会被其他线程干扰。所以，所谓原子类说简单点就是具有原子/原子操作特征的类。并发包java.util.concurrent的原子类都存放在java.util.concurrent.atomic下.</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">5.2 JUC中的4类原子类</h3>
<ol style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal;">
<li style="line-height: 160%; box-sizing: content-box;">基本类型：使用原子的方式更新基本类型</li>
</ol>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicInteger：整形原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicLong：长整型原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicBoolean：布尔型原子类</li>
</ul>
<ol start="2" style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal;">
<li style="line-height: 160%; box-sizing: content-box;">数组类型：使用原子的方式更新数组里的某个元素</li>
</ol>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicIntegerArray：整形数组原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicLongArray：长整形数组原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicReferenceArray：引用类型数组原子类</li>
</ul>
<ol start="3" style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal;">
<li style="line-height: 160%; box-sizing: content-box;">引用类型</li>
</ol>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicReference：引用类型原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicStampedReference：原子更新引用类型里的字段原子类</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicMarkableReference ：原子更新带有标记位的引用类型</li>
</ul>
<ol start="4" style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal;">
<li style="line-height: 160%; box-sizing: content-box;">对象的属性修改类</li>
</ol>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicIntegerFieldUpdater：原子更新整形字段的更新器</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicLongFieldUpdater：原子更新长整形字段的更新器</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">AtomicStampedReference：原子更新带有版本号的引用类型。该类将整数值与引用关联起来，可用于解决原子的更新数据和数据的版本号，可以解决使用 CAS 进行原子更新时可能出现的 ABA 问题。</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">5.3 简单分析AtomicInteger 类的原理</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">AtomicInteger 类主要利用 <strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">CAS (compare and swap) + volatile</strong>和 <strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">native</strong> 方法来保证原子操作，从而避免 synchronized 的高开销，执行效率大为提升。CAS的原理是拿期望的值和原本的一个值作比较，如果相同则更新成新的值。UnSafe 类的 objectFieldOffset() 方法是一个本地方法，这个方法是用来拿到“原来的值”的内存地址，返回值是 valueOffset。另外 value 是一个volatile变量，在内存中可见，因此 JVM 可以保证任何时刻任何线程总能拿到该变量的最新值。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">6 java中的并发工具类</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">6.1 CountDownLatch</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">CountDownLatch允许一个或多个线程等待其他线程完成操作。也就是说，CountDownLatch可以实现join()的功能，并且提供了更多的功能。<br/>
CountDownLatch的构造函数接收一个int型的参数作为计数器，需要等待N个点，就传入N。这N个点可以是一个线程里的N个操作，也可以是N个线程。当调用CountDownLatch的countDown方法时，N减一，阻塞当前线程直到N变成0。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">6.2 CyclicBarrier</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">CyclicBarrier让一组线程到达一个屏障（同步点）时被阻塞，直到这组线程中的所有线程都到达屏障，才让这些线程恢复运行。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">CyclicBarrier和CountDownLatch的区别</strong>：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">CountDownLatch 的计数器只能使用一次，而CyclicBarrier的计数器可以使用reset方法重置。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">CyclicBarrier还提供了其他有用的方法。</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">6.3 Semaphore</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Semaphore信号量是用来控制同时访问特定资源的线程数量。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">6.4 Exchanger</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Exchanger是一个用于线程间协作的工具类。用于进行线程之间的数据交换。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">7 线程池</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">合理线程池的好处：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">降低资源消耗：重复利用</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">提高响应速度：不需要等待线程创建</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">提高线程可管理性：统一分配、调优、监控</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">7.1 线程池实现原理</h3>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">7.2 线程池的使用</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">7.2.1 线程池的创建</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">可以通过Executor 框架的工具类Executors或直接使用构造方法ThreadPoolExecutor 来创建线程池。executor框架在8中展开。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">通过ThreadPoolExecutor 来创建线程池，需要以下参数：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">corePoolSize 线程池基本大小</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">runnableTaskQueue 任务队列</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">maximunPoolSize 线程池最大数量</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">threadFactory设置创建线程的工厂</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">RejectedExecutionHandler 饱和策略</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">7.2.2 向线程池提交任务</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">有两种方法可以向线程池提交任务：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">execute() :提交不需要返回值的任务，所以无法判断任务完成与否。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">submit()：提交需要返回值的任务。线程池会返回一个Future类型的对象，通过这个Future对象可以判断任务是否执行成功，并且可以通过future的get()方法来获取返回值，get()方法会阻塞当前线程直到任务完成，而使用 get（long timeout，TimeUnit unit）方法则会阻塞当前线程一段时间后立即返回，这时候有可能任务没有执行完。</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">7.2.3 关闭线程池</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">可以调用shutdown和shutdownNow方法来关闭线程池。原理是遍历线程池中的线程，逐个调用interrupt方法来中断线程，所以无法响应中断的任务可能永远无法终止。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">7.2.4 实现Runnable接口和Callable接口的区别</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果想让线程池执行任务的话需要实现的Runnable接口或Callable接口，这两个接口是线程的工作单元。<br/>
Runnable接口或Callable接口实现类都可以被ThreadPoolExecutor或ScheduledThreadPoolExecutor执行。两者的区别在于 Runnable 接口不会返回结果但是 Callable 接口可以返回结果。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">8 Executor框架</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在JDK5之后，将java线程的工作单元和执行机制分离开来。工作单元包括Runnable接口或Callable接口，执行机制由Executor框架提供。<br/>
8想写了。</p>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%201%20java%20%E5%B9%B6%E5%8F%91%0Ajava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%98%AF%E4%B8%BA%E4%BA%86%E8%AE%A9%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E5%9C%B0%E6%9B%B4%E5%BF%AB%EF%BC%8C%E5%9C%A8%E8%BF%9B%E8%A1%8C%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%97%B6%EF%BC%8C%E4%BC%9A%E9%9D%A2%E4%B8%B4%E5%A6%82%E4%B8%8B%E6%8C%91%E6%88%98%EF%BC%9A%0A-%20%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%BC%80%E9%94%80%0A-%20%E6%AD%BB%E9%94%81%E7%9A%84%E4%BA%A7%E7%94%9F%0A-%20%E8%B5%84%E6%BA%90%E7%9A%84%E9%99%90%E5%88%B6%0A%0A%23%23%23%201.1%20java%20%E5%B9%B6%E5%8F%91%E6%9C%BA%E5%88%B6%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%0A%E5%9C%A8java%E7%BC%96%E7%A8%8B%E4%B8%AD%EF%BC%8Cjava%E6%96%87%E4%BB%B6%E8%BD%AC%E5%8C%96%E4%B8%BA%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E4%BA%A4%E4%BB%98%E7%BB%99JVM%E6%89%A7%E8%A1%8C%EF%BC%8CJVM%E6%9C%80%E7%BB%88%E5%B0%86%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E7%BC%96%E7%A8%8B%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E8%BF%9B%E8%A1%8C%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%89%80%E4%BB%A5java%E5%B9%B6%E5%8F%91%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%80%E7%BB%88%E4%BE%9D%E8%B5%96%E7%9A%84%E8%BF%98%E6%98%AFJVM%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%92%8CCPU%E6%8C%87%E4%BB%A4%E3%80%82%0A%23%23%23%23%201.1.1%20volatile%20%E5%85%B3%E9%94%AE%E8%AF%8D%0Avolatile%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BC%9A%E5%B8%A6%E6%9D%A5%E4%B8%A4%E4%B8%AA%E7%89%B9%E6%80%A7%EF%BC%8C%E4%B8%80%E6%98%AF%E5%8F%AF%E8%A7%81%E6%80%A7%EF%BC%8C%E4%BA%8C%E6%98%AF%E7%A6%81%E6%AD%A2%E9%87%8D%E6%8E%92%E5%BA%8F%E3%80%82%0A%E7%94%B1volatile%E5%85%B3%E9%94%AE%E8%AF%8D%E4%BF%AE%E9%A5%B0%E7%9A%84%E5%8F%98%E9%87%8F%E8%BF%9B%E8%A1%8C%E5%86%99%E6%93%8D%E4%BD%9C%E6%97%B6%E4%BC%9A%E5%87%BA%E7%8E%B0%E4%B8%A4%E8%A1%8C%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%EF%BC%8C%E7%AC%AC%E4%B8%80%E8%A1%8C%E6%98%AF%E5%8E%9F%E6%9C%AC%E7%9A%84%E5%86%99%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%EF%BC%8C%E7%AC%AC%E4%BA%8C%E8%A1%8C%E6%98%AF%E6%9C%89**lock%E5%89%8D%E7%BC%80%E7%9A%84%E6%8C%87%E4%BB%A4**%E3%80%82%E8%BF%99%E4%B8%AAlock%E5%89%8D%E7%BC%80%E7%9A%84%E6%8C%87%E4%BB%A4%E5%9C%A8%E5%A4%9A%E6%A0%B8%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8B%E4%BC%9A%E5%BC%95%E5%8F%91%E4%B8%A4%E4%B8%AA%E6%93%8D%E4%BD%9C%EF%BC%9A%0A-%20%E5%B0%86%E5%BD%93%E5%89%8D%E5%A4%84%E7%90%86%E5%99%A8%E7%BC%93%E5%AD%98%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%86%99%E5%9B%9E%E5%88%B0%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%0A-%20%E4%B8%8A%E8%BF%B0%E5%86%99%E5%9B%9E%E6%93%8D%E4%BD%9C%E4%BC%9A%E4%BD%BF%E5%9C%A8%E5%85%B6%E4%BB%96CPU%E4%B8%AD%E7%BC%93%E5%AD%98%E4%BA%86%E8%AF%A5%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%E7%9A%84%E6%95%B0%E6%8D%AE%E6%97%A0%E6%95%88%0A%0A%E4%B8%BA%E4%BA%86%E6%8F%90%E9%AB%98%E5%A4%84%E7%90%86%E9%80%9F%E5%BA%A6%EF%BC%8C%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8D%E7%9B%B4%E6%8E%A5%E5%92%8C%E5%86%85%E5%AD%98%E8%BF%9B%E8%A1%8C%E9%80%9A%E4%BF%A1%EF%BC%8C%E8%80%8C%E6%98%AF%E5%B0%86%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E7%9A%84%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%88%B0%E5%86%85%E9%83%A8%E7%BC%93%E5%AD%98%E4%B8%AD%E5%86%8D%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BD%86%E6%98%AF%E6%93%8D%E4%BD%9C%E5%AE%8C%E6%88%90%E5%90%8E%E4%B8%8D%E7%9F%A5%E4%BD%95%E6%97%B6%E4%BC%9A%E5%86%99%E5%9B%9E%E5%86%85%E5%AD%98%E3%80%82%E8%80%8C%E5%A3%B0%E6%98%8E%E4%BA%86volatile%E7%9A%84%E5%8F%98%E9%87%8F%E5%9C%A8%E5%86%99%E6%93%8D%E4%BD%9C%E6%97%B6JVM%E4%BC%9A%E5%90%91%E5%A4%84%E7%90%86%E5%99%A8%E5%8F%91%E9%80%81lock%E5%89%8D%E7%BC%80%E7%9A%84%E6%8C%87%E4%BB%A4%EF%BC%8C%E5%B0%86%E5%8F%98%E9%87%8F%E5%80%BC%E5%86%99%E5%9B%9E%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E3%80%82%E5%9C%A8%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8B%EF%BC%8Clock%E6%8C%87%E4%BB%A4%E4%BF%9D%E8%AF%81%E5%9C%A8%E8%AF%A5%E6%8C%87%E4%BB%A4%E5%9C%A8%E5%A3%B0%E9%9F%B3%E6%9C%9F%E9%97%B4%EF%BC%8C%E8%AF%A5%E5%A4%84%E7%90%86%E5%99%A8%E7%8B%AC%E5%8D%A0%E4%BB%BB%E4%BD%95%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E3%80%82%E4%B8%80%E8%88%AC%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BA%BF%E9%94%81%E5%AE%9A%EF%BC%88%E5%BC%80%E9%94%80%E5%BE%88%E5%A4%A7%EF%BC%89%E5%92%8C%E7%BC%93%E5%AD%98%E9%94%81%E5%AE%9A%E3%80%82%0A%E5%9C%A8%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8B%EF%BC%8C%E8%BF%99%E6%A0%B7%E7%9A%84%E6%93%8D%E4%BD%9C%E4%BC%9A%E4%BD%BF%E5%BE%97%E5%85%B6%E4%BB%96%E5%A4%84%E7%90%86%E5%99%A8%E7%BC%93%E5%AD%98%E7%9A%84%E5%80%BC%E8%BF%87%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BA%86%E9%81%BF%E5%85%8D%E4%BD%BF%E7%94%A8%E8%BF%87%E6%97%B6%E7%9A%84%E5%80%BC%EF%BC%8C%E8%BF%9B%E8%A1%8C%E4%BA%86**%E7%BC%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE**%E3%80%82%E5%A4%84%E7%90%86%E5%99%A8%E4%BD%BF%E7%94%A8%E5%97%85%E6%8E%A2%E5%9C%A8%E6%80%BB%E7%BA%BF%E4%B8%8A%E4%BC%A0%E6%92%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%A3%80%E6%9F%A5%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BC%93%E5%AD%98%E6%98%AF%E5%90%A6%E8%BF%87%E6%9C%9F%EF%BC%8C%E4%B8%80%E6%97%A6%E8%BF%87%E6%9C%9F%EF%BC%8C%E5%B0%B1%E5%B0%86%E7%BC%93%E5%AD%98%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%97%A0%E6%95%88%E7%8A%B6%E6%80%81%E3%80%82%0A%0A%23%23%23%23%201.1.2%20synchronized%E5%85%B3%E9%94%AE%E8%AF%8D%0A%E7%94%A8sychronized%E5%AE%9E%E7%8E%B0%E5%90%8C%E6%AD%A5%E6%97%B6%EF%BC%8Cjava%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%8F%AF%E4%BB%A5%E4%BD%9C%E4%B8%BA%E9%94%81%EF%BC%9A%0A-%20%E5%AF%B9%E4%BA%8E%E6%99%AE%E9%80%9A%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%EF%BC%8C%E9%94%81%E6%98%AF%E5%BD%93%E5%89%8D%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1%0A-%20%E5%AF%B9%E4%BA%8E%E9%9D%99%E6%80%81%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%EF%BC%8C%E9%94%81%E6%98%AF%E5%BD%93%E5%89%8D%E7%B1%BB%E7%9A%84Class%E5%AF%B9%E8%B1%A1%0A%20-%20%E5%AF%B9%E4%BA%8E%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%E5%9D%97%EF%BC%8C%E9%94%81%E6%98%AF%E6%8B%AC%E5%8F%B7%E9%87%8C%E9%85%8D%E7%BD%AE%E7%9A%84%E5%AF%B9%E8%B1%A1%0A%20%0A%20**synchronized%E7%9A%84%E5%AE%9E%E7%8E%B0**%EF%BC%9A%0A%20synchronized%E9%80%9A%E8%BF%87JVM%E5%9F%BA%E4%BA%8E%E8%BF%9B%E5%85%A5%E5%92%8C%E9%80%80%E5%87%BAMonitor%E5%AF%B9%E8%B1%A1%E6%9D%A5%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%E5%90%8C%E6%AD%A5%E5%92%8C%E4%BB%A3%E7%A0%81%E5%9D%97%E5%90%8C%E6%AD%A5%E3%80%82%E4%BB%A3%E7%A0%81%E5%9D%97%E5%90%8C%E6%AD%A5%E6%97%B6%EF%BC%8C%E4%BD%BF%E7%94%A8**monitorenter%E5%92%8Cmonitorexit%E6%8C%87%E4%BB%A4**%E6%9D%A5%E5%AE%9E%E7%8E%B0%E3%80%82%0A%20%0A%20%0A%20sychronized%E7%94%A8%E7%9A%84%E9%94%81%E6%98%AF%E5%AD%98%E5%9C%A8%E5%AF%B9%E8%B1%A1%E5%A4%B4%E9%87%8C%E7%9A%84%E3%80%82%E5%9C%A8java%201.6%E4%B9%8B%E5%90%8E%EF%BC%8C%E9%94%81%E7%9A%84%E7%8A%B6%E6%80%81%E4%BB%8E%E4%BD%8E%E5%88%B0%E9%AB%98%E6%9C%894%E7%A7%8D%EF%BC%8C%E5%88%86%E5%88%AB%E6%98%AF%EF%BC%9A%E6%97%A0%E9%94%81%E3%80%81%E5%81%8F%E5%90%91%E9%94%81%E3%80%81%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%E5%92%8C%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E3%80%82%E5%81%8F%E5%90%91%E9%94%81%E5%8F%AF%E4%BB%A5%E8%86%A8%E8%83%80%E4%B8%BA%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%EF%BC%8C%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%E5%8F%AF%E4%BB%A5%E8%86%A8%E8%83%80%E4%B8%BA%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81%E3%80%82%E9%94%81%E4%B8%80%E6%97%A6%E5%8D%87%E7%BA%A7%E4%B8%8D%E8%83%BD%E9%99%8D%E7%BA%A7%E3%80%82%0A%20-%20%E5%81%8F%E5%90%91%E9%94%81%0A%20%E5%9C%A8%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E9%94%81%E4%B8%8D%E4%BB%85%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%AB%9E%E4%BA%89%EF%BC%8C%E5%8F%8D%E8%80%8C%E6%80%BB%E6%98%AF%E7%94%B1%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%A4%9A%E6%AC%A1%E8%8E%B7%E5%BE%97%EF%BC%8C%E4%B8%BA%E4%BA%86%E8%AE%A9%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%BE%97%E9%94%81%E7%9A%84%E4%BB%A3%E4%BB%B7%E9%99%8D%E4%BD%8E%EF%BC%8C%E5%BC%95%E5%85%A5%E5%81%8F%E5%90%91%E9%94%81%E3%80%82%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%90%8C%E6%AD%A5%E5%9D%97%E5%B9%B6%E8%8E%B7%E5%8F%96%E9%94%81%E6%97%B6%EF%BC%8C%E5%9C%A8%E5%AF%B9%E8%B1%A1%E5%A4%B4%E5%92%8C%E6%A0%88%E5%B8%A7%E4%B8%AD%E7%9A%84%E9%94%81%E8%AE%B0%E5%BD%95%E9%87%8C%E5%AD%98%E5%82%A8%E9%94%81%E5%81%8F%E5%90%91%E7%9A%84%E7%BA%BF%E7%A8%8Bid%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%90%8C%E4%B8%80%E4%B8%AA%E9%94%81%E4%B8%8B%E4%B8%80%E6%AC%A1%E8%BF%9B%E5%85%A5%E5%90%8C%E6%AD%A5%E5%9D%97%EF%BC%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E6%B5%8B%E8%AF%95%E5%AF%B9%E8%B1%A1%E5%A4%B4%E4%B8%AD%E6%98%AF%E5%90%A6%E6%9C%89%E6%8C%87%E5%90%91%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%81%8F%E5%90%91%E9%94%81%E3%80%82%0A%20-%20%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%0A%20%E7%BA%BF%E7%A8%8B%E5%9C%A8%E6%89%A7%E8%A1%8C%E5%90%8C%E6%AD%A5%E5%9D%97%E6%97%B6%EF%BC%8CJVM%E4%BC%9A%E5%85%88%E5%9C%A8%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%A0%88%E5%B8%A7%E4%B8%AD%E5%88%9B%E5%BB%BA%E7%94%A8%E4%BA%8E%E5%AD%98%E5%82%A8%E9%94%81%E8%AE%B0%E5%BD%95%E7%9A%84%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%B9%B6%E5%B0%86%E5%AF%B9%E8%B1%A1%E5%A4%B4%E4%B8%AD%E7%9A%84mark%20word%E5%A4%8D%E5%88%B6%E5%88%B0%E9%94%81%E8%AE%B0%E5%BD%95%E4%B8%AD%E3%80%82%E7%84%B6%E5%90%8E%E7%BA%BF%E7%A8%8B%E5%B0%9D%E8%AF%95%E4%BD%BF%E7%94%A8CAS%E5%B0%86%E5%AF%B9%E8%B1%A1%E5%A4%B4%E4%B8%AD%E7%9A%84mark%20word%E6%9B%BF%E6%8D%A2%E4%B8%BA%E6%8C%87%E5%90%91%E9%94%81%E8%AE%B0%E5%BD%95%E7%9A%84%E6%8C%87%E9%92%88%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%88%90%E5%8A%9F%E5%88%99%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%BE%97%E9%94%81%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%A4%B1%E8%B4%A5%E5%88%99%E8%A1%A8%E7%A4%BA%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E7%AB%9E%E4%BA%89%E9%94%81%EF%BC%8C%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%87%AA%E6%97%8B%E4%BB%A5%E8%8E%B7%E5%BE%97%E9%94%81%E3%80%82%0A%20%0A%20%0A%20%0A%23%23%23%23%201.1.3%20%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%0A%0A%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E6%8C%87%E4%B8%8D%E8%83%BD%E8%A2%AB%E4%B8%AD%E6%96%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E6%88%96%E4%B8%80%E7%B3%BB%E5%88%97%E6%93%8D%E4%BD%9C%E3%80%82%0A%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%AD%EF%BC%8C%E4%BD%BF%E7%94%A8%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%E6%9D%A5%E4%BF%9D%E8%AF%81%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%9A%0A-%20%E6%80%BB%E7%BA%BF%E9%94%81%EF%BC%9A%E4%BD%BF%E7%94%A8lock%E4%BF%A1%E5%8F%B7%EF%BC%8C%E5%BD%93%E4%B8%80%E4%B8%AA%E5%A4%84%E7%90%86%E5%99%A8%E5%9C%A8%E6%80%BB%E7%BA%BF%E4%B8%8A%E8%BE%93%E5%87%BA%E6%AD%A4%E4%BF%A1%E5%8F%B7%E6%97%B6%EF%BC%8C%E5%85%B6%E4%BB%96%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E5%85%A8%E9%83%A8%E8%A2%AB%E9%98%BB%E5%A1%9E%EF%BC%8C%E8%AF%A5%E5%A4%84%E7%90%86%E5%99%A8%E7%8B%AC%E4%BA%AB%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E3%80%82%0A-%20%E7%BC%93%E5%AD%98%E9%94%81%E5%AE%9A%EF%BC%9A%E9%A2%91%E7%B9%81%E4%BD%BF%E7%94%A8%E7%9A%84%E5%86%85%E5%AD%98%E4%BC%9A%E7%BC%93%E5%AD%98%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E9%87%8C%EF%BC%8C%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%9B%B4%E6%8E%A5%E5%9C%A8%E7%BC%93%E5%AD%98%E4%B8%AD%E8%BF%9B%E8%A1%8C%EF%BC%8C%E4%B8%8D%E9%9C%80%E6%80%BB%E7%BA%BF%E9%94%81%E3%80%82%E7%BC%93%E5%AD%98%E9%94%81%E5%AE%9A%E5%B0%B1%E6%98%AF%E6%8C%87%EF%BC%8C%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%A6%82%E6%9E%9C%E8%A2%AB%E7%BC%93%E5%AD%98%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E7%9A%84%E7%BC%93%E5%AD%98%E8%A1%8C%E9%87%8C%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%9C%A8lock%E6%9C%9F%E9%97%B4%E8%A2%AB%E9%94%81%E5%AE%9A%EF%BC%8C%E9%82%A3%E4%B9%88%E5%BD%93%E5%AE%83%E6%89%A7%E8%A1%8C%E9%94%81%E6%93%8D%E4%BD%9C%E5%86%99%E5%9B%9E%E5%86%85%E5%AD%98%E6%97%B6%EF%BC%8C%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8D%E5%9C%A8%E6%80%BB%E7%BA%BF%E4%B8%8A%E5%A3%B0%E6%98%8ELock%2C%E8%80%8C%E6%98%AF%E4%BF%AE%E6%94%B9%E5%86%85%E9%83%A8%E7%9A%84%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%B9%B6%E5%85%81%E8%AE%B8%E5%85%B6%E7%BC%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7%E6%9D%A5%E4%BF%9D%E8%AF%81%E5%8E%9F%E5%AD%90%E6%80%A7%E3%80%82%0A%0A**%E7%BC%93%E5%AD%98%E9%94%81%E5%AE%9A%E7%9A%84%E4%B8%8D%E9%80%82%E7%94%A8%E6%83%85%E5%86%B5**%EF%BC%9A%0A-%20%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E8%B7%A8%E5%A4%9A%E4%B8%AA%E7%BC%93%E5%AD%98%E8%A1%8C%E6%88%96%E8%80%85%E6%95%B0%E6%8D%AE%E4%B8%8D%E8%83%BD%E8%A2%AB%E7%BC%93%E5%AD%98%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E5%86%85%E9%83%A8%E6%97%B6%EF%BC%9B%0A-%20%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%8D%E6%94%AF%E6%8C%81%E7%BC%93%E5%AD%98%E9%94%81%E5%AE%9A%E6%97%B6%E3%80%82%0A%0A%E5%A4%84%E7%90%86%E5%99%A8%E5%A6%82%E4%BD%95**%E5%AE%9E%E7%8E%B0%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C**%EF%BC%9A%E9%94%81%20%E5%92%8C%20%E5%BE%AA%E7%8E%AFCAS%0ACAS%E5%AE%9E%E7%8E%B0%E5%8E%9F%E5%AD%90%E6%80%A7%E7%9A%84%E4%B8%89%E4%B8%AA%E9%97%AE%E9%A2%98%EF%BC%9A%0A-%20ABA%E9%97%AE%E9%A2%98%0A-%20%E5%BE%AA%E7%8E%AF%E6%97%B6%E9%97%B4%E9%95%BF%E5%BC%80%E9%94%80%E5%A4%A7%0A-%20%E5%8F%AA%E8%83%BD%E4%BF%9D%E8%AF%81%E4%B8%80%E4%B8%AA%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E7%9A%84%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E3%80%82%0A%23%23%23%201.2%20java%20%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%20%20JMM%0Ajava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%AD%E6%9C%80%E9%87%8D%E8%A6%81%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%97%AE%E9%A2%98**%E5%90%8C%E6%AD%A5**%E5%92%8C**%E9%80%9A%E4%BF%A1**%E3%80%82%0A%E5%90%8C%E6%AD%A5%E6%98%AF%E6%8C%87%E6%8E%A7%E5%88%B6%E4%B8%8D%E5%90%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%93%8D%E4%BD%9C%E5%8F%91%E7%94%9F%E7%9A%84%E9%A1%BA%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%88%B6%E3%80%82%E5%9C%A8%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E6%A8%A1%E5%9E%8B%E4%B8%AD%EF%BC%8C%E5%90%8C%E6%AD%A5%E6%98%AF%E6%98%BE%E5%BC%8F%E7%9A%84%E3%80%82%E5%9C%A8%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92%E7%9A%84%E6%A8%A1%E5%9E%8B%E4%B8%AD%EF%BC%8C%E5%90%8C%E6%AD%A5%E6%98%AF%E9%9A%90%E5%BC%8F%E7%9A%84%E3%80%82%0AJava%E9%87%87%E7%94%A8%E7%9A%84%E6%98%AF%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B%EF%BC%8C%E5%90%8C%E6%AD%A5%E6%98%AF%E6%98%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%8C%E9%80%9A%E4%BF%A1%E6%98%AF%E9%9A%90%E5%BC%8F%E8%BF%9B%E8%A1%8C%E7%9A%84%E3%80%82%0A%23%23%23%23%201.2.1%20java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%8A%BD%E8%B1%A1%E7%BB%93%E6%9E%84%0Ajava%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%EF%BC%8C%E7%94%B1java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BJMM%E6%8E%A7%E5%88%B6%E3%80%82%0A%E5%A6%82%E5%9B%BE%E6%89%80%E7%A4%BA%EF%BC%8CJMM%E9%80%9A%E8%BF%87%E6%8E%A7%E5%88%B6%E4%B8%BB%E5%86%85%E5%AD%98%E4%B8%8E%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%9C%AC%E5%9C%B0%E5%86%85%E5%AD%98%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BA%A4%E4%BA%92%EF%BC%8C%E6%9D%A5%E5%AE%9E%E7%8E%B0%E5%86%85%E5%AD%98%E5%8F%AF%E8%A7%81%E6%80%A7%E3%80%82%0A%E4%B8%BB%E5%86%85%E5%AD%98%E4%B8%AD%E5%AD%98%E6%94%BE%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%EF%BC%8C%E6%9C%AC%E5%9C%B0%E5%86%85%E5%AD%98%E4%B8%AD%E5%AD%98%E6%94%BE%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%8B%A5%E6%9C%89%E7%9A%84%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E7%9A%84%E5%89%AF%E6%9C%AC%E3%80%82%0A!%5B6eab5dd74d33e98456d903cc2044fc45.png%5D(en-resource%3A%2F%2Fdatabase%2F869%3A1)%0A%E4%BB%8E%E5%9B%BE%E4%B8%AD%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%87%BA%EF%BC%8C%E5%A6%82%E6%9E%9CA%E5%92%8CB%E8%A6%81%E9%80%9A%E4%BF%A1%EF%BC%8C%E9%9C%80%E8%A6%81%E6%9C%89%E4%B8%A4%E4%B8%AA%E6%AD%A5%E9%AA%A4%EF%BC%9A%0A-%20A%E6%8A%8A%E6%9C%AC%E5%9C%B0%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E5%88%B7%E6%96%B0%E5%88%B0%E5%86%85%E5%AD%98%E4%B8%AD%E5%8E%BB%0A-%20%E7%BA%BF%E7%A8%8BB%E5%88%B0%E4%B8%BB%E5%86%85%E5%AD%98%E4%B8%AD%E5%8E%BB%E8%AF%BBA%E6%9B%B4%E6%96%B0%E8%BF%87%E7%9A%84%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%0A%0A%20**%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E6%9C%89%E5%93%AA%E4%BA%9B%3F**%0A%0A%E5%9C%A8java%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%89%80%E6%9C%89**%E5%AE%9E%E4%BE%8B%E5%9F%9F%EF%BC%8C%E9%9D%99%E6%80%81%E5%9F%9F%E5%92%8C%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0**%E9%83%BD%E6%98%AF%E6%94%BE%E5%9C%A8%E5%A0%86%E5%86%85%E5%AD%98%E4%B8%AD%EF%BC%88%E6%89%80%E6%9C%89%E7%BA%BF%E7%A8%8B%E5%9D%87%E5%8F%AF%E8%AE%BF%E9%97%AE%E5%88%B0%EF%BC%8C%E6%98%AF%E5%8F%AF%E4%BB%A5%E5%85%B1%E4%BA%AB%E7%9A%84%EF%BC%89%EF%BC%8C%E8%80%8C%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%EF%BC%8C%E6%96%B9%E6%B3%95%E5%AE%9A%E4%B9%89%E5%8F%82%E6%95%B0%E5%92%8C%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8%E5%8F%82%E6%95%B0%E4%B8%8D%E4%BC%9A%E5%9C%A8%E7%BA%BF%E7%A8%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E3%80%82%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E4%BC%9A%E5%87%BA%E7%8E%B0%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E8%80%8C%E9%9D%9E%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%BC%9A%E5%87%BA%E7%8E%B0%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E9%97%AE%E9%A2%98%E3%80%82%E5%85%B3%E4%BA%8EJVM%E8%BF%90%E8%A1%8C%E6%97%B6%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%9C%A8%E5%90%8E%E9%9D%A2%E7%9A%84%E6%96%87%E7%AB%A0%E4%BC%9A%E8%AE%B2%E5%88%B0%E3%80%82%0A%0A%0A%23%23%23%23%201.2.2%20%E9%87%8D%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C%0A%E5%9C%A8%E6%89%A7%E8%A1%8C%E6%8C%87%E4%BB%A4%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BA%86%E6%8F%90%E9%AB%98%E6%95%88%E7%8E%87%EF%BC%8C%E7%BC%96%E8%AF%91%E5%99%A8%E5%92%8C%E5%A4%84%E7%90%86%E5%99%A8%E9%80%9A%E5%B8%B8%E4%BC%9A%E5%AF%B9%E6%8C%87%E4%BB%A4%E8%BF%9B%E8%A1%8C%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%8C%E5%88%86%E6%88%90%E4%B8%89%E7%A7%8D%E7%B1%BB%E5%9E%8B%EF%BC%9A%0A-%20%E7%BC%96%E8%AF%91%E5%99%A8%E4%BC%98%E5%8C%96%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%9A%E7%BC%96%E8%AF%91%E5%99%A8%E5%9C%A8%E4%B8%8D%E6%94%B9%E5%8F%98%E8%AF%AD%E4%B9%89%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E9%87%8D%E6%96%B0%E5%AE%89%E6%8E%92%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E3%80%82%0A-%20%E6%8C%87%E4%BB%A4%E7%BA%A7%E5%B9%B6%E8%A1%8C%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%9A%20%E5%A4%84%E7%90%86%E5%99%A8%E4%BD%BF%E7%94%A8%E6%8C%87%E4%BB%A4%E7%BA%A7%E5%B9%B6%E8%A1%8C%E6%8A%80%E6%9C%AF%E3%80%82%0A-%20%E5%86%85%E5%AD%98%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%9A%E5%A4%84%E7%90%86%E5%99%A8%E4%BD%BF%E7%94%A8%E7%BC%93%E5%AD%98%E5%92%8C%E8%AF%BB%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BA%E3%80%82%0A%0A%E4%BD%86%E6%98%AF%E9%87%8D%E6%8E%92%E5%BA%8F%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%AF%BC%E8%87%B4%E7%BA%BF%E7%A8%8B%E7%A8%8B%E5%BA%8F%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E5%8F%AF%E8%A7%81%E6%80%A7%E9%97%AE%E9%A2%98%EF%BC%8C%E6%89%80%E4%BB%A5JMM%E7%BC%96%E8%AF%91%E5%99%A8%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%E7%A6%81%E6%AD%A2%E7%89%B9%E5%AE%9A%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%BC%96%E8%AF%91%E5%99%A8%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%9BJMM%E5%A4%84%E7%90%86%E5%99%A8%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%E4%BC%9A%E8%A6%81%E6%B1%82%E7%BC%96%E8%AF%91%E5%99%A8%E5%9C%A8%E7%94%9F%E6%88%90%E6%8C%87%E4%BB%A4%E5%BA%8F%E5%88%97%E6%97%B6%E6%8F%92%E5%85%A5%E7%89%B9%E5%AE%9A%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C%E6%9D%A5%E7%A6%81%E6%AD%A2%E7%89%B9%E5%AE%9A%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E3%80%82%0A!%5Ba6b0a9f7d7188c2c665d7e69a05b5b51.png%5D(en-resource%3A%2F%2Fdatabase%2F871%3A1)%0A%0A%23%23%23%23%201.2.3%20%E4%B8%80%E4%BA%9B%E8%A7%84%E5%88%99%0A%23%23%23%23%23%20%EF%BC%881%EF%BC%89happens-before%0Ahappens-before%E6%98%AFJMM%E4%B8%AD%E6%9C%80%E6%A0%B8%E5%BF%83%E7%9A%84%E6%A6%82%E5%BF%B5%E3%80%82happens-before%E5%85%B3%E7%B3%BB%E7%9A%84%E5%AE%9A%E4%B9%89%E5%A6%82%E4%B8%8B%EF%BC%9A%0A-%20%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9Chappens-before%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9C%EF%BC%8C%E9%82%A3%E4%B9%88%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9C%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%B0%86%E5%AF%B9%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%93%8D%E4%BD%9C%E5%8F%AF%E8%A7%81%EF%BC%8C%E8%80%8C%E4%B8%94%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9C%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E5%9C%A8%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%89%8D%E3%80%82%0A-%20%E4%B8%A4%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%B9%8B%E9%97%B4%E5%AD%98%E5%9C%A8happens-before%E5%85%B3%E7%B3%BB%EF%BC%8C%E5%B9%B6%E4%B8%8D%E6%84%8F%E5%91%B3%E7%9D%80java%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%E5%BF%85%E9%A1%BB%E8%A6%81%E6%8C%89%E7%85%A7happens-before%E5%85%B3%E7%B3%BB%E6%8C%87%E5%AE%9A%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%9D%A5%E6%89%A7%E8%A1%8C%E3%80%82%E5%A6%82%E6%9E%9C%E9%87%8D%E6%8E%92%E5%BA%8F%E4%B9%8B%E5%90%8E%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E4%B8%8E%E6%8C%89%E7%85%A7happens-before%E6%9D%A5%E6%89%A7%E8%A1%8C%E7%9A%84%E7%BB%93%E6%9E%9C%E4%B8%80%E8%87%B4%EF%BC%8C%E8%BF%99%E7%A7%8D%E9%87%8D%E6%8E%92%E5%BA%8F%E5%B9%B6%E4%B8%8D%E9%9D%9E%E6%B3%95%E3%80%82%0A%0A**happens-before%E8%A7%84%E5%88%99**%EF%BC%9A%0A-%20%EF%BC%881%EF%BC%89%E7%A8%8B%E5%BA%8F%E9%A1%BA%E5%BA%8F%E8%A7%84%E5%88%99%EF%BC%9A%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E6%93%8D%E4%BD%9C%EF%BC%8Chappens-before%E4%BA%8E%E8%AF%A5%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%BB%BB%E6%84%8F%E5%90%8E%E7%BB%AD%E6%93%8D%E4%BD%9C%E3%80%82%0A-%20%EF%BC%882%EF%BC%89%E7%9B%91%E8%A7%86%E5%99%A8%E9%94%81%E8%A7%84%E5%88%99%EF%BC%9A%E5%AF%B9%E4%B8%80%E4%B8%AA%E9%94%81%E7%9A%84%E8%A7%A3%E9%94%81%EF%BC%8Chappens-before%E4%BA%8E%E9%9A%8F%E5%90%8E%E5%AF%B9%E8%BF%99%E4%B8%AA%E9%94%81%E7%9A%84%E5%8A%A0%E9%94%81%E3%80%82%0A-%20%EF%BC%883%EF%BC%89volatile%E5%8F%98%E9%87%8F%E8%A7%84%E5%88%99%EF%BC%9A%E5%AF%B9%E4%B8%80%E4%B8%AAvolatile%E5%9F%9F%E7%9A%84%E5%86%99%EF%BC%8Chappens-before%E4%BA%8E%E4%BB%BB%E6%84%8F%E5%90%8E%E7%BB%AD%E5%AF%B9%E8%BF%99%E4%B8%AAvolatile%E5%9F%9F%E7%9A%84%E8%AF%BB%E3%80%82%0A-%20%EF%BC%884%EF%BC%89%E4%BC%A0%E9%80%92%E6%80%A7%EF%BC%9A%E5%A6%82%E6%9E%9CA%20happens-before%20B%EF%BC%8C%E4%B8%94B%20happens-before%20C%EF%BC%8C%E9%82%A3%E4%B9%88A%20happens-before%20C%E3%80%82%0A-%20%EF%BC%885%EF%BC%89start()%E8%A7%84%E5%88%99%EF%BC%9A%E5%A6%82%E6%9E%9C%E7%BA%BF%E7%A8%8BA%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9CThreadB.start()%EF%BC%88%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8BB%EF%BC%89%EF%BC%8C%E9%82%A3%E4%B9%88A%E7%BA%BF%E7%A8%8B%E7%9A%84ThreadB.start()%E6%93%8D%E4%BD%9Chappens-before%E4%BA%8E%E7%BA%BF%E7%A8%8BB%E4%B8%AD%E7%9A%84%E4%BB%BB%E6%84%8F%E6%93%8D%E4%BD%9C%E3%80%82%0A-%20%EF%BC%886%EF%BC%89join()%E8%A7%84%E5%88%99%EF%BC%9A%E5%A6%82%E6%9E%9C%E7%BA%BF%E7%A8%8BA%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9CThreadB.join()%E5%B9%B6%E6%88%90%E5%8A%9F%E8%BF%94%E5%9B%9E%EF%BC%8C%E9%82%A3%E4%B9%88%E7%BA%BF%E7%A8%8BB%E4%B8%AD%E7%9A%84%E4%BB%BB%E6%84%8F%E6%93%8D%E4%BD%9Chappens-before%E4%BA%8E%E7%BA%BF%E7%A8%8BA%E4%BB%8EThreadB.join()%E6%93%8D%E4%BD%9C%E6%88%90%E5%8A%9F%E8%BF%94%E5%9B%9E%E3%80%82%0A%0A%0A%23%23%23%23%23%20%EF%BC%882%EF%BC%89as-if-serial%0Aas-if-serial%E7%9A%84%E8%AF%AD%E4%B9%89%E6%98%AF%EF%BC%9A%E4%B8%8D%E7%AE%A1%E6%80%8E%E4%B9%88%E9%87%8D%E6%8E%92%E5%BA%8F%EF%BC%8C%EF%BC%88%E5%8D%95%E7%BA%BF%E7%A8%8B%EF%BC%89%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E4%B8%8D%E8%83%BD%E8%A2%AB%E6%94%B9%E5%8F%98%E3%80%82%0A%E7%BC%96%E8%AF%91%E5%99%A8%E3%80%81runtime%E5%92%8C%E5%A4%84%E7%90%86%E5%99%A8%E5%BF%85%E9%A1%BB%E9%81%B5%E5%AE%88%E8%BF%99%E4%B8%AA%E8%AF%AD%E4%B9%89%E3%80%82%0Aas-if-serial%E5%AE%9E%E9%99%85%E4%B8%8A%E5%92%8Chappens-before%E5%85%B3%E7%B3%BB%E6%98%AF%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%9A%0A-%20as-if-serial%E8%AF%AD%E4%B9%89%E4%BF%9D%E8%AF%81%E5%8D%95%E7%BA%BF%E7%A8%8B%E5%86%85%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E4%B8%8D%E8%A2%AB%E6%94%B9%E5%8F%98%EF%BC%8Chappens-before%E4%BF%9D%E8%AF%81%E6%AD%A3%E7%A1%AE%E5%90%8C%E6%AD%A5%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%9C%E4%B8%8D%E8%A2%AB%E6%94%B9%E5%8F%98%0A-%20as-if-serial%E7%BB%99%E5%86%99%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%91%98%E5%91%88%E7%8E%B0%E5%87%BA%E6%8C%89%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%E7%9A%84%E6%A0%B7%E5%AD%90%EF%BC%8Chappens-before%E7%BB%99%E5%86%99%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%91%98%E5%91%88%E7%8E%B0%E5%87%BA%E6%8C%89%E6%8C%87%E5%AE%9A%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%E7%9A%84%E6%A0%B7%E5%AD%90%E3%80%82%0A%0A%23%23%23%23%23%20%EF%BC%883%EF%BC%89%E9%A1%BA%E5%BA%8F%E4%B8%80%E8%87%B4%E6%80%A7%0A%E9%A1%BA%E5%BA%8F%E4%B8%80%E8%87%B4%E6%80%A7%E6%A8%A1%E5%9E%8B%E6%98%AF%E4%B8%80%E4%B8%AA%E7%90%86%E6%83%B3%E5%8C%96%E7%9A%84%E6%A8%A1%E5%9E%8B%EF%BC%8C%E8%AF%A5%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%B8%A4%E5%A4%A7%E7%89%B9%E6%80%A7%EF%BC%9A%0A-%20%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%93%8D%E4%BD%9C%E5%BF%85%E9%A1%BB%E6%8C%89%E7%85%A7%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%9D%A5%E6%89%A7%E8%A1%8C%0A-%20%EF%BC%88%E4%B8%8D%E7%AE%A1%E7%A8%8B%E5%BA%8F%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%90%A6%EF%BC%89%E6%89%80%E6%9C%89%E7%BA%BF%E7%A8%8B%E9%83%BD%E5%8F%AA%E8%83%BD%E7%9C%8B%E5%88%B0%E4%B8%80%E4%B8%AA%E5%8D%95%E4%B8%80%E7%9A%84%E6%93%8D%E4%BD%9C%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E3%80%82%E5%9C%A8%E9%A1%BA%E5%BA%8F%E4%B8%80%E8%87%B4%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%AD%EF%BC%8C%E6%AF%8F%E4%B8%AA%E6%93%8D%E4%BD%9C%E9%83%BD%E5%BF%85%E9%A1%BB%E5%8E%9F%E5%AD%90%E6%89%A7%E8%A1%8C%E4%B8%94%E7%AB%8B%E5%88%BB%E5%AF%B9%E6%89%80%E6%9C%89%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%A7%81%E3%80%82%0A%0A%E5%9C%A8%E6%9C%AA%E5%90%8C%E6%AD%A5%E7%A8%8B%E5%BA%8F%E4%B8%AD%EF%BC%8CJMM%E5%8F%AA%E6%8F%90%E4%BE%9B%E6%9C%80%E5%B0%8F%E5%AE%89%E5%85%A8%E6%80%A7%EF%BC%8CJVM%E5%9C%A8%E5%A0%86%E4%B8%8A%E5%88%86%E9%85%8D%E5%AF%B9%E8%B1%A1%E6%97%B6%EF%BC%8C%E4%BC%9A%E5%85%88%E5%AF%B9%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%E6%B8%85%E9%9B%B6%E5%86%8D%E5%88%86%E9%85%8D%EF%BC%8C%E6%89%80%E4%BB%A5JMM%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E8%AF%BB%E5%88%B0%E7%9A%84%E5%80%BC%E4%B8%8D%E4%BC%9A%E6%97%A0%E4%B8%AD%E7%94%9F%E6%9C%89%EF%BC%8C%E8%A6%81%E4%B9%88%E6%98%AF%E9%BB%98%E8%AE%A4%E5%80%BC%EF%BC%8C%E8%A6%81%E4%B9%88%E6%98%AF%E4%B9%8B%E5%89%8D%E6%9F%90%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%86%99%E5%85%A5%E7%9A%84%E5%80%BC%E3%80%82%E4%BD%86%E6%98%AF%E4%B8%8D%E4%BF%9D%E8%AF%81%E8%BF%99%E4%B8%AA%E5%80%BC%E6%98%AF%E6%AD%A3%E7%A1%AE%E7%9A%84%E3%80%82%0A%0A%0A%23%23%23%23%201.2.4%20%E5%86%85%E5%AD%98%E4%B8%ADvolatile%20%E7%9A%84%E8%AF%AD%E4%B9%89%0Avolatile%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E8%AF%BB%E5%92%8C%E5%86%99%E7%9A%84%E8%AF%AD%E4%B9%89%EF%BC%9A%0A-%20%E7%BA%BF%E7%A8%8BA%E5%86%99%E4%B8%80%E4%B8%AAvolatile%E5%8F%98%E9%87%8F%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E7%BA%BF%E7%A8%8BA%E5%90%91%E6%8E%A5%E4%B8%8B%E6%9D%A5%E8%A6%81%E8%AF%BB%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%8F%91%E5%87%BA%E4%BA%86%E6%B6%88%E6%81%AF%E3%80%82%0A-%20%E7%BA%BF%E7%A8%8BB%E8%AF%BB%E4%B8%80%E4%B8%AAvolatile%E5%8F%98%E9%87%8F%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E7%BA%BF%E7%A8%8BB%E6%94%B6%E5%88%B0%E4%BA%86%E7%BB%99%E4%BB%96%E5%8F%91%E7%9A%84%E6%9C%89%E5%85%B3%E5%8F%98%E9%87%8F%E8%A2%AB%E4%BF%AE%E6%94%B9%E7%9A%84%E6%B6%88%E6%81%AF%E3%80%82%0A-%20%E7%BA%BF%E7%A8%8BA%E5%86%99volatile%E5%8F%98%E9%87%8F%EF%BC%8C%E7%BA%BF%E7%A8%8BB%E8%AF%BBvolatile%E5%8F%98%E9%87%8F%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E7%BA%BF%E7%A8%8BA%E5%92%8CB%E9%80%9A%E8%BF%87%E4%B8%BB%E5%86%85%E5%AD%98%E9%80%9A%E4%BF%A1%E7%9A%84%E8%BF%87%E7%A8%8B%E3%80%82%0A%0Avolatile%E5%8F%98%E9%87%8F%E7%9A%84%E8%AF%AD%E4%B9%89%E5%AE%9E%E7%8E%B0%E9%80%9A%E8%BF%87%E5%9C%A8%E6%8C%87%E4%BB%A4%E9%97%B4%E5%8A%A0%E5%85%A5%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C%E6%9D%A5%E5%AE%9E%E7%8E%B0%E3%80%82%0A%0A%23%23%23%23%201.2.5%20%E5%86%85%E5%AD%98%E4%B8%AD%E9%94%81%E7%9A%84%E8%AF%AD%E4%B9%89%0A%E9%94%81%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E9%87%8A%E6%94%BE%E5%92%8C%E8%8E%B7%E5%8F%96%E7%9A%84%E8%AF%AD%E4%B9%89%EF%BC%9A%0A-%20%E7%BA%BF%E7%A8%8BA%E9%87%8A%E6%94%BE%E4%B8%80%E4%B8%AA%E9%94%81%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AFA%E5%90%91%E6%8E%A5%E4%B8%8B%E6%9D%A5%E8%A6%81%E4%BD%BF%E7%94%A8%E8%BF%99%E4%B8%AA%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%8F%91%E5%87%BA%E4%BA%86%E6%B6%88%E6%81%AF%E3%80%82%0A-%20%E7%BA%BF%E7%A8%8BB%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E9%94%81%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E6%94%B6%E5%88%B0%E4%BA%86%E4%B9%8B%E5%89%8D%E6%9F%90%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%87%8A%E6%94%BE%E8%BF%99%E4%B8%AA%E9%94%81%E7%9A%84%E6%B6%88%E6%81%AF%E3%80%82%0A-%20%E7%BA%BF%E7%A8%8BA%E9%87%8A%E6%94%BE%E9%94%81%EF%BC%8C%E7%BA%BF%E7%A8%8BB%E8%8E%B7%E5%8F%96%E8%BF%99%E4%B8%AA%E9%94%81%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E7%BA%BF%E7%A8%8BA%E9%80%9A%E8%BF%87%E4%B8%BB%E5%86%85%E5%AD%98%E5%90%91%E7%BA%BF%E7%A8%8BB%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E3%80%82%0A%0A%E9%94%81%E7%9A%84%E8%AF%AD%E4%B9%89%E5%AE%9E%E7%8E%B0%EF%BC%9A%0A-%20%E4%BD%BF%E7%94%A8volatile%E5%8F%98%E9%87%8F%E7%9A%84%E5%86%99-%E8%AF%BB%E9%94%81%E5%85%B7%E6%9C%89%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89%0A-%20%E4%BD%BF%E7%94%A8CAS%E9%94%81%E9%99%84%E5%B8%A6%E7%9A%84volatile%20%E8%AF%BB%E5%92%8C%E5%86%99%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89%0A%23%23%23%23%201.2.6%20%E5%86%85%E5%AD%98%E4%B8%ADfinal%E7%9A%84%E4%B8%8E%E6%84%8F%E4%B9%89%0A%E5%AF%B9%E4%BA%8Efinal%E5%9F%9F%EF%BC%8C%E7%BC%96%E8%AF%91%E5%99%A8%E5%92%8C%E5%A4%84%E7%90%86%E5%99%A8%E9%9C%80%E8%A6%81%E9%81%B5%E5%BE%AA%E4%B8%A4%E4%B8%AA%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%0A-%20%EF%BC%881%EF%BC%89%E5%86%99%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%EF%BC%9A%E5%9C%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%86%85%E5%AF%B9%E4%B8%80%E4%B8%AAfinal%E5%9F%9F%E7%9A%84%E5%86%99%E5%85%A5%EF%BC%8C%E4%B8%8E%E9%9A%8F%E5%90%8E%E6%8A%8A%E8%BF%99%E4%B8%AA%E8%A2%AB%E6%9E%84%E9%80%A0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%95%E7%94%A8%E8%B5%8B%E5%80%BC%E7%BB%99%E4%B8%80%E4%B8%AA%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F%EF%BC%8C%E8%BF%99%E4%B8%A4%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%B8%8D%E8%83%BD%E9%87%8D%E6%8E%92%E5%BA%8F%E3%80%82%E8%BF%99%E4%B8%AA%E8%A7%84%E5%88%99%E4%BF%9D%E8%AF%81%E4%BA%86**%E5%9C%A8%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%95%E7%94%A8%E4%B8%BA%E4%BB%BB%E6%84%8F%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%A7%81%E4%B9%8B%E5%89%8D%EF%BC%8C%E5%AF%B9%E8%B1%A1%E7%9A%84final%E5%9F%9F%E5%B7%B2%E7%BB%8F%E8%A2%AB%E6%AD%A3%E7%A1%AE%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E4%BA%86**%E3%80%82%0A-%20%EF%BC%882%EF%BC%89%E8%AF%BB%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%EF%BC%9A%E5%88%9D%E6%AC%A1%E8%AF%BB%E4%B8%80%E4%B8%AA%E5%8C%85%E5%90%ABfinal%E5%9F%9F%E7%9A%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%8C%E4%B8%8E%E9%9A%8F%E5%90%8E%E5%88%9D%E6%AC%A1%E8%AF%BB%E8%BF%99%E4%B8%AAfinal%E5%9F%9F%EF%BC%8C%E8%BF%99%E4%B8%A4%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%B8%8D%E8%83%BD%E9%87%8D%E6%8E%92%E5%BA%8F%E3%80%82%E8%BF%99%E4%B8%AA%E8%A7%84%E5%88%99%E4%BF%9D%E8%AF%81%E4%BA%86**%E5%9C%A8%E8%AF%BB%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84final%E5%9F%9F%E4%B9%8B%E5%89%8D%EF%BC%8C%E4%B8%80%E5%AE%9A%E4%BC%9A%E5%85%88%E8%AF%BB%E5%8C%85%E5%90%AB%E8%BF%99%E4%B8%AAfinal%E5%9F%9F%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%95%E7%94%A8**%E3%80%82%0A%0Afinal%E7%9A%84%E8%AF%AD%E4%B9%89%E5%AE%9E%E7%8E%B0%E9%80%9A%E8%BF%87%E5%9C%A8%E6%8C%87%E4%BB%A4%E9%97%B4%E5%8A%A0%E5%85%A5%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C%E6%9D%A5%E5%AE%9E%E7%8E%B0%E3%80%82%0A%0A%23%23%23%23%201.2.7%20%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E9%94%81%E5%AE%9A%0A%E5%9C%A8java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A8%8B%E5%BA%8F%E4%B8%AD%EF%BC%8C%E6%9C%89%E6%97%B6%E9%9C%80%E8%A6%81%E9%87%87%E7%94%A8%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E6%9D%A5%E6%8E%A8%E8%BF%9F%E4%B8%80%E4%BA%9B%E9%AB%98%E5%BC%80%E9%94%80%E7%9A%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%93%8D%E4%BD%9C%EF%BC%8C%E5%8F%AA%E6%9C%89%E5%BD%93%E4%BD%BF%E7%94%A8%E8%BF%99%E4%BA%9B%E5%AF%B9%E8%B1%A1%E6%97%B6%E6%89%8D%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%E4%BD%86%E5%9C%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E6%9C%89%E5%8F%AF%E8%83%BD%E8%A7%A6%E5%8F%91%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%93%8D%E4%BD%9C%E3%80%82%0A%0A%E5%8E%86%E5%8F%B2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%951%EF%BC%9A%E4%BD%BF%E7%94%A8synchronized%E6%9D%A5%E5%90%8C%E6%AD%A5%E5%A4%84%E7%90%86%0A%E7%BC%BA%E7%82%B9%EF%BC%9Asychronized%E5%9C%A8%E6%95%B4%E4%B8%AA%E5%87%BD%E6%95%B0%E4%B8%8A%EF%BC%8C%E5%AF%BC%E8%87%B4%E5%BC%80%E9%94%80%E5%A4%AA%E9%AB%98%EF%BC%8C%E6%80%A7%E8%83%BD%E4%B8%8B%E9%99%8D%E3%80%82%0A%0A%E5%8E%86%E5%8F%B2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%882%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E9%94%81%E5%AE%9A%E6%9D%A5%E5%AE%9E%E7%8E%B0%EF%BC%9A%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%A3%80%E6%9F%A5%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E6%9C%AA%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%99%E5%8A%A0%E9%94%81%EF%BC%8C%E5%86%8D%E6%AC%A1%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E6%9C%AA%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%99%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A%E7%BC%BA%E7%82%B9%EF%BC%9A%E5%B8%A6%E6%9D%A5%E4%BA%86%E9%94%99%E8%AF%AF%EF%BC%9A%E7%94%B1%E4%BA%8E%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E9%A6%96%E5%85%88%E8%A6%81%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%AF%B9%E8%B1%A1%E6%8C%87%E5%90%91%E5%88%86%E9%85%8D%E7%9A%84%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%86%8D%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E8%BF%99%E4%B8%89%E4%B8%AA%E6%AD%A5%E9%AA%A4%E5%90%88%E6%88%90%E4%BA%86%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E7%9A%84%E6%AD%A5%E9%AA%A4%E3%80%82%E4%BD%86%E6%98%AF%E6%9C%89%E5%8F%AF%E8%83%BD%E5%86%8D%E7%BC%96%E8%AF%91%E5%99%A8%E4%B8%AD%EF%BC%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%8C%87%E5%90%91%E5%88%86%E9%85%8D%E7%A9%BA%E9%97%B4%E8%BF%99%E4%B8%A4%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%BC%9A%E8%A2%AB%E9%87%8D%E6%8E%92%EF%BC%8C%E5%AF%BC%E8%87%B4%E5%9C%A8%E6%A3%80%E6%9F%A5%E5%88%B0%E5%AF%B9%E8%B1%A1%E5%B7%B2%E7%BB%8F%E6%8C%87%E5%90%91%E5%88%86%E9%85%8D%E7%A9%BA%E9%97%B4%E6%97%B6%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E8%BF%98%E6%B2%A1%E6%9C%89%E5%AE%8C%E6%88%90%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A%0A%E7%9B%AE%E5%89%8D%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9A%0A-%20%E5%9F%BA%E4%BA%8Evolatile%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9A%E5%B0%86%E5%AF%B9%E8%B1%A1%E5%A3%B0%E6%98%8E%E4%B8%BAvolatile%E5%86%8D%E8%BF%9B%E8%A1%8C%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E9%94%81%E5%AE%9A%EF%BC%8C%E5%8D%B3%E5%8F%AF%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%0A%0A%60%60%60%0Apublic%20class%20Singleton%20%7B%20%0A%20%20%20%20private%20volatile%20static%20Singleton%20uniqueSingleton%3B%20%0A%20%20%20%20private%20Singleton()%20%7B%20%7D%20%0A%20%20%20%20public%20Singleton%20getInstance()%20%7B%20%0A%20%20%20%20%20%20%20%20if%20(null%20%3D%3D%20uniqueSingleton)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20synchronized%20(Singleton.class)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(null%20%3D%3D%20uniqueSingleton)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniqueSingleton%20%3D%20new%20Singleton()%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20%0A%20%20%20%20%20%20%20%20%7D%20%0A%20%20%20%20%20%20%20%20return%20uniqueSingleton%3B%20%0A%20%20%20%20%7D%0A%7D%0A%60%60%60%0A%0A%0A-%20%E5%9F%BA%E4%BA%8E%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%EF%BC%9A%E6%AF%8F%E4%B8%AA%E7%B1%BB%E6%88%96%E8%80%85%E6%8E%A5%E5%8F%A3%E9%83%BD%E6%9C%89%E5%94%AF%E4%B8%80%E7%9A%84%E4%B8%80%E4%B8%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E9%94%81%EF%BC%8C%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%97%B6%E5%B0%9D%E8%AF%95%E5%8E%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB%E6%88%96%E6%8E%A5%E5%8F%A3%EF%BC%8C%E4%BD%86%E6%98%AF%E9%94%81%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%EF%BC%8C%E6%89%80%E4%BB%A5%E5%90%8C%E6%97%B6%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%9C%A8%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%EF%BC%8C%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E9%83%BD%E5%9C%A8%E5%B0%9D%E8%AF%95%E5%B9%B6%E7%AD%89%E5%BE%85%EF%BC%8C%E7%9B%B4%E5%88%B0%E7%B1%BB%E8%A2%AB%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%8B%BF%E5%88%B0%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BB%93%E6%9D%9F%EF%BC%8C%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E7%BB%A7%E7%BB%AD%E8%AF%B7%E6%B1%82%E5%88%9D%E5%A7%8B%E5%8C%96%E9%94%81%EF%BC%8C%E5%8F%91%E7%8E%B0%E7%B1%BB%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E4%BA%86%EF%BC%8C%E4%BA%8E%E6%98%AF%E7%BB%93%E6%9D%9F%E5%90%84%E8%87%AA%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%E3%80%82%0A%23%23%202%20java%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%0A%23%23%23%202.1%20%E7%BA%BF%E7%A8%8B%0A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9C%A8%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F%E6%97%B6%EF%BC%8C%E4%BC%9A%E4%B8%BA%E5%85%B6%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E3%80%82%E5%9C%A8%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E9%87%8C%E5%8F%AF%E4%BB%A5%E5%88%9B%E5%BB%BA%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E8%B0%83%E5%BA%A6%E7%9A%84%E6%9C%80%E5%B0%8F%E5%8D%95%E4%BD%8D%E3%80%82%0A**%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%8A%BF**%0A%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8F%AF%E4%BB%A5%E5%B8%A6%E6%9D%A5%E4%BB%A5%E4%B8%8B%E5%A5%BD%E5%A4%84%EF%BC%9A%0A-%20%E6%9B%B4%E5%A4%9A%E7%9A%84%E5%A4%84%E7%90%86%E5%99%A8%E6%A0%B8%E5%BF%83%0A-%20%E6%9B%B4%E5%BF%AB%E7%9A%84%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%0A-%20%E6%9B%B4%E5%A5%BD%E7%9A%84%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%0A%0A**%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7**%0A%E5%9C%A8Java%E7%BA%BF%E7%A8%8B%E4%B8%AD%EF%BC%8C%E9%80%9A%E8%BF%87%E6%95%B4%E5%9E%8B%E6%88%90%E5%91%98%E5%8F%98%E9%87%8Fpriority%E6%9D%A5%E6%8E%A7%E5%88%B6%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%8C%E8%8C%83%E5%9B%B4%E4%BB%8E1-10%E3%80%82%0A%0A**%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81**%0AJava%20%E7%BA%BF%E7%A8%8B%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%AD%E7%9A%84%E6%8C%87%E5%AE%9A%E6%97%B6%E5%88%BB%E5%8F%AA%E5%8F%AF%E8%83%BD%E5%A4%84%E4%BA%8E%E4%B8%8B%E9%9D%A2%206%20%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%8A%B6%E6%80%81%E7%9A%84%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E7%8A%B6%E6%80%81%E3%80%82%0A!%5B9ee14c106db92f2ea5f687b706d2523a.png%5D(en-resource%3A%2F%2Fdatabase%2F875%3A1)%0Ajava%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81%E5%88%87%E6%8D%A2%E8%BF%87%E7%A8%8B%E5%A6%82%E5%9B%BE%EF%BC%9A%0A!%5B6872a9d633143dae8d840e5c7477035e.png%5D(en-resource%3A%2F%2Fdatabase%2F877%3A1)%0A%0A**Daemon%E7%BA%BF%E7%A8%8B**%0ADaemon%E7%BA%BF%E7%A8%8B%20%E6%98%AF%E4%B8%80%E7%A7%8D%E6%94%AF%E6%8C%81%E5%9E%8B%E7%BA%BF%E7%A8%8B%EF%BC%8C%E6%AD%A4%E5%B1%9E%E6%80%A7%E9%9C%80%E8%A6%81%E5%9C%A8%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%E5%89%8D%E8%AE%BE%E7%BD%AE%EF%BC%8C%E4%B8%BB%E8%A6%81%E8%A2%AB%E7%94%A8%E4%BD%9C%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%90%8E%E5%8F%B0%E8%B0%83%E5%BA%A6%E4%BB%A5%E5%8F%8A%E6%94%AF%E6%8C%81%E6%80%A7%E5%B7%A5%E4%BD%9C%E3%80%82Daemon%E7%BA%BF%E7%A8%8B%E9%9A%8F%E7%9D%80main%E6%96%B9%E6%B3%95%E7%9A%84%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%E8%80%8C%E7%BB%88%E6%AD%A2%E3%80%82%E6%B2%A1%E6%9C%89%E9%9D%9Edaemon%E7%BA%BF%E7%A8%8B%E5%90%8E%EF%BC%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%A6%81%E9%80%80%E5%87%BA%EF%BC%8Cdaemon%E7%BA%BF%E7%A8%8B%E8%A6%81%E7%AB%8B%E5%88%BB%E7%BB%88%E6%AD%A2%EF%BC%8C%E6%89%80%E4%BB%A5daemon%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84finally%E5%9D%97%E4%B8%8D%E4%BC%9A%E8%A2%AB%E6%89%A7%E8%A1%8C%E3%80%82%0A%0A%23%23%23%202.2%20%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E7%BB%88%E6%AD%A2%0A%E7%BA%BF%E7%A8%8B%E5%9C%A8%E6%9E%84%E9%80%A0%E6%97%B6%EF%BC%8C%E8%A6%81%E8%BF%9B%E8%A1%8C%E4%B8%80%E7%B3%BB%E5%88%97%E5%B1%9E%E6%80%A7%E7%9A%84%E8%AE%BE%E7%BD%AE%EF%BC%8C%E6%96%B0%E6%9E%84%E9%80%A0%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%AF%B9%E8%B1%A1%E7%94%B1%E5%85%B6parent%E7%BA%BF%E7%A8%8B%E6%9D%A5%E5%88%86%E9%85%8D%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%B9%B6%E4%B8%94%E7%BB%A7%E6%89%BFParent%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AE%BE%E7%BD%AE%E3%80%82%E8%87%B3%E6%AD%A4%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%9C%A8%E5%A0%86%E4%B8%AD%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%8C%E6%AF%95%EF%BC%8C%E7%AD%89%E5%BE%85%E8%BF%90%E8%A1%8C%E3%80%82%0A%23%23%23%23%202.2.1%20%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%0A%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E4%B9%8B%E5%90%8E%EF%BC%8C%E8%B0%83%E7%94%A8start()%E6%96%B9%E6%B3%95%E5%BC%80%E5%A7%8B%E8%BF%90%E8%A1%8C%E3%80%82%0A**%E8%B0%83%E7%94%A8start%E6%96%B9%E6%B3%95%E5%92%8C%E8%B0%83%E7%94%A8run%E6%96%B9%E6%B3%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB**%EF%BC%9F%0A-%20start()%E7%94%A8%E6%9D%A5%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%BD%93%E8%B0%83%E7%94%A8start()%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E7%B3%BB%E7%BB%9F%E6%89%8D%E4%BC%9A%E5%BC%80%E5%90%AF%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%8C%E9%80%9A%E8%BF%87Thead%E7%B1%BB%E4%B8%ADstart()%E6%96%B9%E6%B3%95%E6%9D%A5%E5%90%AF%E5%8A%A8%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%A4%84%E4%BA%8E%E5%B0%B1%E7%BB%AA%E7%8A%B6%E6%80%81%EF%BC%88%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%EF%BC%89%EF%BC%8C%E6%AD%A4%E6%97%B6%E5%B9%B6%E6%B2%A1%E6%9C%89%E8%BF%90%E8%A1%8C%EF%BC%8C%E4%B8%80%E6%97%A6%E5%BE%97%E5%88%B0CPU%E6%97%B6%E9%97%B4%E7%89%87%EF%BC%8C%E5%B0%B1%E8%87%AA%E5%8A%A8%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8Crun()%E6%96%B9%E6%B3%95%E3%80%82%E6%AD%A4%E6%97%B6%E4%B8%8D%E9%9C%80%E8%A6%81%E7%AD%89%E5%BE%85run()%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E5%AE%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E4%B9%9F%E7%94%B1%E6%AD%A4%E7%9C%8B%E5%87%BArun()%E6%96%B9%E6%B3%95%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E3%80%82%0A-%20run()%E6%96%B9%E6%B3%95%E6%98%AF%E5%9C%A8%E6%9C%AC%E7%BA%BF%E7%A8%8B%E9%87%8C%E7%9A%84%EF%BC%8C%E5%8F%AA%E6%98%AF%E7%BA%BF%E7%A8%8B%E9%87%8C%E7%9A%84%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%2C%E8%80%8C%E4%B8%8D%E6%98%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E3%80%82%E5%A6%82%E6%9E%9C%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8run()%2C%E5%85%B6%E5%AE%9E%E5%B0%B1%E7%9B%B8%E5%BD%93%E4%BA%8E%E6%98%AF%E8%B0%83%E7%94%A8%E4%BA%86%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0%E8%80%8C%E5%B7%B2%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%BE%85%E7%94%A8run()%E6%96%B9%E6%B3%95%E5%BF%85%E9%A1%BB%E7%AD%89%E5%BE%85run()%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%E6%89%8D%E8%83%BD%E6%89%A7%E8%A1%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E6%89%80%E4%BB%A5%E6%89%A7%E8%A1%8C%E8%B7%AF%E5%BE%84%E8%BF%98%E6%98%AF%E5%8F%AA%E6%9C%89%E4%B8%80%E6%9D%A1%EF%BC%8C%E6%A0%B9%E6%9C%AC%E5%B0%B1%E6%B2%A1%E6%9C%89%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%89%B9%E5%BE%81%EF%BC%8C%E6%89%80%E4%BB%A5%E5%9C%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%97%B6%E8%A6%81%E4%BD%BF%E7%94%A8start()%E6%96%B9%E6%B3%95%E8%80%8C%E4%B8%8D%E6%98%AFrun()%E6%96%B9%E6%B3%95%E3%80%82%0A%0A%23%23%23%23%202.2.2%20%E4%B8%AD%E6%96%AD%E7%BA%BF%E7%A8%8B%0A%E4%B8%AD%E6%96%AD%E6%98%AF%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E6%A0%87%E8%AF%86%E4%BD%8D%E5%B1%9E%E6%80%A7%EF%BC%8C%E7%94%A8%E6%9D%A5%E6%A0%87%E8%AF%86%E4%B8%80%E4%B8%AA%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%98%AF%E5%90%A6%E8%A2%AB%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%96%AD%E8%BF%87%E3%80%82%0A%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%BF%87%E8%B0%83%E7%94%A8%E8%AF%A5%E7%BA%BF%E7%A8%8B%E7%9A%84interrupt()%E6%96%B9%E6%B3%95%E6%9D%A5%E5%AF%B9%E5%85%B6%E8%BF%9B%E8%A1%8C%E4%B8%AD%E6%96%AD%E3%80%82%E8%AF%A5%E7%BA%BF%E7%A8%8B%E5%88%99%E9%80%9A%E8%BF%87isinterrupted()%E6%96%B9%E6%B3%95%E6%9D%A5%E5%88%A4%E6%96%AD%E8%87%AA%E5%B7%B1%E6%98%AF%E5%90%A6%E8%A2%AB%E4%B8%AD%E6%96%AD%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8Thread.interrupted()%E6%9D%A5%E5%AF%B9%E6%A0%87%E8%AF%86%E4%BD%8D%E8%BF%9B%E8%A1%8C%E5%A4%8D%E4%BD%8D%E3%80%82%E5%9C%A8%E5%88%A4%E6%96%AD%E8%87%AA%E5%B7%B1%E6%98%AF%E5%90%A6%E8%A2%AB%E4%B8%AD%E6%96%AD%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E8%87%AA%E8%BA%AB%E5%B7%B2%E7%BB%8F%E5%A4%84%E4%BA%8E%E7%BB%88%E7%BB%93%E7%8A%B6%E6%80%81%EF%BC%8C%E4%B9%9F%E4%BC%9A%E8%BF%94%E5%9B%9Efalse%E3%80%82%0A%E7%BA%BF%E7%A8%8B%E5%9C%A8%E6%89%A7%E8%A1%8Csleep()%2Cjoin()%2Cwait()%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E9%81%87%E5%88%B0interrupt()%E6%96%B9%E6%B3%95%EF%BC%8C%E4%BC%9A%E6%8A%9B%E5%87%BAInterruptedException%E5%BC%82%E5%B8%B8%EF%BC%8C%E5%90%8C%E6%97%B6%E5%B0%86%E4%B8%AD%E6%96%AD%E6%A0%87%E8%AF%86%E4%BD%8D%E8%AE%BE%E7%BD%AE%E4%B8%BAtrue%E3%80%82%0A%23%23%23%23%202.2.3%20%E7%BB%88%E6%AD%A2%E7%BA%BF%E7%A8%8B%0A%E4%B8%AD%E6%96%AD%E6%93%8D%E4%BD%9C%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BE%BF%E6%8D%B7%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%97%B4%E4%BA%A4%E4%BA%92%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%AD%E6%96%AD%E5%92%8C%E4%B8%80%E4%B8%AAboolean%E5%8F%98%E9%87%8F%E5%8F%AF%E4%BB%A5%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E5%AF%B9%E7%BA%BF%E7%A8%8B%E8%BF%9B%E8%A1%8C%E4%B8%AD%E6%96%AD%E6%88%96%E7%BB%88%E6%AD%A2%E3%80%82%0A%0A%23%23%23%202.3%20%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1%0A%23%23%23%23%202.3.1%20volatile%20%E5%92%8C%20synchronized%E5%85%B3%E9%94%AE%E8%AF%8D%0Avolatile%E7%94%A8%E6%9D%A5%E4%BF%AE%E9%A5%B0%E5%AD%97%E6%AE%B5%EF%BC%88%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%EF%BC%89%EF%BC%8C%E5%91%8A%E8%AF%89%E7%A8%8B%E5%BA%8F%E4%BB%BB%E4%BD%95%E5%AF%B9%E4%BA%8E%E8%AF%A5%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BF%E9%97%AE%E9%83%BD%E8%A6%81%E5%8E%BB%E5%86%85%E5%AD%98%E4%B8%AD%E8%8E%B7%E5%8F%96%EF%BC%8C%E5%AF%B9%E4%BA%8E%E8%AF%A5%E5%8F%98%E9%87%8F%E7%9A%84%E6%9B%B4%E6%96%B0%E8%A6%81%E5%88%B7%E6%96%B0%E5%9B%9E%E5%86%85%E5%AD%98%EF%BC%8C%E5%AE%83%E4%BF%9D%E8%AF%81%E4%BA%86%E7%BA%BF%E7%A8%8B%E5%AF%B9%E4%BA%8E%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%E7%9A%84%E5%8F%AF%E8%A7%81%E6%80%A7%E3%80%82%0Asynchronized%E7%94%A8%E6%9D%A5%E4%BF%AE%E9%A5%B0%E6%96%B9%E6%B3%95%E3%80%81%E5%90%8C%E6%AD%A5%E5%9D%97%EF%BC%8C%E7%A1%AE%E4%BF%9D%E5%90%8C%E4%B8%80%E4%B8%AA%E6%97%B6%E5%88%BB%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%A4%84%E4%BA%8E%E6%96%B9%E6%B3%95%E6%88%96%E5%90%8C%E6%AD%A5%E5%9D%97%E4%B8%AD%EF%BC%8C%E4%BF%9D%E8%AF%81%E4%BA%86%E7%BA%BF%E7%A8%8B%E5%AF%B9%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%E7%9A%84%E5%8F%AF%E8%A7%81%E6%80%A7%E5%92%8C%E6%8E%92%E4%BB%96%E6%80%A7%E3%80%82%0A%23%23%23%23%202.3.2%20%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%88%B6%0A%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%88%B6%EF%BC%8C%E6%98%AF%E6%8C%87%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8BA%E8%B0%83%E7%94%A8%E4%BA%86%E5%AF%B9%E8%B1%A1O%E7%9A%84wait()%E6%96%B9%E6%B3%95%E8%BF%9B%E5%85%A5%E7%AD%89%E5%BE%85%E7%8A%B6%E6%80%81%EF%BC%8C%E8%80%8C%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8BB%E8%B0%83%E7%94%A8%E4%BA%86%E5%AF%B9%E8%B1%A1O%E7%9A%84wait()notify()%2FnotifyAll()%E6%96%B9%E6%B3%95%EF%BC%8C%E7%BA%BF%E7%A8%8BA%E6%94%B6%E5%88%B0%E9%80%9A%E7%9F%A5%E5%90%8E%E9%80%80%E5%87%BAwait()%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%EF%BC%8C%E8%BF%9B%E8%80%8C%E6%89%A7%E8%A1%8C%E5%90%8E%E7%BB%AD%E6%93%8D%E4%BD%9C%E3%80%82%E4%B8%8A%E8%AF%89%E4%B8%A4%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%BF%87%E5%AF%B9%E8%B1%A1O%E6%9D%A5%E5%AE%8C%E6%88%90%E4%BA%A4%E4%BA%92%EF%BC%8C%E8%80%8C%E5%AF%B9%E8%B1%A1%E4%B8%8A%E7%9A%84wait()%E6%96%B9%E6%B3%95%E5%92%8Cnotify()%2FnotifyAll()%E6%96%B9%E6%B3%95%E7%9A%84%E5%85%B3%E7%B3%BB%E5%B0%B1%E5%A6%82%E5%90%8C%E5%BC%80%E5%85%B3%E4%BF%A1%E5%8F%B7%E4%B8%80%E6%A0%B7%EF%BC%8C%E7%94%A8%E6%9D%A5%E5%AE%8C%E6%88%90%E7%AD%89%E5%BE%85%E6%96%B9%E5%92%8C%E9%80%9A%E7%9F%A5%E6%96%B9%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BA%A4%E4%BA%92%E5%B7%A5%E4%BD%9C%E3%80%82%0A!%5B83f8877b7f3673912b03ade118583981.png%5D(en-resource%3A%2F%2Fdatabase%2F879%3A1)%0A%0A%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%88%B6%E7%BB%8F%E5%85%B8%E8%8C%83%E5%BC%8F---%E6%B6%88%E8%B4%B9%E8%80%85%E5%92%8C%E7%94%9F%E4%BA%A7%E8%80%85%EF%BC%9A%0A-%20%E5%AF%B9%E4%BA%8E%E6%B6%88%E8%B4%B9%E8%80%85%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%94%81%EF%BC%9B%E5%A6%82%E6%9E%9C%E6%9D%A1%E4%BB%B6%E4%B8%8D%E6%BB%A1%E8%B6%B3%EF%BC%8C%E5%88%99%E8%B0%83%E7%94%A8%E5%AF%B9%E8%B1%A1%E7%9A%84wait()%E6%96%B9%E6%B3%95%EF%BC%8C%E8%A2%AB%E9%80%9A%E7%9F%A5%E5%90%8E%E4%BB%8D%E8%A6%81%E5%86%8D%E6%AC%A1%E6%A3%80%E6%9F%A5%E6%9D%A1%E4%BB%B6%EF%BC%9B%E6%9D%A1%E4%BB%B6%E6%BB%A1%E8%B6%B3%E5%88%99%E6%89%A7%E8%A1%8C%E5%AF%B9%E5%BA%94%E6%93%8D%E4%BD%9C%0A-%20%E5%AF%B9%E4%BA%8E%E7%94%9F%E4%BA%A7%E8%80%85%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%94%81%EF%BC%9B%E6%94%B9%E5%8F%98%E6%9D%A1%E4%BB%B6%EF%BC%9B%E9%80%9A%E7%9F%A5%E6%89%80%E6%9C%89%E7%AD%89%E5%BE%85%E5%9C%A8%E5%AF%B9%E8%B1%A1%E4%B8%8A%E7%9A%84%E7%BA%BF%E7%A8%8B%E3%80%82%0A%23%23%23%23%202.3.3%20join()%E6%96%B9%E6%B3%95%0A%E7%BA%BF%E7%A8%8BA%E5%A6%82%E6%9E%9C%E8%B0%83%E7%94%A8thread.join()%E6%96%B9%E6%B3%95%EF%BC%8C%E5%88%99%E4%BC%9A%E7%AD%89%E5%BE%85thread%E7%BA%BF%E7%A8%8B%E7%BB%88%E6%AD%A2%E5%90%8E%E6%89%8D%E4%BB%8Ethread.join()%E8%BF%94%E5%9B%9E%E3%80%82%0A%23%23%23%23%202.3.4%20ThreadLocal%0A%E9%80%9A%E5%B8%B8%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E7%9A%84%E5%8F%98%E9%87%8F%E6%98%AF%E5%8F%AF%E4%BB%A5%E8%A2%AB%E4%BB%BB%E4%BD%95%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%B9%B6%E4%BF%AE%E6%94%B9%E7%9A%84%E3%80%82%E5%A6%82%E6%9E%9C%E6%83%B3%E5%AE%9E%E7%8E%B0%E6%AF%8F%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%83%BD%E6%9C%89%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%93%E5%B1%9E%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8F%E8%AF%A5%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%91%A2%EF%BC%9F%C2%A0JDK%E4%B8%AD%E6%8F%90%E4%BE%9B%E7%9A%84ThreadLocal%E7%B1%BB%E6%AD%A3%E6%98%AF%E4%B8%BA%E4%BA%86%E8%A7%A3%E5%86%B3%E8%BF%99%E6%A0%B7%E7%9A%84%E9%97%AE%E9%A2%98%E3%80%82%C2%A0ThreadLocal%E7%B1%BB%E4%B8%BB%E8%A6%81%E8%A7%A3%E5%86%B3%E7%9A%84%E5%B0%B1%E6%98%AF%E8%AE%A9%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E7%BB%91%E5%AE%9A%E8%87%AA%E5%B7%B1%E7%9A%84%E5%80%BC%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%B0%86ThreadLocal%E7%B1%BB%E5%BD%A2%E8%B1%A1%E7%9A%84%E6%AF%94%E5%96%BB%E6%88%90%E5%AD%98%E6%94%BE%E6%95%B0%E6%8D%AE%E7%9A%84%E7%9B%92%E5%AD%90%EF%BC%8C%E7%9B%92%E5%AD%90%E4%B8%AD%E5%8F%AF%E4%BB%A5%E5%AD%98%E5%82%A8%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E3%80%82%E5%A6%82%E6%9E%9C%E4%BD%A0%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AAThreadLocal%E5%8F%98%E9%87%8F%EF%BC%8C%E9%82%A3%E4%B9%88%E8%AE%BF%E9%97%AE%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%E7%9A%84%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%83%BD%E4%BC%9A%E6%9C%89%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%89%AF%E6%9C%AC%EF%BC%8C%E8%BF%99%E4%B9%9F%E6%98%AFThreadLocal%E5%8F%98%E9%87%8F%E5%90%8D%E7%9A%84%E7%94%B1%E6%9D%A5%E3%80%82%E4%BB%96%E4%BB%AC%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%C2%A0get%EF%BC%88%EF%BC%89%C2%A0%E5%92%8C%C2%A0set%EF%BC%88%EF%BC%89%C2%A0%E6%96%B9%E6%B3%95%E6%9D%A5%E8%8E%B7%E5%8F%96%E9%BB%98%E8%AE%A4%E5%80%BC%E6%88%96%E5%B0%86%E5%85%B6%E5%80%BC%E6%9B%B4%E6%94%B9%E4%B8%BA%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E6%89%80%E5%AD%98%E7%9A%84%E5%89%AF%E6%9C%AC%E7%9A%84%E5%80%BC%EF%BC%8C%E4%BB%8E%E8%80%8C%E9%81%BF%E5%85%8D%E4%BA%86%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%E3%80%82%0A%20%0A%23%23%203%20%E9%94%81%0A%E9%94%81%E6%98%AF%E7%94%A8%E6%9D%A5%E6%8E%A7%E5%88%B6%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%85%B1%E4%BA%AB%E8%B5%84%E6%BA%90%E7%9A%84%E6%96%B9%E5%BC%8F%E3%80%82%E5%9C%A8lock%E6%8E%A5%E5%8F%A3%E5%87%BA%E7%8E%B0%E4%B9%8B%E5%89%8D%EF%BC%8Cjava%E7%A8%8B%E5%BA%8F%E6%98%AF%E9%9D%A0%E7%9D%80synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E6%9D%A5%E9%9A%90%E5%BC%8F%E5%9C%B0%E5%AE%9E%E7%8E%B0%E9%94%81%E7%9A%84%E3%80%82synchronized%E5%8F%AF%E4%BB%A5%E9%9A%90%E5%BC%8F%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E9%94%81%EF%BC%8C%E4%BD%86%E6%98%AF%E5%B0%86%E9%94%81%E7%9A%84%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E5%9B%BA%E5%8C%96%E4%BA%86%EF%BC%9Block%E6%8E%A5%E5%8F%A3%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%8Esychronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%B1%BB%E4%BC%BC%E7%9A%84%E5%90%8C%E6%AD%A5%E5%8A%9F%E8%83%BD%EF%BC%8C%E5%AE%83%E9%9C%80%E8%A6%81%E6%98%BE%E5%BC%8F%E5%9C%B0%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E9%94%81%EF%BC%8C%E8%99%BD%E7%84%B6%E5%B0%91%E4%BA%86%E4%BE%BF%E6%8D%B7%EF%BC%8C%E4%BD%86%E6%98%AF%E8%8E%B7%E5%BE%97%E4%BA%86%E9%94%81%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E5%9C%B0%E5%8F%AF%E6%93%8D%E4%BD%9C%E6%80%A7%E3%80%81%E5%8F%AF%E4%B8%AD%E6%96%AD%E8%8E%B7%E5%8F%96%E9%94%81%E4%BB%A5%E5%8F%8A%E8%B6%85%E6%97%B6%E8%8E%B7%E5%8F%96%E9%94%81%E7%AD%89%E5%90%8C%E6%AD%A5%E7%89%B9%E6%80%A7%E3%80%82%0ALock%E6%98%AF%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%8F%90%E4%BE%9B%E4%BA%86%E9%94%81%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E7%9A%84API%E3%80%82%E5%AE%83%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%98%AF%E9%80%9A%E8%BF%87%E8%81%9A%E5%90%88%E4%B8%80%E4%B8%AA%E5%90%8C%E6%AD%A5%E5%99%A8%E7%9A%84%E5%AD%90%E7%B1%BB%E6%9D%A5%E5%AE%8C%E6%88%90%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%9A%84%E3%80%82%0A%23%23%23%203.1%20AQS%20%E9%98%9F%E5%88%97%E5%90%8C%E6%AD%A5%E5%99%A8%0AAbstractQueueSynchronizer%E6%98%AF%E7%94%A8%E6%9D%A5%E6%9E%84%E5%BB%BA%E9%94%81%E6%88%96%E8%80%85%E8%AE%BF%E9%97%AE%E5%85%B6%E4%BB%96%E5%90%8C%E6%AD%A5%E7%BB%84%E4%BB%B6%E7%9A%84%E5%9F%BA%E7%A1%80%E6%A1%86%E6%9E%B6%EF%BC%8C%E5%AE%83%E4%BD%BF%E7%94%A8%E4%BA%86%E4%B8%80%E4%B8%AA**Int%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F**%E8%A1%A8%E7%A4%BA**%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81**%EF%BC%8C%E9%80%9A%E8%BF%87%E5%86%85%E7%BD%AE%E7%9A%84**FIFO%E9%98%9F%E5%88%97**%E6%9D%A5%E5%AE%8C%E6%88%90%E8%B5%84%E6%BA%90%E8%8E%B7%E5%8F%96%E7%BA%BF%E7%A8%8B%E7%9A%84**%E6%8E%92%E9%98%9F**%E5%B7%A5%E4%BD%9C%E3%80%82%E8%BF%99%E4%B8%AA%E7%B1%BB%E5%9C%A8java.util.concurrent.locks%E5%8C%85%E4%B8%8B%E9%9D%A2%E3%80%82%0A%E5%90%8C%E6%AD%A5%E5%99%A8%E7%9A%84%E4%B8%BB%E8%A6%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E6%98%AF**%E7%BB%A7%E6%89%BF**%EF%BC%8C%E5%AD%90%E7%B1%BB%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E5%90%8C%E6%AD%A5%E5%99%A8%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%85%B6%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95%E6%9D%A5%E7%AE%A1%E7%90%86%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%90%8C%E6%AD%A5%E5%99%A8%E6%8F%90%E4%BE%9B%E7%9A%84getState()%2CsetState()%E5%92%8CcompareAndSetState()%E6%96%B9%E6%B3%95%EF%BC%88%E8%BF%99%E4%BA%9B%E6%96%B9%E6%B3%95%E9%83%BD%E6%98%AFprotected%E7%9A%84%EF%BC%89%E6%9D%A5%E6%94%B9%E5%8F%98%E7%8A%B6%E6%80%81%E3%80%82%0A%E5%90%8C%E6%AD%A5%E5%99%A8%E6%98%AF%E5%AE%9E%E7%8E%B0%E9%94%81%E7%9A%84%E5%85%B3%E9%94%AE%E3%80%82%E9%94%81%E6%98%AF%E9%9D%A2%E5%90%91%E7%94%A8%E6%88%B7%E7%9A%84%EF%BC%8C%E5%AE%9A%E4%B9%89%E4%BA%86%E4%BD%BF%E7%94%A8%E8%80%85%E4%B8%8E%E9%94%81%E4%BA%A4%E4%BA%92%E7%9A%84%E6%8E%A5%E5%8F%A3%EF%BC%9B%E5%90%8C%E6%AD%A5%E5%99%A8%E6%98%AF%E9%9D%A2%E5%90%91%E9%94%81%E7%9A%84%EF%BC%8C%E7%AE%80%E5%8C%96%E4%BA%86%E9%94%81%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E3%80%82%0A%E5%90%8C%E6%AD%A5%E5%99%A8%E6%8F%90%E4%BE%9B%E7%9A%84%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E5%9F%BA%E6%9C%AC%E4%B8%8A%E5%88%86%E4%B8%BA3%E7%B1%BB%EF%BC%9A%0A-%20%E7%8B%AC%E5%8D%A0%E5%BC%8F%E8%8E%B7%E5%8F%96%E4%B8%8E%E9%87%8A%E6%94%BE%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%0A-%20%E5%85%B1%E4%BA%AB%E5%BC%8F%E8%8E%B7%E5%8F%96%E4%B8%8E%E9%87%8A%E6%94%BE%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%0A-%20%E6%9F%A5%E8%AF%A2%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E4%B8%AD%E7%9A%84%E7%AD%89%E5%BE%85%E7%BA%BF%E7%A8%8B%E6%83%85%E5%86%B5%0A%0A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%8C%E6%AD%A5%E7%BB%84%E4%BB%B6%E9%80%9A%E8%BF%87%E4%BD%BF%E7%94%A8%E8%BF%99%E4%BA%9B%E6%A8%A1%E6%9D%BF%E6%9D%A5%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%90%8C%E6%AD%A5%E8%AF%AD%E4%B9%89%E3%80%82%0A%23%23%23%23%203.1.1%20AQS%E5%AE%9E%E7%8E%B0%0A**1.%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97**%0A%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E6%98%AF%E4%B8%80%E4%B8%AAFIFO%E5%8F%8C%E5%90%91%E9%98%9F%E5%88%97%EF%BC%8C%E7%94%A8%E6%9D%A5%E7%AE%A1%E7%90%86%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E3%80%82%0A%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E5%A4%B1%E8%B4%A5%E6%97%B6%EF%BC%8C%E5%90%8C%E6%AD%A5%E5%99%A8%E5%B0%86%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E4%BB%A5%E5%8F%8A%E7%AD%89%E5%BE%85%E7%8A%B6%E6%80%81%E4%BF%A1%E6%81%AF%E6%9E%84%E9%80%A0%E6%88%90%E4%B8%BA%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9%EF%BC%8C%E5%B0%86%E5%85%B6%E5%8A%A0%E5%85%A5%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%EF%BC%8C%E5%90%8C%E6%97%B6%E9%98%BB%E5%A1%9E%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%EF%BC%9B%E5%BD%93%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E9%87%8A%E6%94%BE%E6%97%B6%EF%BC%8C%E4%BC%9A%E6%8A%8A%E9%98%9F%E5%88%97%E9%A6%96%E8%8A%82%E7%82%B9%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%94%A4%E9%86%92%EF%BC%8C%E8%AE%A9%E5%85%B6%E5%86%8D%E6%AC%A1%E5%B0%9D%E8%AF%95%E8%8E%B7%E5%8F%96%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E3%80%82%0A!%5B6bf1fd48e684696946db0a5c65401c93.png%5D(en-resource%3A%2F%2Fdatabase%2F881%3A1)%0A%E9%98%9F%E5%88%97%E9%81%B5%E5%BE%AAFIFO%EF%BC%8C%E9%A6%96%E8%8A%82%E7%82%B9%E5%8D%B3%E4%B8%BA%E8%8E%B7%E5%8F%96%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E6%88%90%E5%8A%9F%E7%9A%84%E8%8A%82%E7%82%B9%EF%BC%8C%E5%BD%93%E9%A6%96%E8%8A%82%E7%82%B9%E9%87%8A%E6%94%BE%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E6%97%B6%EF%BC%8C%E4%BC%9A%E5%94%A4%E9%86%92%E5%90%8E%E7%BB%A7%E8%8A%82%E7%82%B9%EF%BC%9B%E5%90%8E%E7%BB%A7%E8%8A%82%E7%82%B9%E8%A2%AB%E5%94%A4%E9%86%92%E5%90%8E%EF%BC%8C%E5%85%88%E5%88%A4%E6%96%AD%E8%87%AA%E5%B7%B1%E7%9A%84%E5%85%88%E9%A9%B1%E8%8A%82%E7%82%B9%E6%98%AF%E4%B8%8D%E6%98%AF%E9%A6%96%E8%8A%82%E7%82%B9%EF%BC%8C%E6%98%AF%E7%9A%84%E8%AF%9D%E5%8E%BB%E8%8E%B7%E5%8F%96%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%EF%BC%8C%E5%9C%A8%E8%8E%B7%E5%8F%96%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E6%88%90%E5%8A%9F%E7%9A%84%E5%90%8C%E6%97%B6%E5%B0%86%E8%87%AA%E5%B7%B1%E8%AE%BE%E7%BD%AE%E4%B8%BA%E9%A6%96%E8%8A%82%E7%82%B9%E3%80%82%0A%0A**2.%E7%8B%AC%E5%8D%A0%E5%BC%8F%E5%92%8C%E5%85%B1%E4%BA%AB%E5%BC%8F%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E7%9A%84%E8%8E%B7%E5%8F%96%E4%B8%8E%E9%87%8A%E6%94%BE**%0A%E7%8B%AC%E5%8D%A0%E5%BC%8F%E5%92%8C%E5%85%B1%E4%BA%AB%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E5%9C%A8%E4%BA%8E%E5%90%8C%E4%B8%80%E6%97%B6%E5%88%BB%E8%83%BD%E5%90%A6%E6%9C%89%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%97%B6%E8%8E%B7%E5%8F%96%E5%88%B0%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E3%80%82%0A%0A%0A%23%23%23%203.2%20ReentrantLock%20%E9%87%8D%E5%85%A5%E9%94%81%0AReentrantLock%20%E9%87%8D%E5%85%A5%E9%94%81%EF%BC%8C%E6%84%8F%E5%91%B3%E7%9D%80%E8%AF%A5%E9%94%81%E6%94%AF%E6%8C%81%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%AF%B9%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E9%87%8D%E5%A4%8D%E5%8A%A0%E9%94%81%E3%80%82%0A%0A**Mutex%E4%B8%8EReentrantLock%EF%BC%9A**%0A%E5%9C%A8%E4%BD%BF%E7%94%A8Mutex%E9%94%81%E6%97%B6%EF%BC%8C%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E4%BD%BF%E7%94%A8lock()%E6%96%B9%E6%B3%95%E8%8E%B7%E5%BE%97%E9%94%81%E5%90%8E%EF%BC%8C%E5%86%8D%E6%AC%A1%E8%B0%83%E7%94%A8Lock()%E6%96%B9%E6%B3%95%E5%B0%B1%E4%BC%9A%E8%A2%AB%E8%87%AA%E5%B7%B1%E9%98%BB%E5%A1%9E%EF%BC%9B%E8%80%8CReentrantLock%E5%86%8D%E6%AC%A1%E8%B0%83%E7%94%A8lock()%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E4%B8%8D%E4%BC%9A%E8%A2%AB%E8%87%AA%E5%B7%B1%E9%98%BB%E5%A1%9E%E3%80%82%0A%0A**%E9%87%8D%E5%85%A5%E9%94%81%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%9A**%0A%EF%BC%881%EF%BC%89%E7%BA%BF%E7%A8%8B%E5%86%8D%E6%AC%A1%E8%8E%B7%E5%8F%96%E9%94%81%EF%BC%9A%E7%BA%BF%E7%A8%8B%E5%86%8D%E6%AC%A1%E8%8E%B7%E5%8F%96%E9%94%81%E6%97%B6%EF%BC%8C%E9%94%81%E9%9C%80%E8%A6%81%E5%8E%BB%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%94%B3%E8%AF%B7%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%8D%E6%98%AF%E5%8D%A0%E6%8D%AE%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%98%AF%EF%BC%8C%E5%88%99%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E5%86%8D%E6%AC%A1%E8%8E%B7%E5%8F%96%E9%94%81%E6%88%90%E5%8A%9F%E3%80%82%0A%EF%BC%882%EF%BC%89%E9%94%81%E7%9A%84%E9%87%8A%E6%94%BE%EF%BC%9A%E9%94%81%E5%AF%B9%E4%BA%8E%E8%87%AA%E8%BA%AB%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E6%AC%A1%E6%95%B0%E9%9C%80%E8%A6%81%E7%94%A8%E8%AE%A1%E6%95%B0%E5%99%A8%E8%AE%B0%E5%BD%95%EF%BC%8C%E7%BA%BF%E7%A8%8B%E9%87%8D%E5%A4%8D%E8%8E%B7%E5%BE%97n%E6%AC%A1%E9%94%81%EF%BC%8C%E5%88%99%E9%80%92%E5%A2%9En%E6%AC%A1%EF%BC%8C%E9%87%8A%E6%94%BE%E6%97%B6%E5%88%99%E9%80%92%E5%87%8F%E3%80%82%E5%BD%93%E8%AE%A1%E6%95%B0%E5%99%A8%E4%B8%BA0%20%E6%97%B6%EF%BC%8C%E8%A1%A8%E7%A4%BA%E9%94%81%E5%B7%B2%E7%BB%8F%E6%88%90%E5%8A%9F%E9%87%8A%E6%94%BE%E3%80%82%0A%0A**%E5%85%AC%E5%B9%B3%E9%94%81%E4%B8%8E%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%EF%BC%9A**%0A%EF%BC%881%EF%BC%89%E5%85%AC%E5%B9%B3%E9%94%81%E9%81%B5%E5%BE%AAFIFO%E5%8E%9F%E5%88%99%EF%BC%8C%E5%85%88%E5%AF%B9%E9%94%81%E8%BF%9B%E8%A1%8C%E8%8E%B7%E5%8F%96%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%B8%80%E5%AE%9A%E6%9C%80%E4%BC%98%E5%85%88%E8%8E%B7%E5%8F%96%E9%94%81%E3%80%82%E5%85%AC%E5%B9%B3%E9%94%81%E4%BF%9D%E8%AF%81%E4%BA%86FIFO%E5%8E%9F%E5%88%99%EF%BC%8C%E4%BD%86%E6%98%AF%E9%80%A0%E6%88%90%E4%BA%86%E4%BB%A3%E4%BB%B7%E9%9D%9E%E5%B8%B8%E5%A4%A7%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2%E3%80%82%0A%EF%BC%882%EF%BC%89%E5%AF%B9%E4%BA%8E%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%EF%BC%8C%E5%8F%AA%E8%A6%81CAS%E8%AE%BE%E7%BD%AE%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%E6%88%90%E5%8A%9F%EF%BC%8C%E5%B0%B1%E8%A1%A8%E7%A4%BA%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%E4%BA%86%E9%94%81%E3%80%82%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%E8%99%BD%E7%84%B6%E4%BC%9A%E5%AF%BC%E8%87%B4%E9%A5%A5%E9%A5%BF%EF%BC%8C%E4%BD%86%E6%98%AF%E4%BB%A5%E5%85%B6%E6%9E%81%E5%B0%91%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2%E5%B8%A6%E6%9D%A5%E4%BA%86%E6%9B%B4%E5%A4%A7%E7%9A%84%E5%90%9E%E5%90%90%E9%87%8F%E3%80%82%0A%0A**ReentrantLock%E4%B8%8Esynchronized%E7%9A%84%E5%BC%82%E5%90%8C%EF%BC%9A**%0A%E5%90%8C%EF%BC%9A%0A-%20%EF%BC%881%EF%BC%89%E4%B8%A4%E8%80%85%E9%83%BD%E6%98%AF%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81%0A%0A%E5%BC%82%EF%BC%9A%0A-%20%EF%BC%881%EF%BC%89ReentrantLock%E6%98%AFAPI%E5%AE%9E%E7%8E%B0%E7%9A%84%EF%BC%8C%E8%80%8Csynchronized%E6%98%AFJVM%E5%AE%9E%E7%8E%B0%E7%9A%84%E3%80%82%0A-%20%EF%BC%882%EF%BC%89ReentrantLock%E6%AF%94synchronized%E5%A4%9A%E5%AE%9E%E7%8E%B0%E4%BA%86%E4%B8%80%E4%BA%9B%E5%8A%9F%E8%83%BD%EF%BC%9A%0A%20%20%20%20%20%20%20%20%E2%91%A0%E7%AD%89%E5%BE%85%E5%8F%AF%E4%B8%AD%E6%96%AD%EF%BC%9B%0A%20%20%20%20%20%20%20%20%E2%91%A1%E5%8F%AF%E5%AE%9E%E7%8E%B0%E5%85%AC%E5%B9%B3%E9%94%81%EF%BC%9Bsynchronized%E5%8F%AA%E8%83%BD%E6%98%AF%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%EF%BC%9B%0A%20%20%20%20%20%20%20%20%E2%91%A2%E5%8F%AF%E5%AE%9E%E7%8E%B0%E9%80%89%E6%8B%A9%E6%80%A7%E9%80%9A%E7%9F%A5%EF%BC%88%E9%94%81%E5%8F%AF%E4%BB%A5%E7%BB%91%E5%AE%9A%E5%A4%9A%E4%B8%AA%E6%9D%A1%E4%BB%B6%EF%BC%89%EF%BC%9A%E7%BA%BF%E7%A8%8B%E5%AF%B9%E8%B1%A1%E5%8F%AF%E4%BB%A5%E6%B3%A8%E5%86%8C%E5%9C%A8%E6%8C%87%E5%AE%9A%E7%9A%84Condition%E4%B8%AD%EF%BC%8C%E4%BB%8E%E8%80%8C%E5%8F%AF%E4%BB%A5%E6%9C%89%E9%80%89%E6%8B%A9%E6%80%A7%E7%9A%84%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E9%80%9A%E7%9F%A5%EF%BC%8C%E5%9C%A8%E8%B0%83%E5%BA%A6%E7%BA%BF%E7%A8%8B%E4%B8%8A%E6%9B%B4%E5%8A%A0%E7%81%B5%E6%B4%BB%E3%80%82%20%E5%9C%A8%E4%BD%BF%E7%94%A8notify()%2FnotifyAll()%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E9%80%9A%E7%9F%A5%E6%97%B6%EF%BC%8C%E8%A2%AB%E9%80%9A%E7%9F%A5%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%98%AF%E7%94%B1%20JVM%20%E9%80%89%E6%8B%A9%E7%9A%84%EF%BC%8C%E7%94%A8ReentrantLock%E7%B1%BB%E7%BB%93%E5%90%88Condition%E5%AE%9E%E4%BE%8B%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E2%80%9C%E9%80%89%E6%8B%A9%E6%80%A7%E9%80%9A%E7%9F%A5%0A-%20ReetrantLock%E9%9C%80%E8%A6%81%E6%98%BE%E5%BC%8F%E5%9C%B0%E9%87%8A%E6%94%BE%E9%94%81%EF%BC%8C%E8%80%8Csynchronized%E9%9A%90%E5%BC%8F%E8%8E%B7%E5%8F%96%E5%92%8C%E9%87%8A%E6%94%BE%E9%94%81%E3%80%82%0A%0A%23%23%23%203.3%20ReentrantReadWriteLock%20%E8%AF%BB%E5%86%99%E9%94%81%0A%E4%B9%8B%E5%89%8D%E7%9A%84%E9%94%81%E9%83%BD%E6%98%AF%E6%8E%92%E4%BB%96%E9%94%81%EF%BC%8C%E8%80%8C%E8%AF%BB%E5%86%99%E9%94%81%E5%9C%A8%E5%90%8C%E4%B8%80%E6%97%B6%E5%88%BB%E5%8F%AF%E4%BB%A5%E5%85%81%E8%AE%B8%E5%A4%9A%E4%B8%AA%E8%AF%BB%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%EF%BC%8C%E4%BD%86%E6%98%AF%E5%BD%93%E5%86%99%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%97%B6%EF%BC%8C%E6%89%80%E6%9C%89%E7%9A%84%E8%AF%BB%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%85%B6%E4%BB%96%E5%86%99%E7%BA%BF%E7%A8%8B%E9%83%BD%E8%A2%AB%E9%98%BB%E5%A1%9E%E3%80%82%E8%AF%BB%E5%86%99%E9%94%81%E7%BB%B4%E6%8A%A4%E4%BA%86%E4%B8%80%E4%B8%AA%E8%AF%BB%E9%94%81%E5%92%8C%E4%B8%80%E4%B8%AA%E5%86%99%E9%94%81%EF%BC%8C%E9%80%9A%E8%BF%87%E5%88%86%E7%A6%BB%E8%AF%BB%E5%86%99%E6%8F%90%E9%AB%98%E4%BA%86%E6%80%A7%E8%83%BD%E3%80%82%0A%0A**ReentrantReadWriteLock%20%E8%AF%BB%E5%86%99%E9%94%81%20%E5%AE%9E%E7%8E%B0%EF%BC%9A**%0A%E4%B8%BA%E4%BA%86%E5%9C%A8%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81%EF%BC%88%E4%B8%80%E4%B8%AA%E6%95%B4%E5%9E%8B%E5%8F%98%E9%87%8F%EF%BC%89%E4%B8%8A%E7%BB%B4%E6%8A%A4%E5%A4%9A%E4%B8%AA%E8%AF%BB%E7%BA%BF%E7%A8%8B%E5%92%8C%E4%B8%80%E4%B8%AA%E5%86%99%E7%BA%BF%E7%A8%8B%EF%BC%8C%E9%9C%80%E8%A6%81%E5%B0%86%E6%95%B4%E5%9E%8B%E5%8F%98%E9%87%8F**%E6%8C%89%E4%BD%8D%E5%88%86%E5%89%B2**%EF%BC%8C%E9%AB%9816%E4%BD%8D%E6%A0%87%E8%AF%86%E8%AF%BB%EF%BC%8C%E4%BD%8E16%E4%BD%8D%E6%A0%87%E8%AF%86%E5%86%99%E3%80%82%E5%9C%A8%E5%88%A4%E6%96%AD%E6%97%B6%EF%BC%8C%E9%80%9A%E8%BF%87%E4%BD%8D%E8%BF%90%E7%AE%97%E6%9D%A5%E5%BE%97%E7%9F%A5%E8%AF%BB%E5%92%8C%E5%86%99%E7%9A%84%E9%94%81%E7%9A%84%E8%8E%B7%E5%BE%97%E6%83%85%E5%86%B5%E3%80%82%0A-%20%EF%BC%881%EF%BC%89%E5%86%99%E9%94%81%E7%9A%84%E8%8E%B7%E5%8F%96%E4%B8%8E%E9%87%8A%E6%94%BE%EF%BC%9A%E5%86%99%E9%94%81%E6%98%AF%E4%B8%80%E4%B8%AA%E6%94%AF%E6%8C%81%E9%87%8D%E8%BF%9B%E5%85%A5%E7%9A%84**%E6%8E%92%E4%BB%96%E9%94%81**%E3%80%82%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%E5%86%99%E9%94%81%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%94%81%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%BE%97%E4%BA%86%EF%BC%8C%E5%88%99%E5%A2%9E%E5%8A%A0%E5%86%99%E7%8A%B6%E6%80%81%EF%BC%9B%E5%A6%82%E6%9E%9C%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E4%B8%8D%E6%98%AF%E8%8E%B7%E5%BE%97%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%88%96%E8%80%85%E9%94%81%E5%B7%B2%E7%BB%8F%E8%A2%AB%E8%AF%BB%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%EF%BC%8C%E5%88%99%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%AD%89%E5%BE%85%E3%80%82%0A-%20%EF%BC%882%EF%BC%89%E8%AF%BB%E9%94%81%E7%9A%84%E8%8E%B7%E5%8F%96%E4%B8%8E%E9%87%8A%E6%94%BE%EF%BC%9A%E8%AF%BB%E9%94%81%E6%98%AF%E4%B8%80%E4%B8%AA%E6%94%AF%E6%8C%81%E9%87%8D%E8%BF%9B%E5%85%A5%E7%9A%84**%E5%85%B1%E4%BA%AB%E9%94%81**%E3%80%82%E5%9C%A8%E6%B2%A1%E6%9C%89%E5%85%B6%E4%BB%96%E5%86%99%E7%BA%BF%E7%A8%8B%E6%88%96%E8%80%85%E5%86%99%E7%8A%B6%E6%80%81%E4%B8%BA0%E6%97%B6%EF%BC%8C%E8%AF%BB%E9%94%81%E6%80%BB%E6%98%AF%E8%A2%AB%E6%88%90%E5%8A%9F%E8%8E%B7%E5%8F%96%EF%BC%8C%E8%AF%BB%E7%8A%B6%E6%80%81%E5%A2%9E%E5%8A%A0%EF%BC%9B%E5%BD%93%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E5%86%8D%E6%AC%A1%E8%8E%B7%E5%8F%96%E8%AF%BB%E9%94%81%E6%97%B6%EF%BC%8C%E8%AF%BB%E7%8A%B6%E6%80%81%E4%B9%9F%E5%A2%9E%E5%8A%A0%E3%80%82%E5%BD%93%E8%AF%BB%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%E9%94%81%E6%97%B6%EF%BC%8C%E5%86%99%E9%94%81%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%85%B6%E4%BB%96%E5%86%99%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%8F%96%EF%BC%8C%E5%88%99%E7%AD%89%E5%BE%85%E3%80%82%0A%0A**%E9%94%81%E9%99%8D%E7%BA%A7**%EF%BC%9A%0A%E9%94%81%E9%99%8D%E7%BA%A7%E6%98%AF%E6%8A%8A%E5%86%99%E9%94%81%E9%99%8D%E7%BA%A7%E4%B8%BA%E8%AF%BB%E9%94%81%E3%80%82%E5%BF%85%E9%A1%BB%E6%98%AF%E4%BF%9D%E6%8C%81%E5%BD%93%E5%89%8D%E7%9A%84%E5%86%99%E9%94%81%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%88%B0%E8%AF%BB%E9%94%81%E5%90%8E%E5%86%8D%E9%87%8A%E6%94%BE%E5%86%99%E9%94%81%EF%BC%9B%E5%85%88%E9%87%8A%E6%94%BE%E5%86%99%E9%94%81%E5%86%8D%E8%8E%B7%E5%8F%96%E8%AF%BB%E9%94%81%E4%B8%8D%E7%AE%97%E9%94%81%E9%99%8D%E7%BA%A7%E3%80%82%0A%0A%23%23%23%203.4%20LockSupport%0ALockSupport%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%85%B7%E7%B1%BB%EF%BC%8C%E5%AE%83%E5%AE%9A%E4%B9%89%E4%BA%86%E4%B8%80%E7%BB%84%E5%85%AC%E5%85%B1%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E4%BA%9B%E6%96%B9%E6%B3%95%E6%8F%90%E4%BE%9B%E4%BA%86%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%98%BB%E5%A1%9E%E5%92%8C%E5%94%A4%E9%86%92%E5%8A%9F%E8%83%BD%E3%80%82%0A%23%23%23%203.5%20Condition%E6%8E%A5%E5%8F%A3%0A%0A%E4%BB%BB%E6%84%8F%E4%B8%80%E4%B8%AAJava%E5%AF%B9%E8%B1%A1%EF%BC%8C%E9%83%BD%E6%8B%A5%E6%9C%89%E4%B8%80%E7%BB%84%E7%9B%91%E8%A7%86%E5%99%A8%E6%96%B9%E6%B3%95%EF%BC%88%E5%AE%9A%E4%B9%89%E5%9C%A8java.lang.Object%E4%B8%8A%EF%BC%89%EF%BC%8C%E4%B8%BB%E8%A6%81%E5%8C%85%E6%8B%ACwait()%E3%80%81wait(long%20timeout)%E3%80%81notify()%E4%BB%A5%E5%8F%8AnotifyAll()%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E4%BA%9B%E6%96%B9%E6%B3%95%E4%B8%8Esynchronized%E5%90%8C%E6%AD%A5%E5%85%B3%E9%94%AE%E5%AD%97%E9%85%8D%E5%90%88%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%BC%8F%E3%80%82Condition%E6%8E%A5%E5%8F%A3%E4%B9%9F%E6%8F%90%E4%BE%9B%E4%BA%86%E7%B1%BB%E4%BC%BCObject%E7%9A%84%E7%9B%91%E8%A7%86%E5%99%A8%E6%96%B9%E6%B3%95%EF%BC%8C%E4%B8%8ELock%E9%85%8D%E5%90%88%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%BC%8F%EF%BC%8C%E4%BD%86%E6%98%AF%E8%BF%99%E4%B8%A4%E8%80%85%E5%9C%A8%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F%E4%BB%A5%E5%8F%8A%E5%8A%9F%E8%83%BD%E7%89%B9%E6%80%A7%E4%B8%8A%E8%BF%98%E6%98%AF%E6%9C%89%E5%B7%AE%E5%88%AB%E7%9A%84%E3%80%82%0A!%5Bf5f072780cbecfcff292d7ec5bb0d01d.png%5D(en-resource%3A%2F%2Fdatabase%2F883%3A1)%0A%0ACondition%E5%AF%B9%E8%B1%A1%E6%98%AF%E7%94%B1Lock%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E5%87%BA%E6%9D%A5%E7%9A%84%E3%80%82%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AAcondition%E5%BF%85%E9%A1%BB%E9%80%9A%E8%BF%87Lock%E7%9A%84new%20Condition()%E6%96%B9%E6%B3%95%E3%80%82%0ACondition%E5%AE%9A%E4%B9%89%E4%BA%86%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E4%B8%A4%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8%E8%BF%99%E4%BA%9B%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E9%9C%80%E8%A6%81%E6%8F%90%E5%89%8D%E8%8E%B7%E5%8F%96%E5%88%B0Condition%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E7%9A%84%E9%94%81%E3%80%82%0A%0A**Condition%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%9A**%0A%0AConditionObject%E6%98%AF%E5%90%8C%E6%AD%A5%E5%99%A8AbstractQueuedSynchronizer%E7%9A%84%E5%86%85%E9%83%A8%E7%B1%BB%EF%BC%8C%E5%9B%A0%E4%B8%BACondition%E7%9A%84%E6%93%8D%E4%BD%9C%E9%9C%80%E8%A6%81%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84%E9%94%81%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BD%9C%E4%B8%BA%E5%90%8C%E6%AD%A5%E5%99%A8%E7%9A%84%E5%86%85%E9%83%A8%E7%B1%BB%E4%B9%9F%E8%BE%83%E4%B8%BA%E5%90%88%E7%90%86%E3%80%82%E6%AF%8F%E4%B8%AACondition%E5%AF%B9%E8%B1%A1%E9%83%BD%E5%8C%85%E5%90%AB%E7%9D%80%E4%B8%80%E4%B8%AA%E9%98%9F%E5%88%97%EF%BC%88%E4%BB%A5%E4%B8%8B%E7%A7%B0%E4%B8%BA%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%EF%BC%89%EF%BC%8C%E8%AF%A5%E9%98%9F%E5%88%97%E6%98%AFCondition%E5%AF%B9%E8%B1%A1%E5%AE%9E%E7%8E%B0%E7%AD%89%E5%BE%85%2F%E9%80%9A%E7%9F%A5%E5%8A%9F%E8%83%BD%E7%9A%84%E5%85%B3%E9%94%AE%E3%80%82%0A%0A%0A**%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97**%E6%98%AF%E4%B8%80%E4%B8%AAFIFO%E7%9A%84%E9%98%9F%E5%88%97%EF%BC%8C%E5%9C%A8%E9%98%9F%E5%88%97%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E8%8A%82%E7%82%B9%E9%83%BD%E5%8C%85%E5%90%AB%E4%BA%86%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%BC%95%E7%94%A8%EF%BC%8C%E8%AF%A5%E7%BA%BF%E7%A8%8B%E5%B0%B1%E6%98%AF%E5%9C%A8Condition%E5%AF%B9%E8%B1%A1%E4%B8%8A%E7%AD%89%E5%BE%85%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8%E4%BA%86Condition.await()%E6%96%B9%E6%B3%95%EF%BC%8C%E9%82%A3%E4%B9%88%E8%AF%A5%E7%BA%BF%E7%A8%8B%E5%B0%86%E4%BC%9A%E9%87%8A%E6%94%BE%E9%94%81%E3%80%81%E6%9E%84%E9%80%A0%E6%88%90%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E5%B9%B6%E8%BF%9B%E5%85%A5%E7%AD%89%E5%BE%85%E7%8A%B6%E6%80%81%E3%80%82%E4%BA%8B%E5%AE%9E%E4%B8%8A%EF%BC%8C%E8%8A%82%E7%82%B9%E7%9A%84%E5%AE%9A%E4%B9%89%E5%A4%8D%E7%94%A8%E4%BA%86%E5%90%8C%E6%AD%A5%E5%99%A8%E4%B8%AD%E8%8A%82%E7%82%B9%E7%9A%84%E5%AE%9A%E4%B9%89%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%EF%BC%8C%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E5%92%8C%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E4%B8%AD%E8%8A%82%E7%82%B9%E7%B1%BB%E5%9E%8B%E9%83%BD%E6%98%AF%E5%90%8C%E6%AD%A5%E5%99%A8%E7%9A%84%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BBAbstractQueuedSynchronizer.Node%E3%80%82%E4%B8%80%E4%B8%AACondition%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%EF%BC%8CCondition%E6%8B%A5%E6%9C%89%E9%A6%96%E8%8A%82%E7%82%B9%EF%BC%88firstWaiter%EF%BC%89%E5%92%8C%E5%B0%BE%E8%8A%82%E7%82%B9%EF%BC%88lastWaiter%EF%BC%89%E3%80%82%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8Condition.await()%E6%96%B9%E6%B3%95%EF%BC%8C%E5%B0%86%E4%BC%9A%E4%BB%A5%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E6%9E%84%E9%80%A0%E8%8A%82%E7%82%B9%EF%BC%8C%E5%B9%B6%E5%B0%86%E8%8A%82%E7%82%B9%E4%BB%8E%E5%B0%BE%E9%83%A8%E5%8A%A0%E5%85%A5%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E3%80%82Condition%E6%8B%A5%E6%9C%89%E9%A6%96%E5%B0%BE%E8%8A%82%E7%82%B9%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%8C%E8%80%8C%E6%96%B0%E5%A2%9E%E8%8A%82%E7%82%B9%E5%8F%AA%E9%9C%80%E8%A6%81%E5%B0%86%E5%8E%9F%E6%9C%89%E7%9A%84%E5%B0%BE%E8%8A%82%E7%82%B9nextWaiter%E6%8C%87%E5%90%91%E5%AE%83%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%9B%B4%E6%96%B0%E5%B0%BE%E8%8A%82%E7%82%B9%E5%8D%B3%E5%8F%AF%E3%80%82%E4%B8%8A%E8%BF%B0%E8%8A%82%E7%82%B9%E5%BC%95%E7%94%A8%E6%9B%B4%E6%96%B0%E7%9A%84%E8%BF%87%E7%A8%8B%E5%B9%B6%E6%B2%A1%E6%9C%89%E4%BD%BF%E7%94%A8CAS%E4%BF%9D%E8%AF%81%EF%BC%8C%E5%8E%9F%E5%9B%A0%E5%9C%A8%E4%BA%8E%E8%B0%83%E7%94%A8await()%E6%96%B9%E6%B3%95%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%BF%85%E5%AE%9A%E6%98%AF%E8%8E%B7%E5%8F%96%E4%BA%86%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%E8%AF%A5%E8%BF%87%E7%A8%8B%E6%98%AF%E7%94%B1%E9%94%81%E6%9D%A5%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E3%80%82%0A!%5Bd153547c1276eacfdca1910095c3df58.png%5D(en-resource%3A%2F%2Fdatabase%2F885%3A1)%0A**%E7%AD%89%E5%BE%85**%EF%BC%9A%0A%E8%B0%83%E7%94%A8Condition%E7%9A%84await()%E6%96%B9%E6%B3%95%EF%BC%88%E6%88%96%E8%80%85%E4%BB%A5await%E5%BC%80%E5%A4%B4%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89%EF%BC%8C%E4%BC%9A%E4%BD%BF%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E8%BF%9B%E5%85%A5%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E5%B9%B6%E9%87%8A%E6%94%BE%E9%94%81%EF%BC%8C%E5%90%8C%E6%97%B6%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E4%B8%BA%E7%AD%89%E5%BE%85%E7%8A%B6%E6%80%81%E3%80%82%E5%BD%93%E4%BB%8Eawait()%E6%96%B9%E6%B3%95%E8%BF%94%E5%9B%9E%E6%97%B6%EF%BC%8C%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E4%B8%80%E5%AE%9A%E8%8E%B7%E5%8F%96%E4%BA%86Condition%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84%E9%94%81%E3%80%82%E5%A6%82%E6%9E%9C%E4%BB%8E%E9%98%9F%E5%88%97%EF%BC%88%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E5%92%8C%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%EF%BC%89%E7%9A%84%E8%A7%92%E5%BA%A6%E7%9C%8Bawait()%E6%96%B9%E6%B3%95%EF%BC%8C%E5%BD%93%E8%B0%83%E7%94%A8await()%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E7%9B%B8%E5%BD%93%E4%BA%8E%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E7%9A%84%E9%A6%96%E8%8A%82%E7%82%B9%EF%BC%88%E8%8E%B7%E5%8F%96%E4%BA%86%E9%94%81%E7%9A%84%E8%8A%82%E7%82%B9%EF%BC%89%E7%A7%BB%E5%8A%A8%E5%88%B0Condition%E7%9A%84%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E4%B8%AD%E3%80%82%0A**%E9%80%9A%E7%9F%A5%EF%BC%9A**%0A%E8%B0%83%E7%94%A8Condition%E7%9A%84signal()%E6%96%B9%E6%B3%95%EF%BC%8C%E5%B0%86%E4%BC%9A%E5%94%A4%E9%86%92%E5%9C%A8%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E4%B8%AD%E7%AD%89%E5%BE%85%E6%97%B6%E9%97%B4%E6%9C%80%E9%95%BF%E7%9A%84%E8%8A%82%E7%82%B9%EF%BC%88%E9%A6%96%E8%8A%82%E7%82%B9%EF%BC%89%EF%BC%8C%E5%9C%A8%E5%94%A4%E9%86%92%E8%8A%82%E7%82%B9%E4%B9%8B%E5%89%8D%EF%BC%8C%E4%BC%9A%E5%B0%86%E8%8A%82%E7%82%B9%E7%A7%BB%E5%88%B0%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E4%B8%AD%E3%80%82%E8%B0%83%E7%94%A8%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%98%AF%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E5%BF%85%E9%A1%BB%E8%8E%B7%E5%8F%96%E4%BA%86%E9%94%81%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0signal()%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E4%BA%86isHeldExclusively()%E6%A3%80%E6%9F%A5%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E5%BF%85%E9%A1%BB%E6%98%AF%E8%8E%B7%E5%8F%96%E4%BA%86%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E3%80%82%E6%8E%A5%E7%9D%80%E8%8E%B7%E5%8F%96%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E7%9A%84%E9%A6%96%E8%8A%82%E7%82%B9%EF%BC%8C%E5%B0%86%E5%85%B6%E7%A7%BB%E5%8A%A8%E5%88%B0%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97%E5%B9%B6%E4%BD%BF%E7%94%A8LockSupport%E5%94%A4%E9%86%92%E8%8A%82%E7%82%B9%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%A8%8B%E3%80%82%0A%0A%23%23%23%203.6%20%E4%B9%90%E8%A7%82%E9%94%81%E4%B8%8E%E6%82%B2%E8%A7%82%E9%94%81%0A-%20**%E6%82%B2%E8%A7%82%E9%94%81**%E6%80%BB%E6%98%AF%E5%81%87%E8%AE%BE%E6%9C%80%E5%9D%8F%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E6%AF%8F%E6%AC%A1%E5%8E%BB%E6%8B%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%E9%83%BD%E8%AE%A4%E4%B8%BA%E5%88%AB%E4%BA%BA%E4%BC%9A%E4%BF%AE%E6%94%B9%EF%BC%8C%E6%89%80%E4%BB%A5%E6%AF%8F%E6%AC%A1%E5%9C%A8%E6%8B%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%E9%83%BD%E4%BC%9A%E4%B8%8A%E9%94%81%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%88%AB%E4%BA%BA%E6%83%B3%E6%8B%BF%E8%BF%99%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%B0%B1%E4%BC%9A%E9%98%BB%E5%A1%9E%E7%9B%B4%E5%88%B0%E5%AE%83%E6%8B%BF%E5%88%B0%E9%94%81%EF%BC%88%E5%85%B1%E4%BA%AB%E8%B5%84%E6%BA%90%E6%AF%8F%E6%AC%A1%E5%8F%AA%E7%BB%99%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%BD%BF%E7%94%A8%EF%BC%8C%E5%85%B6%E5%AE%83%E7%BA%BF%E7%A8%8B%E9%98%BB%E5%A1%9E%EF%BC%8C%E7%94%A8%E5%AE%8C%E5%90%8E%E5%86%8D%E6%8A%8A%E8%B5%84%E6%BA%90%E8%BD%AC%E8%AE%A9%E7%BB%99%E5%85%B6%E5%AE%83%E7%BA%BF%E7%A8%8B%EF%BC%89%E3%80%82%E4%BC%A0%E7%BB%9F%E7%9A%84%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E9%87%8C%E8%BE%B9%E5%B0%B1%E7%94%A8%E5%88%B0%E4%BA%86%E5%BE%88%E5%A4%9A%E8%BF%99%E7%A7%8D%E9%94%81%E6%9C%BA%E5%88%B6%EF%BC%8C%E6%AF%94%E5%A6%82%E8%A1%8C%E9%94%81%EF%BC%8C%E8%A1%A8%E9%94%81%E7%AD%89%EF%BC%8C%E8%AF%BB%E9%94%81%EF%BC%8C%E5%86%99%E9%94%81%E7%AD%89%EF%BC%8C%E9%83%BD%E6%98%AF%E5%9C%A8%E5%81%9A%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%89%8D%E5%85%88%E4%B8%8A%E9%94%81%E3%80%82Java%E4%B8%ADsynchronized%E5%92%8CReentrantLock%E7%AD%89%E7%8B%AC%E5%8D%A0%E9%94%81%E5%B0%B1%E6%98%AF%E6%82%B2%E8%A7%82%E9%94%81%E6%80%9D%E6%83%B3%E7%9A%84%E5%AE%9E%E7%8E%B0%E3%80%82%0A-%20**%E4%B9%90%E8%A7%82%E9%94%81**%E6%80%BB%E6%98%AF%E5%81%87%E8%AE%BE%E6%9C%80%E5%A5%BD%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E6%AF%8F%E6%AC%A1%E5%8E%BB%E6%8B%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%E9%83%BD%E8%AE%A4%E4%B8%BA%E5%88%AB%E4%BA%BA%E4%B8%8D%E4%BC%9A%E4%BF%AE%E6%94%B9%EF%BC%8C%E6%89%80%E4%BB%A5%E4%B8%8D%E4%BC%9A%E4%B8%8A%E9%94%81%EF%BC%8C%E4%BD%86%E6%98%AF%E5%9C%A8%E6%9B%B4%E6%96%B0%E7%9A%84%E6%97%B6%E5%80%99%E4%BC%9A%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%8B%E5%9C%A8%E6%AD%A4%E6%9C%9F%E9%97%B4%E5%88%AB%E4%BA%BA%E6%9C%89%E6%B2%A1%E6%9C%89%E5%8E%BB%E6%9B%B4%E6%96%B0%E8%BF%99%E4%B8%AA%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8**%E7%89%88%E6%9C%AC%E5%8F%B7%E6%9C%BA%E5%88%B6%E5%92%8CCAS%E7%AE%97%E6%B3%95**%E5%AE%9E%E7%8E%B0%E3%80%82%E4%B9%90%E8%A7%82%E9%94%81%E9%80%82%E7%94%A8%E4%BA%8E%E5%A4%9A%E8%AF%BB%E7%9A%84%E5%BA%94%E7%94%A8%E7%B1%BB%E5%9E%8B%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E6%8F%90%E9%AB%98%E5%90%9E%E5%90%90%E9%87%8F%EF%BC%8C%E5%83%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E4%BE%9B%E7%9A%84%E7%B1%BB%E4%BC%BC%E4%BA%8Ewrite_condition%E6%9C%BA%E5%88%B6%EF%BC%8C%E5%85%B6%E5%AE%9E%E9%83%BD%E6%98%AF%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B9%90%E8%A7%82%E9%94%81%E3%80%82%E5%9C%A8Java%E4%B8%ADjava.util.concurrent.atomic%E5%8C%85%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%8E%9F%E5%AD%90%E5%8F%98%E9%87%8F%E7%B1%BB%E5%B0%B1%E6%98%AF%E4%BD%BF%E7%94%A8%E4%BA%86%E4%B9%90%E8%A7%82%E9%94%81%E7%9A%84%E4%B8%80%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8FCAS%E5%AE%9E%E7%8E%B0%E7%9A%84%E3%80%82%0A-%20**%E4%B8%A4%E7%A7%8D%E9%94%81%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF**%E4%BB%8E%E4%B8%8A%E9%9D%A2%E5%AF%B9%E4%B8%A4%E7%A7%8D%E9%94%81%E7%9A%84%E4%BB%8B%E7%BB%8D%EF%BC%8C%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%E4%B8%A4%E7%A7%8D%E9%94%81%E5%90%84%E6%9C%89%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%8C%E4%B8%8D%E5%8F%AF%E8%AE%A4%E4%B8%BA%E4%B8%80%E7%A7%8D%E5%A5%BD%E4%BA%8E%E5%8F%A6%E4%B8%80%E7%A7%8D%EF%BC%8C%E5%83%8F**%E4%B9%90%E8%A7%82%E9%94%81%E9%80%82%E7%94%A8%E4%BA%8E%E5%86%99%E6%AF%94%E8%BE%83%E5%B0%91%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%88%E5%A4%9A%E8%AF%BB%E5%9C%BA%E6%99%AF%EF%BC%89**%EF%BC%8C%E5%8D%B3%E5%86%B2%E7%AA%81%E7%9C%9F%E7%9A%84%E5%BE%88%E5%B0%91%E5%8F%91%E7%94%9F%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E7%9C%81%E5%8E%BB%E4%BA%86%E9%94%81%E7%9A%84%E5%BC%80%E9%94%80%EF%BC%8C%E5%8A%A0%E5%A4%A7%E4%BA%86%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%95%B4%E4%B8%AA%E5%90%9E%E5%90%90%E9%87%8F%E3%80%82%E4%BD%86%E5%A6%82%E6%9E%9C%E6%98%AF%E5%A4%9A%E5%86%99%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E4%B8%80%E8%88%AC%E4%BC%9A%E7%BB%8F%E5%B8%B8%E4%BA%A7%E7%94%9F%E5%86%B2%E7%AA%81%EF%BC%8C%E8%BF%99%E5%B0%B1%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%B8%8A%E5%B1%82%E5%BA%94%E7%94%A8%E4%BC%9A%E4%B8%8D%E6%96%AD%E7%9A%84%E8%BF%9B%E8%A1%8Cretry%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%8D%E5%80%92%E6%98%AF%E9%99%8D%E4%BD%8E%E4%BA%86%E6%80%A7%E8%83%BD%EF%BC%8C%E6%89%80%E4%BB%A5%E4%B8%80%E8%88%AC**%E5%A4%9A%E5%86%99%E7%9A%84%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%94%A8%E6%82%B2%E8%A7%82%E9%94%81**%E5%B0%B1%E6%AF%94%E8%BE%83%E5%90%88%E9%80%82%E3%80%82%0A%0A%23%23%204%20java%E5%B9%B6%E5%8F%91%E5%AE%B9%E5%99%A8%E3%80%81%E6%A1%86%E6%9E%B6%0A%23%23%23%204.1%20ConcurrentHashMap%0A%23%23%23%23%204.1.1%20ConcurrentHashMap%20%E7%94%B1%E6%9D%A5%0A%EF%BC%881%EF%BC%89HashMap%E6%98%AF%E9%9D%9E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%EF%BC%8C%E5%9C%A8%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8CPut%E6%97%B6%EF%BC%8C%E4%BC%9A%E5%AF%BC%E8%87%B4entry%E9%93%BE%E8%A1%A8%E5%BD%A2%E6%88%90%E7%8E%AF%EF%BC%8C%E6%9E%84%E6%88%90%E6%AD%BB%E9%94%81%E3%80%82%0A%EF%BC%882%EF%BC%89HashTable%E6%98%AF%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%EF%BC%8C%E4%BD%86%E6%98%AF%E6%95%88%E7%8E%87%E9%9D%9E%E5%B8%B8%E4%BD%8E%E4%B8%8B%0A%EF%BC%883%EF%BC%89ConcurrentHashMap%E7%9A%84%E9%94%81%E5%88%86%E6%AE%B5%E6%8A%80%E6%9C%AF%E5%8F%AF%E4%BB%A5%E6%9C%89%E6%95%88%E6%8F%90%E9%AB%98%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E7%8E%87%0A%0A%23%23%23%23%204.1.2%20ConcurrentHashMap%E7%9A%84%E7%BB%93%E6%9E%84%0AConcurrentHashMap%E7%94%B1Segment%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CHashEntry%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84%E7%BB%84%E6%88%90%E3%80%82%0A!%5B0ce320b65db85fd15090ebd2d9a1b028.png%5D(en-resource%3A%2F%2Fdatabase%2F887%3A1)%0ASegment%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81%EF%BC%8CHashEntry%E7%94%A8%E6%9D%A5%E5%AD%98%E5%82%A8%E9%94%AE%E5%80%BC%E5%AF%B9%E6%95%B0%E6%8D%AE%E3%80%82%E7%9B%B8%E5%BD%93%E4%BA%8E%E6%AF%8F%E4%B8%AAsegment%E9%87%8C%E6%9C%89%E4%B8%80%E4%B8%AAHashMap%EF%BC%88HashEntry%E6%95%B0%E7%BB%84%EF%BC%89%E3%80%82%E5%BD%93%E5%AF%B9HashEntry%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%E6%97%B6%EF%BC%8C%E5%BF%85%E9%A1%BB%E5%85%88%E8%8E%B7%E5%BE%97%E8%BF%99%E4%B8%AAHashEntry%E6%95%B0%E7%BB%84%E5%AF%B9%E5%BA%94%E7%9A%84Segment%E9%94%81%E3%80%82%0A%23%23%23%23%204.1.2%20ConcurrentHashMap%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%0AConcurrentHashMap%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E9%80%9A%E8%BF%87initialCapacity%E3%80%81loadFactor%E5%92%8CconcurrencyLevel%E6%9D%A5%E5%88%9D%E5%A7%8B%E5%8C%96segment%E6%95%B0%E7%BB%84%E3%80%81%E6%AE%B5%E5%81%8F%E7%A7%BB%E9%87%8FsegmentShift%E3%80%81%E6%AE%B5%E6%8E%A9%E7%A0%81segmentMask%E5%92%8C%E6%AF%8F%E4%B8%AAsegment%E9%87%8C%E7%9A%84HashEntry%E6%95%B0%E7%BB%84%E3%80%82%0A%0A**segments%E6%95%B0%E7%BB%84**%EF%BC%9Asegments%E6%95%B0%E7%BB%84%E7%9A%84%E9%95%BF%E5%BA%A6%E6%98%AF%E9%80%9A%E8%BF%87concurrencyLevel%E8%AE%A1%E7%AE%97%E5%BE%97%E5%87%BA%E7%9A%84%EF%BC%8C%E5%BF%85%E9%A1%BB%E4%BF%9D%E8%AF%81%E5%85%B6%E9%95%BF%E5%BA%A6%E6%98%AF2%E7%9A%84N%E6%AC%A1%E6%96%B9%E6%89%8D%E8%83%BD%E4%BD%BF%E5%85%B6%E8%83%BD%E9%80%9A%E8%BF%87%E6%8C%89%E4%BD%8D%E4%B8%8E%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AE%9A%E4%BD%8Dsegments%E6%95%B0%E7%BB%84%E7%B4%A2%E5%BC%95%E3%80%82%E6%89%80%E4%BB%A5%EF%BC%8C%E8%A6%81%E6%89%BE%E5%88%B0%E5%A4%A7%E4%BA%8EconcurrencyLevel%E7%9A%84%E6%9C%80%E5%B0%8F2%E7%9A%84N%E6%AC%A1%E6%96%B9%E3%80%82%0A%0A**%E6%AE%B5%E5%81%8F%E7%A7%BB%E9%87%8FsegmentShift%E3%80%81%E6%AE%B5%E6%8E%A9%E7%A0%81segmentMask**%EF%BC%9A%E8%BF%99%E4%B8%A4%E4%B8%AA%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%9C%A8%E5%AE%9A%E4%BD%8Dsegment%E6%97%B6%E4%BD%BF%E7%94%A8%E3%80%82%0A%0A**%E5%88%9D%E5%A7%8B%E5%8C%96%E6%AF%8F%E4%B8%AAsegment**%EF%BC%9A%E7%94%A8initialCapacity%E4%BD%9C%E4%B8%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%B9%E9%87%8F%E3%80%81loadFactor%E4%BD%9C%E4%B8%BA%E8%B4%9F%E8%BD%BD%E5%9B%A0%E5%AD%90%E6%9D%A5%E5%88%9D%E5%A7%8B%E5%8C%96%E6%AF%8F%E4%B8%AAsegment%E3%80%82%E5%92%8CHashMap%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E6%A0%B7%E3%80%82%0A%0A%23%23%23%23%204.1.3%20%E5%AE%9A%E4%BD%8Dsegment%0A%E5%9C%A8%E6%8F%92%E5%85%A5%E5%92%8C%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E9%80%9A%E8%BF%87hash%E7%AE%97%E6%B3%95%E5%8F%AF%E4%BB%A5%E5%BE%97%E7%9F%A5%E5%BD%93%E5%89%8D%E5%85%83%E7%B4%A0%E7%9A%84hashCode%E3%80%82%E9%A6%96%E5%85%88%E8%A6%81%E9%80%9A%E8%BF%87%E4%B8%80%E6%AC%A1%E5%AF%B9%E4%BA%8EhashCode%E7%9A%84%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95%EF%BC%88%E5%AE%9A%E4%BD%8D%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95%EF%BC%89%E5%AE%9A%E4%BD%8D%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84segment%E3%80%82%E8%BF%99%E6%AC%A1%E6%95%A3%E5%88%97%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E5%87%8F%E5%B0%91%E6%95%A3%E5%88%97%E5%86%B2%E7%AA%81%EF%BC%8C%E4%BD%BF%E5%85%83%E7%B4%A0%E8%83%BD%E5%A4%9F%E5%9D%87%E5%8C%80%E5%9C%B0%E5%88%86%E5%B8%83%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84segment%E4%B8%AD%EF%BC%8C%E6%8F%90%E9%AB%98%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AD%98%E5%82%A8%E6%95%88%E7%8E%87%E3%80%82%0A%E5%AE%9A%E4%BD%8Dsegment%E4%BD%BF%E7%94%A8%E7%9A%84%E7%AE%97%E6%B3%95%E6%98%AF%EF%BC%88%20hash%20%3E%3E%3E%20segmentShift%20)%26%20segmentMask%E3%80%82%0A%0A%23%23%23%23%204.1.4%20ConcurrentHashMap%E7%9A%84%E6%93%8D%E4%BD%9C%0A-%20get%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%9C%A8%E8%BF%9B%E8%A1%8C%E5%AE%9A%E4%BD%8Dsegment%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%86%8D%E6%AC%A1%E4%BD%BF%E7%94%A8%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95%E5%AE%9A%E4%BD%8D%E5%88%B0%E5%85%83%E7%B4%A0%E3%80%82get%E6%96%B9%E6%B3%95%E4%B8%AD%E5%B0%86%E5%85%B6%E4%BD%BF%E7%94%A8%E7%9A%84%E5%85%B1%E4%BA%AB%E5%85%83%E7%B4%A0%E9%83%BD%E8%AE%BE%E7%BD%AE%E4%B8%BAvolatile%EF%BC%8C%E6%89%80%E4%BB%A5get%E8%BF%87%E7%A8%8B%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8A%A0%E9%94%81%EF%BC%8C%E5%8D%81%E5%88%86%E9%AB%98%E6%95%88%E3%80%82%0A-%20put%E6%93%8D%E4%BD%9C%EF%BC%9Azaiput%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AF%B9%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E8%BF%9B%E8%A1%8C%E5%86%99%E5%85%A5%E6%97%B6%EF%BC%8C%E5%BF%85%E9%A1%BB%E5%8A%A0%E9%94%81%E3%80%82%E5%8A%A0%E5%85%A5%E5%85%83%E7%B4%A0%E6%97%B6%EF%BC%8C%E9%A6%96%E5%85%88%E5%AE%9A%E4%BD%8D%E5%88%B0segment%EF%BC%8C%E7%84%B6%E5%90%8E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%EF%BC%881%EF%BC%89%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8Dsegment%E9%87%8C%E7%9A%84hashEntry%E6%95%B0%E7%BB%84%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E6%89%A9%E5%AE%B9%EF%BC%88%E9%9C%80%E8%A6%81%E5%88%99%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E4%B8%A4%E5%80%8D%E5%A4%A7%E7%9A%84%E6%95%B0%E7%BB%84%EF%BC%8C%E5%B0%86%E5%8E%9F%E6%95%B0%E7%BB%84%E5%A4%8D%E5%88%B6%E8%BF%87%E5%8E%BB%EF%BC%89%EF%BC%9B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%EF%BC%882%EF%BC%89%E5%AE%9A%E4%BD%8D%E5%88%B0%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E8%BF%9B%E8%A1%8C%E6%B7%BB%E5%8A%A0%E3%80%82%E5%AE%9A%E4%BD%8DHashEntry%E4%BD%BF%E7%94%A8%E7%9A%84%E7%AE%97%E6%B3%95%E6%98%AFhash%20%26%EF%BC%88tab.length%20-%201%EF%BC%89%E3%80%82%0A%20%20%20%20%20%20%20%20%20%20%20%20%20**%E5%9C%A8%E6%89%A9%E5%AE%B9%E5%90%8E%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E9%87%8D%E6%96%B0%E8%AE%A1%E7%AE%97%E5%85%83%E7%B4%A0%E7%9A%84hash%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%85%83%E7%B4%A0%E7%9B%B8%E5%AF%B9%E4%BA%8E%E6%95%B0%E7%BB%84%E7%9A%84%E4%BD%8D%E7%BD%AE%E8%BF%98%E6%98%AF%E4%B8%8D%E5%8F%98%E7%9A%84%E3%80%82**%0A-%20size%E6%93%8D%E4%BD%9C%EF%BC%9A%E7%BB%9F%E8%AE%A1%E6%95%B4%E4%B8%AAConcurrentHashMap%E7%9A%84%E5%A4%A7%E5%B0%8F%EF%BC%8C%E9%9C%80%E8%A6%81%E7%BB%9F%E8%AE%A1%E6%89%80%E6%9C%89segment%E9%87%8C%E5%85%83%E7%B4%A0%E7%9A%84%E5%A4%A7%E5%B0%8F%E3%80%82segment%E4%B8%AD%E7%9A%84count%E6%98%AF%E4%B8%80%E4%B8%AAvolatile%E5%AF%B9%E8%B1%A1%EF%BC%8CConcurrentHashMap%E5%85%88%E5%B0%9D%E8%AF%95%E4%B8%A4%E6%AC%A1%E4%B8%8D%E5%AF%B9%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E5%8A%A0%E9%94%81%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9D%A5%E7%BB%9F%E8%AE%A1count%E7%9A%84%E5%80%BC%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%BB%9F%E8%AE%A1%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%8F%91%E7%94%9F%E4%BA%86%E6%94%B9%E5%8F%98%EF%BC%8C%E5%88%99%E5%86%8D%E5%8A%A0%E9%94%81%E7%BB%9F%E8%AE%A1%E3%80%82%E4%BB%A5%E6%AD%A4%E6%9D%A5%E9%81%BF%E5%85%8D%E6%AF%8F%E6%AC%A1%E7%9B%B4%E6%8E%A5%E5%8A%A0%E9%94%81%E7%BB%9F%E8%AE%A1%E5%AF%BC%E8%87%B4%E7%9A%84%E6%80%A7%E8%83%BD%E4%B8%8B%E9%99%8D%E3%80%82%0A%0A%23%23%23%204.2%20ConcurrentLinkedQueue%0A%0AConcurrentLinkedQueue%E6%98%AF%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E9%93%BE%E6%8E%A5%E8%8A%82%E7%82%B9%E7%9A%84%E6%97%A0%E7%95%8C%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%98%9F%E5%88%97%EF%BC%8C%E5%AE%83%E9%87%87%E7%94%A8%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E7%9A%84%E8%A7%84%E5%88%99%E5%AF%B9%E8%8A%82%E7%82%B9%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F%EF%BC%8C%E5%BD%93%E6%88%91%E4%BB%AC%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%AE%83%E4%BC%9A%E6%B7%BB%E5%8A%A0%E5%88%B0%E9%98%9F%E5%88%97%E7%9A%84%E5%B0%BE%E9%83%A8%EF%BC%8C%E5%BD%93%E6%88%91%E4%BB%AC%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E6%97%B6%EF%BC%8C%E5%AE%83%E4%BC%9A%E8%BF%94%E5%9B%9E%E9%98%9F%E5%88%97%E5%A4%B4%E9%83%A8%E7%9A%84%E5%85%83%E7%B4%A0%E3%80%82%E5%AE%83%E9%87%87%E7%94%A8%E4%BA%86%E2%80%9Cwait%EF%BC%8Dfree%E2%80%9D%E7%AE%97%E6%B3%95%E6%9D%A5%E5%AE%9E%E7%8E%B0%EF%BC%8C%E8%AF%A5%E7%AE%97%E6%B3%95%E5%9C%A8Michael%20%26%20Scott%E7%AE%97%E6%B3%95%E4%B8%8A%E8%BF%9B%E8%A1%8C%E4%BA%86%E4%B8%80%E4%BA%9B%E4%BF%AE%E6%94%B9%E3%80%82%0A%0A%23%23%23%23%204.2.1%20ConcurrentLinkedQueue%E7%9A%84%E7%BB%93%E6%9E%84%0AConcurrentLinkedQueue%E7%94%B1**head%E8%8A%82%E7%82%B9**%E5%92%8C**tail%E8%8A%82%E7%82%B9**%E7%BB%84%E6%88%90%EF%BC%8C%E6%AF%8F%E4%B8%AA%E8%8A%82%E7%82%B9%EF%BC%88Node%EF%BC%89%E7%94%B1%E8%8A%82%E7%82%B9%E5%85%83%E7%B4%A0%EF%BC%88item%EF%BC%89%E5%92%8C%E6%8C%87%E5%90%91%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9%E7%9A%84%E5%BC%95%E7%94%A8(next)%E7%BB%84%E6%88%90%EF%BC%8C%E8%8A%82%E7%82%B9%E4%B8%8E%E8%8A%82%E7%82%B9%E4%B9%8B%E9%97%B4%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87%E8%BF%99%E4%B8%AAnext%E5%85%B3%E8%81%94%E8%B5%B7%E6%9D%A5%EF%BC%8C%E4%BB%8E%E8%80%8C%E7%BB%84%E6%88%90%E4%B8%80%E5%BC%A0%E9%93%BE%E8%A1%A8%E7%BB%93%E6%9E%84%E7%9A%84%E9%98%9F%E5%88%97%E3%80%82%0A%0A%23%23%23%23%204.2.2%20%E5%85%A5%E9%98%9F%E5%88%97%0A%E5%85%A5%E9%98%9F%E5%88%97%E5%B0%B1%E6%98%AF%E5%B0%86%E5%85%A5%E9%98%9F%E8%8A%82%E7%82%B9%E6%B7%BB%E5%8A%A0%E5%88%B0%E9%98%9F%E5%88%97%E7%9A%84%E5%B0%BE%E9%83%A8%E3%80%82%0A!%5B14f4a898e287afa384df39ce95914bc5.png%5D(en-resource%3A%2F%2Fdatabase%2F889%3A1)%0A%E5%85%A5%E9%98%9F%E6%93%8D%E4%BD%9C%E4%B8%BB%E8%A6%81%E5%81%9A%E4%B8%A4%E4%BB%B6%E4%BA%8B%E6%83%85%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%98%AF**%E5%B0%86%E5%85%A5%E9%98%9F%E8%8A%82%E7%82%B9%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BD%93%E5%89%8D%E9%98%9F%E5%88%97%E5%B0%BE%E8%8A%82%E7%82%B9%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9**%E3%80%82%E7%AC%AC%E4%BA%8C%E6%98%AF**%E6%9B%B4%E6%96%B0tail%E8%8A%82%E7%82%B9**%EF%BC%8C%E5%A6%82%E6%9E%9Ctail%E8%8A%82%E7%82%B9%E7%9A%84next%E8%8A%82%E7%82%B9%E4%B8%8D%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%88%99%E5%B0%86%E5%85%A5%E9%98%9F%E8%8A%82%E7%82%B9%E8%AE%BE%E7%BD%AE%E6%88%90tail%E8%8A%82%E7%82%B9%EF%BC%8C%E5%A6%82%E6%9E%9Ctail%E8%8A%82%E7%82%B9%E7%9A%84next%E8%8A%82%E7%82%B9%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%88%99%E5%B0%86%E5%85%A5%E9%98%9F%E8%8A%82%E7%82%B9%E8%AE%BE%E7%BD%AE%E6%88%90tail%E7%9A%84next%E8%8A%82%E7%82%B9%EF%BC%8C%E6%89%80%E4%BB%A5**tail%E8%8A%82%E7%82%B9%E4%B8%8D%E6%80%BB%E6%98%AF%E5%B0%BE%E8%8A%82%E7%82%B9**%E3%80%82%0A%E5%9C%A8%E5%9B%BE%E4%B8%AD%E7%9C%8B%E6%9D%A5%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A01%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8Ctail%E8%8A%82%E7%82%B9%E7%AD%89%E4%BA%8Ehead%E8%8A%82%E7%82%B9%EF%BC%8Cnext%E9%83%BD%E6%8C%87%E5%90%91%E7%A9%BA%EF%BC%8C%E6%89%80%E4%BB%A5%E5%85%83%E7%B4%A01%E6%B7%BB%E5%8A%A0%E4%B9%8B%E5%90%8E%EF%BC%8Ctail%E8%8A%82%E7%82%B9%E7%9A%84next%E8%8A%82%E7%82%B9%E4%B8%BA%E5%85%A5%E9%98%9F%E8%8A%82%E7%82%B9%E5%85%83%E7%B4%A01%EF%BC%9B%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A02%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8Ctail%E7%9A%84next%E8%8A%82%E7%82%B9%E4%B8%8D%E7%A9%BA%EF%BC%8C%E4%B8%BA%E5%85%83%E7%B4%A01%E8%8A%82%E7%82%B9%EF%BC%8C%E6%89%80%E4%BB%A5%E6%B7%BB%E5%8A%A0%E5%AE%8C%E5%85%83%E7%B4%A02%E5%90%8E%E5%B0%86%E5%85%B6%E8%AE%BE%E7%BD%AE%E4%B8%BAtail%E8%8A%82%E7%82%B9%E3%80%82%0A%0A**tail%E8%8A%82%E7%82%B9%E4%B8%8D%E4%B8%80%E5%AE%9A%E4%B8%BA%E5%B0%BE%E8%8A%82%E7%82%B9%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%84%8F%E5%9B%BE**%EF%BC%9A%E4%B8%BA%E4%BA%86%E5%87%8F%E5%B0%91%E6%9B%B4%E6%96%B0tail%E8%8A%82%E7%82%B9%E7%9A%84%E6%AC%A1%E6%95%B0%E6%9D%A5%E6%8F%90%E9%AB%98%E5%85%A5%E9%98%9F%E6%95%88%E7%8E%87%E3%80%82%0A%0A%23%23%23%23%204.2.3%20%E5%87%BA%E9%98%9F%E5%88%97%0A%E5%87%BA%E9%98%9F%E5%88%97%E7%9A%84%E5%B0%B1%E6%98%AF%E4%BB%8E%E9%98%9F%E5%88%97%E9%87%8C%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9%E5%85%83%E7%B4%A0%EF%BC%8C%E5%B9%B6%E6%B8%85%E7%A9%BA%E8%AF%A5%E8%8A%82%E7%82%B9%E5%AF%B9%E5%85%83%E7%B4%A0%E7%9A%84%E5%BC%95%E7%94%A8%E3%80%82%0A!%5Bbe29f6a3cd31fe2a0fb79ab2c710abab.png%5D(en-resource%3A%2F%2Fdatabase%2F891%3A1)%0A%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E4%B8%BB%E8%A6%81%E9%80%BB%E8%BE%91%E5%B0%B1%E6%98%AF%E9%A6%96%E5%85%88%E8%8E%B7%E5%8F%96%E5%A4%B4%E8%8A%82%E7%82%B9%E7%9A%84%E5%85%83%E7%B4%A0%EF%BC%8C%E7%84%B6%E5%90%8E**%E5%88%A4%E6%96%AD%E5%A4%B4%E8%8A%82%E7%82%B9%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA**%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%BA%E7%A9%BA%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%B7%B2%E7%BB%8F%E8%BF%9B%E8%A1%8C%E4%BA%86%E4%B8%80%E6%AC%A1%E5%87%BA%E9%98%9F%E6%93%8D%E4%BD%9C%E5%B0%86%E8%AF%A5%E8%8A%82%E7%82%B9%E7%9A%84%E5%85%83%E7%B4%A0%E5%8F%96%E8%B5%B0%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%8D%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%88%99%E4%BD%BF%E7%94%A8CAS%E7%9A%84%E6%96%B9%E5%BC%8F%E5%B0%86%E5%A4%B4%E8%8A%82%E7%82%B9%E7%9A%84%E5%BC%95%E7%94%A8%E8%AE%BE%E7%BD%AE%E6%88%90null%EF%BC%8C%E5%A6%82%E6%9E%9CCAS%E6%88%90%E5%8A%9F%EF%BC%8C%E5%88%99%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E5%A4%B4%E8%8A%82%E7%82%B9%E7%9A%84%E5%85%83%E7%B4%A0%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%88%90%E5%8A%9F%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%B7%B2%E7%BB%8F%E8%BF%9B%E8%A1%8C%E4%BA%86%E4%B8%80%E6%AC%A1%E5%87%BA%E9%98%9F%E6%93%8D%E4%BD%9C%E6%9B%B4%E6%96%B0%E4%BA%86head%E8%8A%82%E7%82%B9%EF%BC%8C%E5%AF%BC%E8%87%B4%E5%85%83%E7%B4%A0%E5%8F%91%E7%94%9F%E4%BA%86%E5%8F%98%E5%8C%96%EF%BC%8C%E9%9C%80%E8%A6%81%E9%87%8D%E6%96%B0%E8%8E%B7%E5%8F%96%E5%A4%B4%E8%8A%82%E7%82%B9%E3%80%82%0A%E5%9C%A8%E5%9B%BE%E4%B8%AD%E7%9C%8B%E6%9D%A5%EF%BC%8C%E5%BC%B9%E5%87%BA%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8Chead%E8%8A%82%E7%82%B9%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%88%99%E8%AF%B4%E6%98%8E%E4%B9%8B%E5%89%8D%E6%9C%89%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%BC%B9%E5%87%BA%E4%BA%86%E5%A4%B4%E5%85%83%E7%B4%A0%EF%BC%8C%E9%9C%80%E8%A6%81%E9%87%8D%E6%96%B0%E8%8E%B7%E5%8F%96head%EF%BC%8C%E6%89%80%E4%BB%A5head%E8%A2%AB%E8%AE%BE%E7%BD%AE%E6%88%90%E4%B8%BA%E5%85%83%E7%B4%A02%EF%BC%9B%E5%BC%B9%E5%87%BA%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8Chead%E8%8A%82%E7%82%B9%E4%B8%8D%E4%B8%BA%E7%A9%BA%EF%BC%8C%E9%82%A3%E4%B9%88%E7%9B%B4%E6%8E%A5%E5%BC%B9%E5%87%BAhead%E7%9A%84%E5%85%83%E7%B4%A0%EF%BC%8Chead%E5%8F%98%E6%88%90%E7%A9%BA%E3%80%82%0A%E6%89%80%E4%BB%A5%E5%B9%B6%E4%B8%8D%E6%98%AF%E6%AF%8F%E6%AC%A1%E5%87%BA%E9%98%9F%E6%97%B6%E9%83%BD%E6%9B%B4%E6%96%B0head%E8%8A%82%E7%82%B9%EF%BC%8C%E5%BD%93head%E8%8A%82%E7%82%B9%E9%87%8C%E6%9C%89%E5%85%83%E7%B4%A0%E6%97%B6%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%BC%B9%E5%87%BAhead%E8%8A%82%E7%82%B9%E9%87%8C%E7%9A%84%E5%85%83%E7%B4%A0%EF%BC%8C%E8%80%8C%E4%B8%8D%E4%BC%9A%E6%9B%B4%E6%96%B0head%E8%8A%82%E7%82%B9%E3%80%82%E5%8F%AA%E6%9C%89%E5%BD%93head%E8%8A%82%E7%82%B9%E9%87%8C%E6%B2%A1%E6%9C%89%E5%85%83%E7%B4%A0%E6%97%B6%EF%BC%8C%E5%87%BA%E9%98%9F%E6%93%8D%E4%BD%9C%E6%89%8D%E4%BC%9A%E6%9B%B4%E6%96%B0head%E8%8A%82%E7%82%B9%E3%80%82%E9%87%87%E7%94%A8%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%E4%B9%9F%E6%98%AF%E4%B8%BA%E4%BA%86**%E5%87%8F%E5%B0%91%E4%BD%BF%E7%94%A8CAS%E6%9B%B4%E6%96%B0head%E8%8A%82%E7%82%B9%E7%9A%84%E6%B6%88%E8%80%97%EF%BC%8C%E4%BB%8E%E8%80%8C%E6%8F%90%E9%AB%98%E5%87%BA%E9%98%9F%E6%95%88%E7%8E%87**%E3%80%82%0A%0A%23%23%23%204.3%20java%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%0A%23%23%23%23%204.3.1%20%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%EF%BC%9F%0A%0A%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%EF%BC%88BlockingQueue%EF%BC%89%E6%98%AF%E4%B8%80%E4%B8%AA%E6%94%AF%E6%8C%81%E4%B8%A4%E4%B8%AA%E9%99%84%E5%8A%A0%E6%93%8D%E4%BD%9C%E7%9A%84%E9%98%9F%E5%88%97%E3%80%82%E8%BF%99%E4%B8%A4%E4%B8%AA%E9%99%84%E5%8A%A0%E7%9A%84%E6%93%8D%E4%BD%9C%E6%98%AF%EF%BC%9A%E5%9C%A8%E9%98%9F%E5%88%97%E4%B8%BA%E7%A9%BA%E6%97%B6%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%BC%9A%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E5%8F%98%E4%B8%BA%E9%9D%9E%E7%A9%BA%E3%80%82%E5%BD%93%E9%98%9F%E5%88%97%E6%BB%A1%E6%97%B6%EF%BC%8C%E5%AD%98%E5%82%A8%E5%85%83%E7%B4%A0%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%BC%9A%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97%E5%8F%AF%E7%94%A8%E3%80%82%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E5%B8%B8%E7%94%A8%E4%BA%8E%E7%94%9F%E4%BA%A7%E8%80%85%E5%92%8C%E6%B6%88%E8%B4%B9%E8%80%85%E7%9A%84%E5%9C%BA%E6%99%AF%EF%BC%8C%E7%94%9F%E4%BA%A7%E8%80%85%E6%98%AF%E5%BE%80%E9%98%9F%E5%88%97%E9%87%8C%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E6%B6%88%E8%B4%B9%E8%80%85%E6%98%AF%E4%BB%8E%E9%98%9F%E5%88%97%E9%87%8C%E6%8B%BF%E5%85%83%E7%B4%A0%E7%9A%84%E7%BA%BF%E7%A8%8B%E3%80%82%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E5%B0%B1%E6%98%AF%E7%94%9F%E4%BA%A7%E8%80%85%E5%AD%98%E6%94%BE%E5%85%83%E7%B4%A0%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%8C%E8%80%8C%E6%B6%88%E8%B4%B9%E8%80%85%E4%B9%9F%E5%8F%AA%E4%BB%8E%E5%AE%B9%E5%99%A8%E9%87%8C%E6%8B%BF%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E6%8F%90%E4%BE%9B%E4%BA%86%E5%9B%9B%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%3A%0A%7C%20%E6%96%B9%E6%B3%95%5C%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%20%7C%20%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%20%7C%20%E8%BF%94%E5%9B%9E%E7%89%B9%E6%AE%8A%E5%80%BC%20%7C%20%E4%B8%80%E7%9B%B4%E9%98%BB%E5%A1%9E%20%7C%20%E8%B6%85%E6%97%B6%E9%80%80%E5%87%BA%20%7C%0A%7C%20--%20%7C%20--%20%7C%20--%20%7C%20--%20%7C%20--%20%7C%0A%7C%E6%8F%92%E5%85%A5%E6%96%B9%E6%B3%95%7Cadd(e)%7Coffer(e)%7Cput(e)%7Coffer(e%2Ctime%2Cunit)%7C%0A%7C%E7%A7%BB%E9%99%A4%E6%96%B9%E6%B3%95%7Cremove()%7Cpoll()%7Ctake()%7Cpoll(time%2Cunit)%7C%0A%7C%E6%A3%80%E6%9F%A5%E6%96%B9%E6%B3%95%7Celement()%7Cpeek()%7C%E4%B8%8D%E5%8F%AF%E7%94%A8%7C%E4%B8%8D%E5%8F%AF%E7%94%A8%7C%0A%0A%23%23%23%23%204.3.2%20java%E4%B8%AD%E7%9A%84%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%0A%7C%E9%98%9F%E5%88%97%7C%E6%9C%89%E7%95%8C%E6%80%A7%7C%E9%94%81%7C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%7C%0A%7C%20--%20%7C%20--%20%7C%20--%20%7C%20--%20%7C%0A%7CArrayBlockingQueue%7Cbounded(%E6%9C%89%E7%95%8C)%7C%E5%8A%A0%E9%94%81%7CarrayList%7C%0A%7CLinkedBlockingQueue%7Coptionally-bounded%7C%E5%8A%A0%E9%94%81%7ClinkedList%7C%0A%7CPriorityBlockingQueue%7Cunbounded%7C%E5%8A%A0%E9%94%81%7Cheap%7C%0A%7CDelayQueue%7Cunbounded%7C%E5%8A%A0%E9%94%81%7Cheap%7C%0A%7CSynchronousQueue%7Cbounded%7C%E5%8A%A0%E9%94%81%7C%E6%97%A0%7C%0A%7CLinkedTransferQueue%7Cunbounded%7C%E5%8A%A0%E9%94%81%7Cheap%7C%0A%7CLinkedBlockingDeque%7Cunbounded%7C%E6%97%A0%E9%94%81%7Cheap%7C%0A%0A%23%23%23%23%204.3.3%20%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%0A%E4%BD%BF%E7%94%A8%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%BC%8F%E3%80%82%0A%0A%23%23%23%23%204.3.4%20fork%2Fjoin%E6%A1%86%E6%9E%B6%0Afork%2Fjoin%E6%A1%86%E6%9E%B6%E6%98%AFjava7%E6%8F%90%E4%BE%9B%E7%9A%84%E7%94%A8%E4%BA%8E%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%A1%86%E6%9E%B6%EF%BC%8C%E6%98%AF%E4%B8%80%E4%B8%AA%E6%8A%8A%E5%A4%A7%E4%BB%BB%E5%8A%A1%E5%88%86%E5%89%B2%E6%88%90%E8%8B%A5%E5%B9%B2%E4%B8%AA%E5%B0%8F%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%9C%80%E5%90%8E%E6%B1%87%E6%80%BB%E6%AF%8F%E4%B8%AA%E5%B0%8F%E4%BB%BB%E5%8A%A1%E7%BB%93%E6%9E%9C%E5%BE%97%E5%88%B0%E5%A4%A7%E4%BB%BB%E5%8A%A1%E7%BB%93%E6%9E%9C%E7%9A%84%E6%A1%86%E6%9E%B6%E3%80%82%0Afork%2Fjoin%E6%A1%86%E6%9E%B6%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E5%88%86%E5%89%B2%E4%BB%BB%E5%8A%A1%EF%BC%8C%E5%85%B6%E6%AC%A1%E9%9C%80%E8%A6%81%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E5%B9%B6%E5%90%88%E5%B9%B6%E7%BB%93%E6%9E%9C%E3%80%82%0Afork%2Fjoin%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8%EF%BC%9A%0A-%20%EF%BC%881%EF%BC%89ForkJoinTask%E7%B1%BB%E7%9A%84%E5%AD%90%E7%B1%BBRecursiveAction%E5%92%8CRecursiveTask%E6%9D%A5%E6%8F%90%E4%BE%9B%E5%9C%A8%E4%BB%BB%E5%8A%A1%E4%B8%AD%E7%9A%84fork()%E5%92%8Cjoin()%E6%93%8D%E4%BD%9C%E3%80%82%0A-%20%EF%BC%882%EF%BC%89ForkJoinPool%E7%BB%99ForkJoinTask%E6%8F%90%E4%BE%9B%E6%89%A7%E8%A1%8C%E6%9D%A1%E4%BB%B6%E3%80%82%0A%0A%E5%BD%93%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E9%98%9F%E5%88%97%E4%B8%AD%E6%B2%A1%E6%9C%89%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E6%97%B6%EF%BC%8C%E5%AE%83%E4%BC%9A%E4%BD%BF%E7%94%A8**%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95**%E9%9A%8F%E6%9C%BA%E4%BB%8E%E5%85%B6%E4%BB%96%E9%98%9F%E5%88%97%E5%B0%BE%E9%83%A8%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E4%BB%BB%E5%8A%A1%E3%80%82%E8%BF%99%E7%A7%8D%E5%81%9A%E6%B3%95%E5%85%85%E5%88%86%E5%88%A9%E7%94%A8%E4%BA%86%E7%BA%BF%E7%A8%8B%E8%BF%9B%E8%A1%8C%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%EF%BC%8C%E4%BD%86%E6%98%AF%E5%9C%A8%E6%9F%90%E4%BA%9B%E6%83%85%E5%86%B5%E4%B8%8B%E8%BF%98%E6%98%AF%E5%AD%98%E5%9C%A8%E7%AB%9E%E4%BA%89%EF%BC%8C%E4%BC%9A%E6%B6%88%E8%80%97%E6%9B%B4%E5%A4%9A%E7%9A%84%E8%B5%84%E6%BA%90%E3%80%82%0A%0A%0A%23%23%205%20java%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%B1%BB%0A%23%23%23%205.1%20%E5%8E%9F%E5%AD%90%E7%B1%BB%20Atomic%20%0AAtomic%20%E6%98%AF%E6%8C%87%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9C%E6%98%AF%E4%B8%8D%E5%8F%AF%E4%B8%AD%E6%96%AD%E7%9A%84%E3%80%82%E5%8D%B3%E4%BD%BF%E6%98%AF%E5%9C%A8%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%B8%80%E8%B5%B7%E6%89%A7%E8%A1%8C%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%93%8D%E4%BD%9C%E4%B8%80%E6%97%A6%E5%BC%80%E5%A7%8B%EF%BC%8C%E5%B0%B1%E4%B8%8D%E4%BC%9A%E8%A2%AB%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E5%B9%B2%E6%89%B0%E3%80%82%E6%89%80%E4%BB%A5%EF%BC%8C%E6%89%80%E8%B0%93%E5%8E%9F%E5%AD%90%E7%B1%BB%E8%AF%B4%E7%AE%80%E5%8D%95%E7%82%B9%E5%B0%B1%E6%98%AF%E5%85%B7%E6%9C%89%E5%8E%9F%E5%AD%90%2F%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%89%B9%E5%BE%81%E7%9A%84%E7%B1%BB%E3%80%82%E5%B9%B6%E5%8F%91%E5%8C%85java.util.concurrent%E7%9A%84%E5%8E%9F%E5%AD%90%E7%B1%BB%E9%83%BD%E5%AD%98%E6%94%BE%E5%9C%A8java.util.concurrent.atomic%E4%B8%8B.%0A%23%23%23%205.2%20JUC%E4%B8%AD%E7%9A%844%E7%B1%BB%E5%8E%9F%E5%AD%90%E7%B1%BB%0A1.%20%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%AD%90%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9B%B4%E6%96%B0%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%0A-%20AtomicInteger%EF%BC%9A%E6%95%B4%E5%BD%A2%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicLong%EF%BC%9A%E9%95%BF%E6%95%B4%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicBoolean%EF%BC%9A%E5%B8%83%E5%B0%94%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB%0A2.%20%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%AD%90%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9B%B4%E6%96%B0%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E6%9F%90%E4%B8%AA%E5%85%83%E7%B4%A0%0A-%20AtomicIntegerArray%EF%BC%9A%E6%95%B4%E5%BD%A2%E6%95%B0%E7%BB%84%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicLongArray%EF%BC%9A%E9%95%BF%E6%95%B4%E5%BD%A2%E6%95%B0%E7%BB%84%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicReferenceArray%EF%BC%9A%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E5%8E%9F%E5%AD%90%E7%B1%BB%0A3.%20%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%0A-%20AtomicReference%EF%BC%9A%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicStampedReference%EF%BC%9A%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E9%87%8C%E7%9A%84%E5%AD%97%E6%AE%B5%E5%8E%9F%E5%AD%90%E7%B1%BB%0A-%20AtomicMarkableReference%20%EF%BC%9A%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E5%B8%A6%E6%9C%89%E6%A0%87%E8%AE%B0%E4%BD%8D%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%0A4.%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BF%AE%E6%94%B9%E7%B1%BB%0A-%20AtomicIntegerFieldUpdater%EF%BC%9A%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E6%95%B4%E5%BD%A2%E5%AD%97%E6%AE%B5%E7%9A%84%E6%9B%B4%E6%96%B0%E5%99%A8%0A-%20AtomicLongFieldUpdater%EF%BC%9A%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E9%95%BF%E6%95%B4%E5%BD%A2%E5%AD%97%E6%AE%B5%E7%9A%84%E6%9B%B4%E6%96%B0%E5%99%A8%0A-%20AtomicStampedReference%EF%BC%9A%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E5%B8%A6%E6%9C%89%E7%89%88%E6%9C%AC%E5%8F%B7%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E3%80%82%E8%AF%A5%E7%B1%BB%E5%B0%86%E6%95%B4%E6%95%B0%E5%80%BC%E4%B8%8E%E5%BC%95%E7%94%A8%E5%85%B3%E8%81%94%E8%B5%B7%E6%9D%A5%EF%BC%8C%E5%8F%AF%E7%94%A8%E4%BA%8E%E8%A7%A3%E5%86%B3%E5%8E%9F%E5%AD%90%E7%9A%84%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E5%92%8C%E6%95%B0%E6%8D%AE%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%A7%A3%E5%86%B3%E4%BD%BF%E7%94%A8%20CAS%20%E8%BF%9B%E8%A1%8C%E5%8E%9F%E5%AD%90%E6%9B%B4%E6%96%B0%E6%97%B6%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%20ABA%20%E9%97%AE%E9%A2%98%E3%80%82%0A%0A%23%23%23%205.3%20%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90AtomicInteger%20%E7%B1%BB%E7%9A%84%E5%8E%9F%E7%90%86%0AAtomicInteger%20%E7%B1%BB%E4%B8%BB%E8%A6%81%E5%88%A9%E7%94%A8%20**CAS%20(compare%20and%20swap)%20%2B%20volatile**%E5%92%8C%20**native**%20%E6%96%B9%E6%B3%95%E6%9D%A5%E4%BF%9D%E8%AF%81%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BB%8E%E8%80%8C%E9%81%BF%E5%85%8D%20synchronized%20%E7%9A%84%E9%AB%98%E5%BC%80%E9%94%80%EF%BC%8C%E6%89%A7%E8%A1%8C%E6%95%88%E7%8E%87%E5%A4%A7%E4%B8%BA%E6%8F%90%E5%8D%87%E3%80%82CAS%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E6%8B%BF%E6%9C%9F%E6%9C%9B%E7%9A%84%E5%80%BC%E5%92%8C%E5%8E%9F%E6%9C%AC%E7%9A%84%E4%B8%80%E4%B8%AA%E5%80%BC%E4%BD%9C%E6%AF%94%E8%BE%83%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%9B%B8%E5%90%8C%E5%88%99%E6%9B%B4%E6%96%B0%E6%88%90%E6%96%B0%E7%9A%84%E5%80%BC%E3%80%82UnSafe%20%E7%B1%BB%E7%9A%84%20objectFieldOffset()%20%E6%96%B9%E6%B3%95%E6%98%AF%E4%B8%80%E4%B8%AA%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E4%B8%AA%E6%96%B9%E6%B3%95%E6%98%AF%E7%94%A8%E6%9D%A5%E6%8B%BF%E5%88%B0%E2%80%9C%E5%8E%9F%E6%9D%A5%E7%9A%84%E5%80%BC%E2%80%9D%E7%9A%84%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%80%BC%E6%98%AF%20valueOffset%E3%80%82%E5%8F%A6%E5%A4%96%20value%20%E6%98%AF%E4%B8%80%E4%B8%AAvolatile%E5%8F%98%E9%87%8F%EF%BC%8C%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E5%8F%AF%E8%A7%81%EF%BC%8C%E5%9B%A0%E6%AD%A4%20JVM%20%E5%8F%AF%E4%BB%A5%E4%BF%9D%E8%AF%81%E4%BB%BB%E4%BD%95%E6%97%B6%E5%88%BB%E4%BB%BB%E4%BD%95%E7%BA%BF%E7%A8%8B%E6%80%BB%E8%83%BD%E6%8B%BF%E5%88%B0%E8%AF%A5%E5%8F%98%E9%87%8F%E7%9A%84%E6%9C%80%E6%96%B0%E5%80%BC%E3%80%82%0A%0A%23%23%206%20java%E4%B8%AD%E7%9A%84%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%0A%23%23%23%206.1%20CountDownLatch%0ACountDownLatch%E5%85%81%E8%AE%B8%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E7%AD%89%E5%BE%85%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E5%AE%8C%E6%88%90%E6%93%8D%E4%BD%9C%E3%80%82%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%EF%BC%8CCountDownLatch%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0join()%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%8F%90%E4%BE%9B%E4%BA%86%E6%9B%B4%E5%A4%9A%E7%9A%84%E5%8A%9F%E8%83%BD%E3%80%82%0ACountDownLatch%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%8E%A5%E6%94%B6%E4%B8%80%E4%B8%AAint%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0%E4%BD%9C%E4%B8%BA%E8%AE%A1%E6%95%B0%E5%99%A8%EF%BC%8C%E9%9C%80%E8%A6%81%E7%AD%89%E5%BE%85N%E4%B8%AA%E7%82%B9%EF%BC%8C%E5%B0%B1%E4%BC%A0%E5%85%A5N%E3%80%82%E8%BF%99N%E4%B8%AA%E7%82%B9%E5%8F%AF%E4%BB%A5%E6%98%AF%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%87%8C%E7%9A%84N%E4%B8%AA%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%98%AFN%E4%B8%AA%E7%BA%BF%E7%A8%8B%E3%80%82%E5%BD%93%E8%B0%83%E7%94%A8CountDownLatch%E7%9A%84countDown%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8CN%E5%87%8F%E4%B8%80%EF%BC%8C%E9%98%BB%E5%A1%9E%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9B%B4%E5%88%B0N%E5%8F%98%E6%88%900%E3%80%82%0A%23%23%23%206.2%20CyclicBarrier%0ACyclicBarrier%E8%AE%A9%E4%B8%80%E7%BB%84%E7%BA%BF%E7%A8%8B%E5%88%B0%E8%BE%BE%E4%B8%80%E4%B8%AA%E5%B1%8F%E9%9A%9C%EF%BC%88%E5%90%8C%E6%AD%A5%E7%82%B9%EF%BC%89%E6%97%B6%E8%A2%AB%E9%98%BB%E5%A1%9E%EF%BC%8C%E7%9B%B4%E5%88%B0%E8%BF%99%E7%BB%84%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E7%BA%BF%E7%A8%8B%E9%83%BD%E5%88%B0%E8%BE%BE%E5%B1%8F%E9%9A%9C%EF%BC%8C%E6%89%8D%E8%AE%A9%E8%BF%99%E4%BA%9B%E7%BA%BF%E7%A8%8B%E6%81%A2%E5%A4%8D%E8%BF%90%E8%A1%8C%E3%80%82%0A%0A**CyclicBarrier%E5%92%8CCountDownLatch%E7%9A%84%E5%8C%BA%E5%88%AB**%EF%BC%9A%0A-%20CountDownLatch%20%E7%9A%84%E8%AE%A1%E6%95%B0%E5%99%A8%E5%8F%AA%E8%83%BD%E4%BD%BF%E7%94%A8%E4%B8%80%E6%AC%A1%EF%BC%8C%E8%80%8CCyclicBarrier%E7%9A%84%E8%AE%A1%E6%95%B0%E5%99%A8%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8reset%E6%96%B9%E6%B3%95%E9%87%8D%E7%BD%AE%E3%80%82%0A-%20CyclicBarrier%E8%BF%98%E6%8F%90%E4%BE%9B%E4%BA%86%E5%85%B6%E4%BB%96%E6%9C%89%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82%0A%0A%23%23%23%206.3%20Semaphore%0ASemaphore%E4%BF%A1%E5%8F%B7%E9%87%8F%E6%98%AF%E7%94%A8%E6%9D%A5%E6%8E%A7%E5%88%B6%E5%90%8C%E6%97%B6%E8%AE%BF%E9%97%AE%E7%89%B9%E5%AE%9A%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%95%B0%E9%87%8F%E3%80%82%0A%23%23%23%206.4%20Exchanger%0AExchanger%E6%98%AF%E4%B8%80%E4%B8%AA%E7%94%A8%E4%BA%8E%E7%BA%BF%E7%A8%8B%E9%97%B4%E5%8D%8F%E4%BD%9C%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB%E3%80%82%E7%94%A8%E4%BA%8E%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E3%80%82%0A%0A%23%23%207%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%0A%E5%90%88%E7%90%86%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E5%A5%BD%E5%A4%84%EF%BC%9A%0A-%20%E9%99%8D%E4%BD%8E%E8%B5%84%E6%BA%90%E6%B6%88%E8%80%97%EF%BC%9A%E9%87%8D%E5%A4%8D%E5%88%A9%E7%94%A8%0A-%20%E6%8F%90%E9%AB%98%E5%93%8D%E5%BA%94%E9%80%9F%E5%BA%A6%EF%BC%9A%E4%B8%8D%E9%9C%80%E8%A6%81%E7%AD%89%E5%BE%85%E7%BA%BF%E7%A8%8B%E5%88%9B%E5%BB%BA%0A-%20%E6%8F%90%E9%AB%98%E7%BA%BF%E7%A8%8B%E5%8F%AF%E7%AE%A1%E7%90%86%E6%80%A7%EF%BC%9A%E7%BB%9F%E4%B8%80%E5%88%86%E9%85%8D%E3%80%81%E8%B0%83%E4%BC%98%E3%80%81%E7%9B%91%E6%8E%A7%0A%0A%23%23%23%207.1%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%0A%23%23%23%207.2%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8%0A%23%23%23%23%207.2.1%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E5%88%9B%E5%BB%BA%0A%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87Executor%20%E6%A1%86%E6%9E%B6%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BBExecutors%E6%88%96%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95ThreadPoolExecutor%C2%A0%E6%9D%A5%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E6%B1%A0%E3%80%82executor%E6%A1%86%E6%9E%B6%E5%9C%A88%E4%B8%AD%E5%B1%95%E5%BC%80%E3%80%82%0A%0A%E9%80%9A%E8%BF%87ThreadPoolExecutor%C2%A0%E6%9D%A5%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%8C%E9%9C%80%E8%A6%81%E4%BB%A5%E4%B8%8B%E5%8F%82%E6%95%B0%EF%BC%9A%0A-%20corePoolSize%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%9F%BA%E6%9C%AC%E5%A4%A7%E5%B0%8F%0A-%20runnableTaskQueue%20%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97%0A-%20maximunPoolSize%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9C%80%E5%A4%A7%E6%95%B0%E9%87%8F%0A-%20threadFactory%E8%AE%BE%E7%BD%AE%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%B7%A5%E5%8E%82%0A-%20RejectedExecutionHandler%20%E9%A5%B1%E5%92%8C%E7%AD%96%E7%95%A5%0A%0A%23%23%23%23%207.2.2%20%E5%90%91%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1%0A%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E5%8F%AF%E4%BB%A5%E5%90%91%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1%EF%BC%9A%0A-%20execute()%20%3A%E6%8F%90%E4%BA%A4%E4%B8%8D%E9%9C%80%E8%A6%81%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%89%80%E4%BB%A5%E6%97%A0%E6%B3%95%E5%88%A4%E6%96%AD%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90%E4%B8%8E%E5%90%A6%E3%80%82%0A-%20submit()%EF%BC%9A%E6%8F%90%E4%BA%A4%E9%9C%80%E8%A6%81%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E4%BB%BB%E5%8A%A1%E3%80%82%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%BC%9A%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AAFuture%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E9%80%9A%E8%BF%87%E8%BF%99%E4%B8%AAFuture%E5%AF%B9%E8%B1%A1%E5%8F%AF%E4%BB%A5%E5%88%A4%E6%96%AD%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%89%A7%E8%A1%8C%E6%88%90%E5%8A%9F%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87future%E7%9A%84get()%E6%96%B9%E6%B3%95%E6%9D%A5%E8%8E%B7%E5%8F%96%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8Cget()%E6%96%B9%E6%B3%95%E4%BC%9A%E9%98%BB%E5%A1%9E%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9B%B4%E5%88%B0%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90%EF%BC%8C%E8%80%8C%E4%BD%BF%E7%94%A8%C2%A0get%EF%BC%88long%20timeout%EF%BC%8CTimeUnit%20unit%EF%BC%89%E6%96%B9%E6%B3%95%E5%88%99%E4%BC%9A%E9%98%BB%E5%A1%9E%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E5%90%8E%E7%AB%8B%E5%8D%B3%E8%BF%94%E5%9B%9E%EF%BC%8C%E8%BF%99%E6%97%B6%E5%80%99%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BB%BB%E5%8A%A1%E6%B2%A1%E6%9C%89%E6%89%A7%E8%A1%8C%E5%AE%8C%E3%80%82%0A%0A%23%23%23%23%207.2.3%20%E5%85%B3%E9%97%AD%E7%BA%BF%E7%A8%8B%E6%B1%A0%0A%E5%8F%AF%E4%BB%A5%E8%B0%83%E7%94%A8shutdown%E5%92%8CshutdownNow%E6%96%B9%E6%B3%95%E6%9D%A5%E5%85%B3%E9%97%AD%E7%BA%BF%E7%A8%8B%E6%B1%A0%E3%80%82%E5%8E%9F%E7%90%86%E6%98%AF%E9%81%8D%E5%8E%86%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E9%80%90%E4%B8%AA%E8%B0%83%E7%94%A8interrupt%E6%96%B9%E6%B3%95%E6%9D%A5%E4%B8%AD%E6%96%AD%E7%BA%BF%E7%A8%8B%EF%BC%8C%E6%89%80%E4%BB%A5%E6%97%A0%E6%B3%95%E5%93%8D%E5%BA%94%E4%B8%AD%E6%96%AD%E7%9A%84%E4%BB%BB%E5%8A%A1%E5%8F%AF%E8%83%BD%E6%B0%B8%E8%BF%9C%E6%97%A0%E6%B3%95%E7%BB%88%E6%AD%A2%E3%80%82%0A%0A%23%23%23%23%207.2.4%20%E5%AE%9E%E7%8E%B0Runnable%E6%8E%A5%E5%8F%A3%E5%92%8CCallable%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8C%BA%E5%88%AB%0A%E5%A6%82%E6%9E%9C%E6%83%B3%E8%AE%A9%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E8%AF%9D%E9%9C%80%E8%A6%81%E5%AE%9E%E7%8E%B0%E7%9A%84Runnable%E6%8E%A5%E5%8F%A3%E6%88%96Callable%E6%8E%A5%E5%8F%A3%EF%BC%8C%E8%BF%99%E4%B8%A4%E4%B8%AA%E6%8E%A5%E5%8F%A3%E6%98%AF%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8D%95%E5%85%83%E3%80%82%0ARunnable%E6%8E%A5%E5%8F%A3%E6%88%96Callable%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB%E9%83%BD%E5%8F%AF%E4%BB%A5%E8%A2%ABThreadPoolExecutor%E6%88%96ScheduledThreadPoolExecutor%E6%89%A7%E8%A1%8C%E3%80%82%E4%B8%A4%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB%E5%9C%A8%E4%BA%8E%20Runnable%20%E6%8E%A5%E5%8F%A3%E4%B8%8D%E4%BC%9A%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E4%BD%86%E6%98%AF%20Callable%20%E6%8E%A5%E5%8F%A3%E5%8F%AF%E4%BB%A5%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E3%80%82%0A%0A%23%23%208%20Executor%E6%A1%86%E6%9E%B6%0A%E5%9C%A8JDK5%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%B0%86java%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8D%95%E5%85%83%E5%92%8C%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6%E5%88%86%E7%A6%BB%E5%BC%80%E6%9D%A5%E3%80%82%E5%B7%A5%E4%BD%9C%E5%8D%95%E5%85%83%E5%8C%85%E6%8B%ACRunnable%E6%8E%A5%E5%8F%A3%E6%88%96Callable%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6%E7%94%B1Executor%E6%A1%86%E6%9E%B6%E6%8F%90%E4%BE%9B%E3%80%82%0A8%E6%83%B3%E5%86%99%E4%BA%86%E3%80%82</center></span>
</div></body></html> 